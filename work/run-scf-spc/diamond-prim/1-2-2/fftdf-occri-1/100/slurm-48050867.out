SLURMD_NODENAME = hpc-53-01
Start time = Mon Mar 17 04:17:47 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 409600
TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48050867/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48050867/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftdf-occri
chk_path = ../../gdf-32/tmp/scf.h5
mesh = 1,2,2

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
None

******** <class 'ISDFX'> ********
lin_dep_thresh: 1e-10
alpha_cutoff: 2.8
rcut_epsilon: 1e-05
ke_epsilon: 1e-05
isdf_thresh: 0.0001
grid_vol_cutoff: 0.05
ke_step: 2.0
ao_tol: 1e-12
multigrid_on: False
direct_j: True
iterative_build: True
occRI: True
voronoi: True
fit_sparse_grid: False
fit_dense_grid: False
direct_k_sparse: True
direct_k: False
use_kpt_symm: False
kmesh: [1, 1, 1]
isdf_pts_from_q0: True
isdf_pts_from_gamma_point: False
alpha: None
do_real_isdf: False
N_xi: None
use_cell_periodic: False
isdf_thresh_sparse: None
ncopy: [1, 1, 1]
j_grid_mesh: None
k_grid_mesh: None
num_j_grids: 100
get_ao_from_pyscf: False
nuc_pp_version: 0
vppnl_ver: 0
universal_dense_grid: None
same_jk_grids: None
coulomb_only: False
max_memory   409600 MB (current use       88 MB)

Exchange function: getK_occRI  

cell mesh: [23 47 47]
nbas:  96
Grid     keMax    keMin    keGrid   expMax   expMin   nexp     lmax     PWs      mesh        
0        100.0    100.0    100.0    5.6      0.3      4        2        50807    [23 47 47]  

ISDF

atm      grid     Ng       NI       Nxi      sharp    on_grid  diffuse  maxexp   minexp   lmax     lmin    
-        1        50807    50807    50807    288      288      288      5.61     0.35     2        0       
ISDF-pts:       0.00
ISDF-vec:       0.00
Fit dense grids ISDF:       0.00
Fit sparse grids ISDF:       0.00

Grid     PWs      Ng_i     N_xi     N_mu    
0        50807    50807    50807    288     
1        50807    50807    50807    288     

nTHC: 101614
Mem Required (MB):       0.00
Curent RAM Use (MB) :        213 

Build W
ISDF-fft dense grids (sec):       0.00
Curent RAM Use (MB) :        213 
ISDF-fft:       0.00

Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 32.1244)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 32
Successfully loaded dm0 from ../../gdf-32/tmp/scf.h5
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10829564e-01 -1.37789682e-02 -2.25945214e-03 ...  4.53891936e-05
  -9.46650009e-03 -1.08570539e-02]
 [-1.37789682e-02  4.27285789e-04  7.14882829e-04 ... -7.09765086e-07
   2.72690080e-04  3.10240234e-04]
 [-2.25945214e-03  7.14882829e-04  7.33591631e-01 ... -2.81085758e-02
   8.04812038e-04  1.66000927e-02]
 ...
 [ 4.53891936e-05 -7.09765086e-07 -2.81085758e-02 ...  2.44820851e-03
  -2.69404595e-04  5.35606099e-04]
 [-9.46650009e-03  2.72690080e-04  8.04812038e-04 ... -2.69404595e-04
   2.48677716e-03  1.42503184e-04]
 [-1.08570539e-02  3.10240234e-04  1.66000927e-02 ...  5.35606099e-04
   1.42503184e-04  3.05186751e-03]]
[[ 2.42393032e-01  3.23160163e-01 -1.92359013e-03 ... -1.87138756e-01
   1.47258212e-04 -1.00429284e+00]
 [-9.27570260e-03 -9.62159400e-03  5.72723120e-05 ... -2.04594493e-01
   1.19300319e-04 -8.13426778e-01]
 [-1.50376240e-04 -3.51363209e-02 -3.40374893e-02 ... -1.25189788e-02
   7.25982881e-02 -7.22623066e-02]
 ...
 [ 5.37275965e-06  1.00201284e-04  1.51983125e-02 ... -3.02588471e-03
  -5.48403339e-02  1.13113659e-05]
 [ 7.25693740e-05 -9.92610970e-03 -1.00735653e-02 ...  1.71500679e-02
   3.65639729e-02 -3.59649949e-02]
 [ 9.31453267e-05 -1.12886613e-02  1.46924050e-02 ...  1.45508980e-02
  -5.27623043e-02 -4.15038509e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10829564e-01 -1.37789682e-02 -2.25945214e-03 ...  4.53891936e-05
  -9.46650009e-03 -1.08570539e-02]
 [-1.37789682e-02  4.27285789e-04  7.14882829e-04 ... -7.09765086e-07
   2.72690080e-04  3.10240234e-04]
 [-2.25945214e-03  7.14882829e-04  7.33591631e-01 ... -2.81085758e-02
   8.04812038e-04  1.66000927e-02]
 ...
 [ 4.53891936e-05 -7.09765086e-07 -2.81085758e-02 ...  2.44820851e-03
  -2.69404595e-04  5.35606099e-04]
 [-9.46650009e-03  2.72690080e-04  8.04812038e-04 ... -2.69404595e-04
   2.48677716e-03  1.42503184e-04]
 [-1.08570539e-02  3.10240234e-04  1.66000927e-02 ...  5.35606099e-04
   1.42503184e-04  3.05186751e-03]]
[[ 2.42393032e-01  3.23160163e-01 -1.92359013e-03 ... -1.87138756e-01
   1.47258212e-04 -1.00429284e+00]
 [-9.27570260e-03 -9.62159400e-03  5.72723120e-05 ... -2.04594493e-01
   1.19300319e-04 -8.13426778e-01]
 [-1.50376240e-04 -3.51363209e-02 -3.40374893e-02 ... -1.25189788e-02
   7.25982881e-02 -7.22623066e-02]
 ...
 [ 5.37275965e-06  1.00201284e-04  1.51983125e-02 ... -3.02588471e-03
  -5.48403339e-02  1.13113659e-05]
 [ 7.25693740e-05 -9.92610970e-03 -1.00735653e-02 ...  1.71500679e-02
   3.65639729e-02 -3.59649949e-02]
 [ 9.31453267e-05 -1.12886613e-02  1.46924050e-02 ...  1.45508980e-02
  -5.27623043e-02 -4.15038509e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  0.9212183952331543


******** <class 'pyscf.pbc.dft.rks.RKS'> ********
method = RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48050867/tmpj9nnlkvo
max_memory 409600 MB (current use 234 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <isdfx.isdfx.ISDFX object at 0x7f4c04b08850>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 31.999999999294186
    CPU time for vxc      1.63 sec, wall time      1.64 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10829564e-01 -1.37789682e-02 -2.25945214e-03 ...  4.53891936e-05
  -9.46650009e-03 -1.08570539e-02]
 [-1.37789682e-02  4.27285789e-04  7.14882829e-04 ... -7.09765086e-07
   2.72690080e-04  3.10240234e-04]
 [-2.25945214e-03  7.14882829e-04  7.33591631e-01 ... -2.81085758e-02
   8.04812038e-04  1.66000927e-02]
 ...
 [ 4.53891936e-05 -7.09765086e-07 -2.81085758e-02 ...  2.44820851e-03
  -2.69404595e-04  5.35606099e-04]
 [-9.46650009e-03  2.72690080e-04  8.04812038e-04 ... -2.69404595e-04
   2.48677716e-03  1.42503184e-04]
 [-1.08570539e-02  3.10240234e-04  1.66000927e-02 ...  5.35606099e-04
   1.42503184e-04  3.05186751e-03]]
[[ 2.42393032e-01  3.23160163e-01 -1.92359013e-03 ... -1.87138756e-01
   1.47258212e-04 -1.00429284e+00]
 [-9.27570260e-03 -9.62159400e-03  5.72723120e-05 ... -2.04594493e-01
   1.19300319e-04 -8.13426778e-01]
 [-1.50376240e-04 -3.51363209e-02 -3.40374893e-02 ... -1.25189788e-02
   7.25982881e-02 -7.22623066e-02]
 ...
 [ 5.37275965e-06  1.00201284e-04  1.51983125e-02 ... -3.02588471e-03
  -5.48403339e-02  1.13113659e-05]
 [ 7.25693740e-05 -9.92610970e-03 -1.00735653e-02 ...  1.71500679e-02
   3.65639729e-02 -3.59649949e-02]
 [ 9.31453267e-05 -1.12886613e-02  1.46924050e-02 ...  1.45508980e-02
  -5.27623043e-02 -4.15038509e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  0.9117302894592285
    CPU time for vj and vk      1.92 sec, wall time      1.93 sec
E1 = 16.682090968380386  Ecoul = 4.928877274200911  Exc = -13.217469699188296
init E= -42.8419938485514
    CPU time for initialize scf      5.08 sec, wall time      5.10 sec
  HOMO = 0.575182578827972  LUMO = 0.855377506635277
  mo_energy =
[-0.26350974 -0.04882327 -0.04881645  0.04506558  0.045067    0.06128701
  0.06327191  0.31614151  0.32367552  0.45212784  0.45213928  0.45937267
  0.45937474  0.56287193  0.5708399   0.57518258  0.85537751  0.85609467
  0.85847331  0.87671811  0.88227022  0.97652285  0.97652631  0.98047949
  0.98048625  1.00841674  1.00842146  1.19978937  1.29921338  1.30295585
  1.36193926  1.36193958  1.72631879  1.72631891  1.7345036   1.73548692
  1.76592425  1.76795857  1.92069752  1.92070078  1.92083322  1.92083916
  2.05268128  2.05387439  2.07335442  2.0733587   2.07493762  2.07494438
  2.35878981  2.35940241  2.42042884  2.42370699  2.42508483  2.49197773
  2.49222118  2.49242531  2.66453714  2.66453766  2.80527673  2.80796896
  2.91289761  2.91290469  2.94455256  2.94455284  2.94662477  2.9466287
  2.99086573  2.99087225  2.99259281  2.99260968  2.99402751  2.99694877
  3.03678621  3.03679416  3.28415889  3.28416768  3.44405457  3.44478258
  3.57558283  3.57971209  3.62695629  3.62696333  3.62891157  3.62892117
  3.74864773  3.74876973  3.74889415  4.52265368  4.52266744  4.52310631
  4.52311076  4.63749071  4.64048625  4.64174041  4.73896431  4.74218124
  8.71135533  9.03960825  9.05226581  9.05236457  9.05263229  9.05343792
  9.09718148  9.09747034]
nelec by numeric integration = 31.99999999929419
    CPU time for vxc      1.49 sec, wall time      1.49 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10832563e-01 -1.37793816e-02 -2.25709782e-03 ...  4.54604654e-05
  -9.46636445e-03 -1.08567801e-02]
 [-1.37793816e-02  4.27309396e-04  7.14603782e-04 ... -7.04449060e-07
   2.72666024e-04  3.10222362e-04]
 [-2.25709782e-03  7.14603782e-04  7.33593428e-01 ... -2.81078035e-02
   8.06268416e-04  1.65993027e-02]
 ...
 [ 4.54604654e-05 -7.04449060e-07 -2.81078035e-02 ...  2.44825164e-03
  -2.69575628e-04  5.35749283e-04]
 [-9.46636445e-03  2.72666024e-04  8.06268416e-04 ... -2.69575628e-04
   2.48689608e-03  1.42523678e-04]
 [-1.08567801e-02  3.10222362e-04  1.65993027e-02 ...  5.35749283e-04
   1.42523678e-04  3.05198642e-03]]
[[ 2.42402834e-01 -9.46890417e-04  3.23169837e-01 ...  1.61093405e-01
   1.36893189e-04 -1.00352246e+00]
 [-9.27606280e-03  2.81927233e-05 -9.62218243e-03 ...  1.79871030e-01
   1.10975654e-04 -8.13320531e-01]
 [-1.50259221e-04  3.43478150e-02 -3.48359955e-02 ...  1.30959575e-02
   7.24538838e-02 -7.21047376e-02]
 ...
 [ 5.34174948e-06 -1.51988817e-02 -3.47020470e-05 ...  3.09897508e-03
  -5.47925461e-02  1.89009421e-05]
 [ 7.25821377e-05  1.01615195e-02 -9.83650263e-03 ... -1.84720418e-02
   3.65317413e-02 -3.59389740e-02]
 [ 9.31056950e-05 -1.45918232e-02 -1.14188555e-02 ... -1.59534835e-02
  -5.27167476e-02 -4.14606403e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  0.9020862579345703
    CPU time for vj and vk      1.91 sec, wall time      1.92 sec
E1 = 16.682089424664387  Ecoul = 4.928878555420177  Exc = -13.21746943732526
cycle= 1 E= -42.8419938491851  delta_E= -6.34e-10  |g|= 4.48e-05  |ddm|= 0.000103
    CPU time for cycle= 1      3.40 sec, wall time      3.42 sec
  HOMO = 0.575183319135266  LUMO = 0.855377559346337
  mo_energy =
[-0.26350971 -0.04882309 -0.04881721  0.04506585  0.0450678   0.06128613
  0.06327284  0.31614126  0.3236758   0.45213099  0.4521354   0.4593734
  0.45937474  0.56287138  0.57083993  0.57518332  0.85537756  0.85609434
  0.85847369  0.87671721  0.88227126  0.97652203  0.97652583  0.98048203
  0.98048434  1.00841711  1.00842075  1.19978946  1.29921338  1.302956
  1.3619366   1.36194305  1.72631686  1.72632123  1.73450393  1.73548678
  1.76592429  1.76795857  1.92069748  1.92070175  1.92083239  1.92083966
  2.05268148  2.0538744   2.07335631  2.07335755  2.07493979  2.07494254
  2.35879026  2.359402    2.42042859  2.42370703  2.42508512  2.49197758
  2.49222144  2.49242544  2.66453569  2.66453912  2.80527676  2.80796902
  2.91289728  2.91290572  2.94455013  2.94455511  2.94662242  2.94663125
  2.99086821  2.9908697   2.99259432  2.99260738  2.99402735  2.99694899
  3.03678586  3.03679463  3.2841564   3.28416968  3.44405496  3.44478228
  3.57558288  3.57971213  3.62695844  3.62696131  3.62890972  3.62892297
  3.7486477   3.74876964  3.74889451  4.52264742  4.522674    4.52310387
  4.52311335  4.63749077  4.64048628  4.64174047  4.73896421  4.74218148
  8.71135552  9.03960959  9.0522732   9.0523651   9.05264352  9.0534184
  9.09719251  9.09745938]
nelec by numeric integration = 31.99999999929418
    CPU time for vxc      1.46 sec, wall time      1.47 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10831128e-01 -1.37791933e-02 -2.25766799e-03 ...  4.54120573e-05
  -9.46615706e-03 -1.08566219e-02]
 [-1.37791933e-02  4.27300093e-04  7.14662851e-04 ... -7.04256422e-07
   2.72665158e-04  3.10221477e-04]
 [-2.25766799e-03  7.14662851e-04  7.33593153e-01 ... -2.81082353e-02
   8.05904256e-04  1.65995429e-02]
 ...
 [ 4.54120573e-05 -7.04256422e-07 -2.81082353e-02 ...  2.44825585e-03
  -2.69527758e-04  5.35713025e-04]
 [-9.46615706e-03  2.72665158e-04  8.05904256e-04 ... -2.69527758e-04
   2.48686655e-03  1.42505555e-04]
 [-1.08566219e-02  3.10221477e-04  1.65995429e-02 ...  5.35713025e-04
   1.42505555e-04  3.05195939e-03]]
[[ 2.42394445e-01  3.23165802e-01 -1.09735724e-03 ... -1.56566518e-01
   1.48201762e-04 -1.00372630e+00]
 [-9.27575880e-03 -9.62213939e-03  3.26737528e-05 ... -1.75633376e-01
   1.20144889e-04 -8.13512174e-01]
 [-1.50548585e-04 -3.50491631e-02 -3.41268814e-02 ... -1.32163873e-02
   7.24547214e-02 -7.21117392e-02]
 ...
 [ 5.38472181e-06  6.13851001e-05  1.51987684e-02 ... -3.11489444e-03
  -5.47925831e-02  1.70427734e-05]
 [ 7.27400540e-05 -9.90005043e-03 -1.00990775e-02 ...  1.87451084e-02
   3.65321710e-02 -3.59484927e-02]
 [ 9.33626668e-05 -1.13258041e-02  1.46637332e-02 ...  1.62416665e-02
  -5.27163151e-02 -4.14748518e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  0.9036314487457275
    CPU time for vj and vk      1.91 sec, wall time      1.92 sec
E1 = 16.68209006892162  Ecoul = 4.928877490058464  Exc = -13.217469016180122
Extra cycle  E= -42.8419938491444  delta_E= 4.07e-11  |g|= 4.68e-05  |ddm|= 7.53e-05
    CPU time for scf_cycle     11.86 sec, wall time     11.90 sec
    CPU time for SCF     11.99 sec, wall time     12.04 sec
converged SCF energy = -42.8419938491444
Successfully saved all results to /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48050867/scf.h5
