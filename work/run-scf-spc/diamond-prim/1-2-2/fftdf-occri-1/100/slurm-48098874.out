SLURMD_NODENAME = hpc-21-35
Start time = Wed Mar 19 03:40:24 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 409600
TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48098874/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48098874/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftdf-occri
chk_path = ../../gdf-64/tmp/scf.h5
mesh = 1,2,2

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
None

******** <class 'ISDFX'> ********
lin_dep_thresh: 1e-10
alpha_cutoff: 2.8
rcut_epsilon: 1e-05
ke_epsilon: 1e-05
isdf_thresh: 0.0001
grid_vol_cutoff: 0.05
ke_step: 2.0
ao_tol: 1e-12
multigrid_on: False
direct_j: True
iterative_build: True
occRI: True
voronoi: True
fit_sparse_grid: False
fit_dense_grid: False
direct_k_sparse: True
direct_k: False
use_kpt_symm: False
kmesh: [1, 1, 1]
isdf_pts_from_q0: True
isdf_pts_from_gamma_point: False
alpha: None
do_real_isdf: False
N_xi: None
use_cell_periodic: False
isdf_thresh_sparse: None
ncopy: [1, 1, 1]
j_grid_mesh: None
k_grid_mesh: None
num_j_grids: 100
get_ao_from_pyscf: False
nuc_pp_version: 0
vppnl_ver: 0
universal_dense_grid: None
same_jk_grids: None
coulomb_only: False
max_memory   409600 MB (current use       94 MB)

Exchange function: getK_occRI  

cell mesh: [23 47 47]
nbas:  96
Grid     keMax    keMin    keGrid   expMax   expMin   nexp     lmax     PWs      mesh        
0        100.0    100.0    100.0    5.6      0.3      4        2        50807    [23 47 47]  

ISDF

atm      grid     Ng       NI       Nxi      sharp    on_grid  diffuse  maxexp   minexp   lmax     lmin    
-        1        50807    50807    50807    288      288      288      5.61     0.35     2        0       
ISDF-pts:       0.00
ISDF-vec:       0.00
Fit dense grids ISDF:       0.00
Fit sparse grids ISDF:       0.00

Grid     PWs      Ng_i     N_xi     N_mu    
0        50807    50807    50807    288     
1        50807    50807    50807    288     

nTHC: 101614
Mem Required (MB):       0.00
Curent RAM Use (MB) :        218 

Build W
ISDF-fft dense grids (sec):       0.00
Curent RAM Use (MB) :        218 
ISDF-fft:       0.00

Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 32.1244)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 32
Successfully loaded dm0 from ../../gdf-64/tmp/scf.h5
Successfully loaded h1e and s1e from ../../gdf-64/tmp/scf.h5
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10829564e-01 -1.37789682e-02 -2.25945214e-03 ...  4.53891936e-05
  -9.46650009e-03 -1.08570539e-02]
 [-1.37789682e-02  4.27285789e-04  7.14882829e-04 ... -7.09765086e-07
   2.72690080e-04  3.10240234e-04]
 [-2.25945214e-03  7.14882829e-04  7.33591631e-01 ... -2.81085758e-02
   8.04812038e-04  1.66000927e-02]
 ...
 [ 4.53891936e-05 -7.09765086e-07 -2.81085758e-02 ...  2.44820851e-03
  -2.69404595e-04  5.35606099e-04]
 [-9.46650009e-03  2.72690080e-04  8.04812038e-04 ... -2.69404595e-04
   2.48677716e-03  1.42503184e-04]
 [-1.08570539e-02  3.10240234e-04  1.66000927e-02 ...  5.35606099e-04
   1.42503184e-04  3.05186751e-03]]
[[ 2.42393032e-01  3.23160163e-01 -1.92359012e-03 ... -1.87138756e-01
   1.47258213e-04 -1.00429284e+00]
 [-9.27570260e-03 -9.62159400e-03  5.72723118e-05 ... -2.04594493e-01
   1.19300320e-04 -8.13426778e-01]
 [-1.50376240e-04 -3.51363209e-02 -3.40374893e-02 ... -1.25189788e-02
   7.25982881e-02 -7.22623066e-02]
 ...
 [ 5.37275965e-06  1.00201284e-04  1.51983125e-02 ... -3.02588471e-03
  -5.48403339e-02  1.13113658e-05]
 [ 7.25693740e-05 -9.92610970e-03 -1.00735653e-02 ...  1.71500679e-02
   3.65639729e-02 -3.59649949e-02]
 [ 9.31453267e-05 -1.12886613e-02  1.46924050e-02 ...  1.45508980e-02
  -5.27623043e-02 -4.15038509e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10829564e-01 -1.37789682e-02 -2.25945214e-03 ...  4.53891936e-05
  -9.46650009e-03 -1.08570539e-02]
 [-1.37789682e-02  4.27285789e-04  7.14882829e-04 ... -7.09765086e-07
   2.72690080e-04  3.10240234e-04]
 [-2.25945214e-03  7.14882829e-04  7.33591631e-01 ... -2.81085758e-02
   8.04812038e-04  1.66000927e-02]
 ...
 [ 4.53891936e-05 -7.09765086e-07 -2.81085758e-02 ...  2.44820851e-03
  -2.69404595e-04  5.35606099e-04]
 [-9.46650009e-03  2.72690080e-04  8.04812038e-04 ... -2.69404595e-04
   2.48677716e-03  1.42503184e-04]
 [-1.08570539e-02  3.10240234e-04  1.66000927e-02 ...  5.35606099e-04
   1.42503184e-04  3.05186751e-03]]
[[ 2.42393032e-01  3.23160163e-01 -1.92359012e-03 ... -1.87138756e-01
   1.47258213e-04 -1.00429284e+00]
 [-9.27570260e-03 -9.62159400e-03  5.72723118e-05 ... -2.04594493e-01
   1.19300320e-04 -8.13426778e-01]
 [-1.50376240e-04 -3.51363209e-02 -3.40374893e-02 ... -1.25189788e-02
   7.25982881e-02 -7.22623066e-02]
 ...
 [ 5.37275965e-06  1.00201284e-04  1.51983125e-02 ... -3.02588471e-03
  -5.48403339e-02  1.13113658e-05]
 [ 7.25693740e-05 -9.92610970e-03 -1.00735653e-02 ...  1.71500679e-02
   3.65639729e-02 -3.59649949e-02]
 [ 9.31453267e-05 -1.12886613e-02  1.46924050e-02 ...  1.45508980e-02
  -5.27623043e-02 -4.15038509e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  1.2588565349578857


******** <class 'pyscf.pbc.dft.rks.RKS'> ********
method = RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48098874/tmpycb1xh1p
max_memory 409600 MB (current use 236 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <isdfx.isdfx.ISDFX object at 0x7fa1575cd4f0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Overwritten attributes  get_ovlp get_hcore  of <class 'pyscf.pbc.dft.rks.RKS'>
Set gradient conv threshold to 0.0001
nelec by numeric integration = 31.999999999294193
    CPU time for vxc      2.20 sec, wall time      2.20 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10829564e-01 -1.37789682e-02 -2.25945214e-03 ...  4.53891936e-05
  -9.46650009e-03 -1.08570539e-02]
 [-1.37789682e-02  4.27285789e-04  7.14882829e-04 ... -7.09765086e-07
   2.72690080e-04  3.10240234e-04]
 [-2.25945214e-03  7.14882829e-04  7.33591631e-01 ... -2.81085758e-02
   8.04812038e-04  1.66000927e-02]
 ...
 [ 4.53891936e-05 -7.09765086e-07 -2.81085758e-02 ...  2.44820851e-03
  -2.69404595e-04  5.35606099e-04]
 [-9.46650009e-03  2.72690080e-04  8.04812038e-04 ... -2.69404595e-04
   2.48677716e-03  1.42503184e-04]
 [-1.08570539e-02  3.10240234e-04  1.66000927e-02 ...  5.35606099e-04
   1.42503184e-04  3.05186751e-03]]
[[ 2.42393032e-01  3.23160163e-01 -1.92359012e-03 ... -1.87138756e-01
   1.47258213e-04 -1.00429284e+00]
 [-9.27570260e-03 -9.62159400e-03  5.72723118e-05 ... -2.04594493e-01
   1.19300320e-04 -8.13426778e-01]
 [-1.50376240e-04 -3.51363209e-02 -3.40374893e-02 ... -1.25189788e-02
   7.25982881e-02 -7.22623066e-02]
 ...
 [ 5.37275965e-06  1.00201284e-04  1.51983125e-02 ... -3.02588471e-03
  -5.48403339e-02  1.13113658e-05]
 [ 7.25693740e-05 -9.92610970e-03 -1.00735653e-02 ...  1.71500679e-02
   3.65639729e-02 -3.59649949e-02]
 [ 9.31453267e-05 -1.12886613e-02  1.46924050e-02 ...  1.45508980e-02
  -5.27623043e-02 -4.15038509e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  1.2420082092285156
    CPU time for vj and vk      2.54 sec, wall time      2.55 sec
E1 = 16.68209100902464  Ecoul = 4.928877274200907  Exc = -13.217469699188294
init E= -42.8419938079071
    CPU time for initialize scf      4.75 sec, wall time      4.76 sec
  HOMO = 0.575182579953742  LUMO = 0.855377505191842
  mo_energy =
[-0.26350973 -0.04882327 -0.04881645  0.04506558  0.045067    0.06128701
  0.06327191  0.31614151  0.32367552  0.45212785  0.45213928  0.45937267
  0.45937474  0.56287194  0.5708399   0.57518258  0.85537751  0.85609466
  0.85847331  0.87671811  0.88227022  0.97652285  0.97652631  0.98047949
  0.98048625  1.00841675  1.00842147  1.19978939  1.29921338  1.30295586
  1.36193926  1.36193958  1.72631879  1.72631891  1.7345036   1.73548693
  1.76592426  1.76795857  1.92069752  1.92070079  1.92083322  1.92083916
  2.05268128  2.05387439  2.07335443  2.0733587   2.07493762  2.07494438
  2.35878981  2.35940241  2.42042884  2.42370699  2.42508484  2.49197773
  2.49222117  2.49242531  2.66453714  2.66453766  2.80527672  2.80796897
  2.9128976   2.91290469  2.94455256  2.94455284  2.94662478  2.94662871
  2.99086573  2.99087225  2.99259282  2.99260968  2.99402754  2.99694879
  3.03678622  3.03679417  3.28415895  3.28416773  3.44405456  3.44478257
  3.57558284  3.5797121   3.62695629  3.62696333  3.62891157  3.62892117
  3.74864775  3.74876977  3.74889418  4.52265368  4.52266745  4.52310631
  4.52311076  4.63749066  4.64048622  4.64174036  4.73896438  4.74218133
  8.71135528  9.03960819  9.05226575  9.05236451  9.05263224  9.05343787
  9.09718143  9.09747029]
nelec by numeric integration = 31.9999999992942
    CPU time for vxc      1.96 sec, wall time      1.97 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10832559e-01 -1.37793799e-02 -2.25709854e-03 ...  4.54604380e-05
  -9.46636483e-03 -1.08567805e-02]
 [-1.37793799e-02  4.27309306e-04  7.14603595e-04 ... -7.04438976e-07
   2.72666002e-04  3.10222326e-04]
 [-2.25709854e-03  7.14603595e-04  7.33593428e-01 ... -2.81078038e-02
   8.06268651e-04  1.65993030e-02]
 ...
 [ 4.54604380e-05 -7.04438976e-07 -2.81078038e-02 ...  2.44825172e-03
  -2.69575666e-04  5.35749319e-04]
 [-9.46636483e-03  2.72666002e-04  8.06268651e-04 ... -2.69575666e-04
   2.48689614e-03  1.42523677e-04]
 [-1.08567805e-02  3.10222326e-04  1.65993030e-02 ...  5.35749319e-04
   1.42523677e-04  3.05198654e-03]]
[[ 2.42402835e-01 -9.42159393e-04  3.23169849e-01 ...  1.61093609e-01
   1.37955098e-04 -1.00352242e+00]
 [-9.27606233e-03  2.80518173e-05 -9.62218150e-03 ...  1.79871218e-01
   1.11836414e-04 -8.13320488e-01]
 [-1.50259373e-04  3.43473058e-02 -3.48364995e-02 ...  1.30959531e-02
   7.24539607e-02 -7.21046599e-02]
 ...
 [ 5.34162050e-06 -1.51988830e-02 -3.44796563e-05 ...  3.09897860e-03
  -5.47925468e-02  1.88427898e-05]
 [ 7.25820241e-05  1.01613760e-02 -9.83665204e-03 ... -1.84720318e-02
   3.65317795e-02 -3.59389337e-02]
 [ 9.31057398e-05 -1.45919911e-02 -1.14186425e-02 ... -1.59534641e-02
  -5.27167041e-02 -4.14606932e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  1.2394664287567139
    CPU time for vj and vk      2.53 sec, wall time      2.54 sec
E1 = 16.68208947806636  Ecoul = 4.92887853668169  Exc = -13.21746943134446
cycle= 1 E= -42.8419938085408  delta_E= -6.34e-10  |g|= 4.48e-05  |ddm|= 0.000103
    CPU time for cycle= 1      4.50 sec, wall time      4.51 sec
  HOMO = 0.575183319459772  LUMO = 0.855377557404833
  mo_energy =
[-0.26350971 -0.04882309 -0.0488172   0.04506585  0.0450678   0.06128613
  0.06327284  0.31614126  0.3236758   0.452131    0.4521354   0.4593734
  0.45937474  0.56287138  0.57083993  0.57518332  0.85537756  0.85609434
  0.85847369  0.87671721  0.88227127  0.97652203  0.97652583  0.98048203
  0.98048434  1.00841712  1.00842076  1.19978949  1.29921338  1.302956
  1.36193661  1.36194305  1.72631687  1.72632123  1.73450394  1.73548678
  1.76592429  1.76795858  1.92069748  1.92070175  1.9208324   1.92083966
  2.05268148  2.0538744   2.07335632  2.07335755  2.07493979  2.07494255
  2.35879026  2.35940199  2.42042859  2.42370704  2.42508512  2.49197758
  2.49222143  2.49242544  2.66453569  2.66453912  2.80527676  2.80796902
  2.91289728  2.91290572  2.94455013  2.94455511  2.94662243  2.94663126
  2.99086821  2.9908697   2.99259433  2.99260739  2.99402738  2.99694901
  3.03678587  3.03679463  3.28415645  3.28416973  3.44405496  3.44478227
  3.5755829   3.57971214  3.62695844  3.62696131  3.62890972  3.62892297
  3.74864772  3.74876968  3.74889453  4.52264743  4.52267401  4.52310387
  4.52311335  4.63749072  4.64048624  4.64174043  4.73896428  4.74218157
  8.71135547  9.03960953  9.05227314  9.05236504  9.05264346  9.05341834
  9.09719246  9.09745933]
nelec by numeric integration = 31.999999999294182
    CPU time for vxc      1.99 sec, wall time      1.99 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.10831124e-01 -1.37791917e-02 -2.25766856e-03 ...  4.54120297e-05
  -9.46615745e-03 -1.08566223e-02]
 [-1.37791917e-02  4.27300006e-04  7.14662643e-04 ... -7.04245869e-07
   2.72665135e-04  3.10221442e-04]
 [-2.25766856e-03  7.14662643e-04  7.33593153e-01 ... -2.81082355e-02
   8.05904501e-04  1.65995432e-02]
 ...
 [ 4.54120297e-05 -7.04245869e-07 -2.81082355e-02 ...  2.44825593e-03
  -2.69527798e-04  5.35713063e-04]
 [-9.46615745e-03  2.72665135e-04  8.05904501e-04 ... -2.69527798e-04
   2.48686661e-03  1.42505554e-04]
 [-1.08566223e-02  3.10221442e-04  1.65995432e-02 ...  5.35713063e-04
   1.42505554e-04  3.05195952e-03]]
[[ 2.42394446e-01  3.23165819e-01 -1.09171722e-03 ... -1.56566725e-01
   1.49352985e-04 -1.00372625e+00]
 [-9.27575836e-03 -9.62213864e-03  3.25058583e-05 ... -1.75633566e-01
   1.21078062e-04 -8.13512121e-01]
 [-1.50548785e-04 -3.50485689e-02 -3.41274939e-02 ... -1.32163824e-02
   7.24548047e-02 -7.21116547e-02]
 ...
 [ 5.38459290e-06  6.11197457e-05  1.51987703e-02 ... -3.11489798e-03
  -5.47925838e-02  1.69798212e-05]
 [ 7.27399251e-05 -9.89987486e-03 -1.00992508e-02 ...  1.87450973e-02
   3.65322124e-02 -3.59484486e-02]
 [ 9.33626944e-05 -1.13260606e-02  1.46635364e-02 ...  1.62416458e-02
  -5.27162679e-02 -4.14749086e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  1.2312955856323242
    CPU time for vj and vk      2.54 sec, wall time      2.54 sec
E1 = 16.682090120495506  Ecoul = 4.928877474011139  Exc = -13.217469011062391
Extra cycle  E= -42.8419938085001  delta_E= 4.07e-11  |g|= 4.68e-05  |ddm|= 7.53e-05
    CPU time for scf_cycle     13.78 sec, wall time     13.81 sec
    CPU time for SCF     13.84 sec, wall time     13.87 sec
converged SCF energy = -42.8419938085001
Successfully saved all results to /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-2-2-fftdf-occri-1-100-/48098874/scf.h5
