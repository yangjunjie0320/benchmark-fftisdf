SLURMD_NODENAME = hpc-21-35
Start time = Wed Mar 19 03:39:58 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 409600
TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftdf-occri-1-100-/48098869/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftdf-occri-1-100-/48098869/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftdf-occri
chk_path = ../../gdf-64/tmp/scf.h5
mesh = 1,1,2

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
None

******** <class 'ISDFX'> ********
lin_dep_thresh: 1e-10
alpha_cutoff: 2.8
rcut_epsilon: 1e-05
ke_epsilon: 1e-05
isdf_thresh: 0.0001
grid_vol_cutoff: 0.05
ke_step: 2.0
ao_tol: 1e-12
multigrid_on: False
direct_j: True
iterative_build: True
occRI: True
voronoi: True
fit_sparse_grid: False
fit_dense_grid: False
direct_k_sparse: True
direct_k: False
use_kpt_symm: False
kmesh: [1, 1, 1]
isdf_pts_from_q0: True
isdf_pts_from_gamma_point: False
alpha: None
do_real_isdf: False
N_xi: None
use_cell_periodic: False
isdf_thresh_sparse: None
ncopy: [1, 1, 1]
j_grid_mesh: None
k_grid_mesh: None
num_j_grids: 100
get_ao_from_pyscf: False
nuc_pp_version: 0
vppnl_ver: 0
universal_dense_grid: None
same_jk_grids: None
coulomb_only: False
max_memory   409600 MB (current use       94 MB)

Exchange function: getK_occRI  

cell mesh: [23 23 47]
nbas:  48
Grid     keMax    keMin    keGrid   expMax   expMin   nexp     lmax     PWs      mesh        
0        100.0    100.0    100.0    5.6      0.3      4        2        24863    [23 23 47]  

ISDF

atm      grid     Ng       NI       Nxi      sharp    on_grid  diffuse  maxexp   minexp   lmax     lmin    
-        1        24863    24863    24863    144      144      144      5.61     0.35     2        0       
ISDF-pts:       0.00
ISDF-vec:       0.00
Fit dense grids ISDF:       0.00
Fit sparse grids ISDF:       0.00

Grid     PWs      Ng_i     N_xi     N_mu    
0        24863    24863    24863    144     
1        24863    24863    24863    144     

nTHC: 49726
Mem Required (MB):       0.00
Curent RAM Use (MB) :        125 

Build W
ISDF-fft dense grids (sec):       0.00
Curent RAM Use (MB) :        125 
ISDF-fft:       0.00

Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 16.1866)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 16
Successfully loaded dm0 from ../../gdf-64/tmp/scf.h5
Successfully loaded h1e and s1e from ../../gdf-64/tmp/scf.h5
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.1328411102294922


******** <class 'pyscf.pbc.dft.rks.RKS'> ********
method = RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-spc-diamond-prim-1-1-2-fftdf-occri-1-100-/48098869/tmpi6jpe5dw
max_memory 409600 MB (current use 127 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <isdfx.isdfx.ISDFX object at 0x7fa4ba4234f0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Overwritten attributes  get_hcore get_ovlp  of <class 'pyscf.pbc.dft.rks.RKS'>
Set gradient conv threshold to 0.0001
nelec by numeric integration = 15.999999999385867
    CPU time for vxc      0.85 sec, wall time      0.85 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.1326913833618164
    CPU time for vj and vk      0.52 sec, wall time      0.52 sec
E1 = 8.784676807250891  Ecoul = 2.8272203613504794  Exc = -6.605361804936256
init E= -20.6112108323071
    CPU time for initialize scf      1.38 sec, wall time      1.38 sec
  HOMO = 0.617481095107078  LUMO = 0.8719321842698
  mo_energy =
[-2.23592526e-01 -7.28047872e-03  7.94949277e-02  4.86941858e-01
  4.86961197e-01  5.99493964e-01  5.99517061e-01  6.17481095e-01
  8.71932184e-01  8.75240833e-01  8.75257023e-01  9.96350696e-01
  9.96366781e-01  1.02620031e+00  1.22626985e+00  1.38954894e+00
  1.74927320e+00  1.78006903e+00  1.78006941e+00  1.94437004e+00
  1.94440236e+00  2.08926631e+00  2.08927277e+00  2.43893468e+00
  2.44480545e+00  2.44481402e+00  2.51765824e+00  2.51778662e+00
  2.51787473e+00  2.67921472e+00  2.93556252e+00  2.97056306e+00
  2.97062641e+00  3.01082532e+00  3.01087585e+00  3.30313200e+00
  3.59740106e+00  3.59740208e+00  3.64871519e+00  3.64874166e+00
  3.77126493e+00  3.77134737e+00  3.77146886e+00  4.54703303e+00
  4.54704255e+00  4.66024350e+00  4.66444122e+00  4.66445574e+00
  8.76291622e+00  9.08991849e+00  9.10313116e+00  9.14693952e+00]
nelec by numeric integration = 15.999999999385878
    CPU time for vxc      0.80 sec, wall time      0.80 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86180525e-01 -1.39168872e-02 -5.47843157e-03 ...  9.13400835e-03
  -1.21795047e-02  1.75779514e-03]
 [-1.39168872e-02  4.75261635e-04  1.59551162e-03 ... -2.68414091e-04
   3.57474487e-04 -5.16950686e-05]
 [-5.47843157e-03  1.59551162e-03  7.83116097e-01 ... -3.52103469e-02
   2.41500024e-03  2.11407487e-02]
 ...
 [ 9.13400835e-03 -2.68414091e-04 -3.52103469e-02 ...  3.43456783e-03
  -5.43473484e-04  7.05200384e-04]
 [-1.21795047e-02  3.57474487e-04  2.41500024e-03 ... -5.43473484e-04
   3.66680101e-03  2.15453669e-04]
 [ 1.75779514e-03 -5.16950686e-05  2.11407487e-02 ...  7.05200384e-04
   2.15453669e-04  4.13525266e-03]]
[[ 3.43145224e-01 -3.21237861e-01 -1.48821192e-01 ...  8.35419944e-01
  -9.04255614e-01  1.01180319e+00]
 [-1.26905646e-02  8.66629820e-03 -1.21067074e-03 ...  8.65842047e-01
  -8.82280982e-01  8.23134163e-01]
 [-2.65671210e-04  7.02769750e-02 -1.33404941e-01 ...  9.50368019e-05
   1.52320824e-02  1.44098303e-01]
 ...
 [-1.80651668e-04 -1.52428703e-02  1.74880564e-03 ...  4.06424353e-04
   3.82718775e-02 -5.44409990e-02]
 [ 2.41008551e-04  2.03243471e-02 -2.33166155e-03 ... -5.58426795e-04
  -5.10282779e-02  7.26127483e-02]
 [-3.48148409e-05 -2.93356758e-03  3.36700785e-04 ...  8.30878415e-05
   7.36961196e-03 -1.04799815e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.13107681274414062
    CPU time for vj and vk      0.53 sec, wall time      0.53 sec
E1 = 8.78466780643498  Ecoul = 2.827234173232793  Exc = -6.605366616531002
cycle= 1 E= -20.6112108328354  delta_E= -5.28e-10  |g|= 1.17e-05  |ddm|= 6.13e-05
    CPU time for cycle= 1      1.33 sec, wall time      1.33 sec
  HOMO = 0.617482769717387  LUMO = 0.871932438309253
  mo_energy =
[-2.23591950e-01 -7.28044354e-03  7.94963428e-02  4.86942504e-01
  4.86961844e-01  5.99494403e-01  5.99517499e-01  6.17482770e-01
  8.71932438e-01  8.75241718e-01  8.75257908e-01  9.96351104e-01
  9.96367188e-01  1.02620053e+00  1.22627094e+00  1.38955065e+00
  1.74927431e+00  1.78006950e+00  1.78006988e+00  1.94437107e+00
  1.94440339e+00  2.08926721e+00  2.08927367e+00  2.43893506e+00
  2.44480634e+00  2.44481492e+00  2.51765953e+00  2.51778755e+00
  2.51787568e+00  2.67921543e+00  2.93556395e+00  2.97056396e+00
  2.97062730e+00  3.01082562e+00  3.01087615e+00  3.30313227e+00
  3.59740183e+00  3.59740285e+00  3.64871593e+00  3.64874240e+00
  3.77126619e+00  3.77134818e+00  3.77146971e+00  4.54703399e+00
  4.54704351e+00  4.66024441e+00  4.66444211e+00  4.66445662e+00
  8.76291852e+00  9.08992051e+00  9.10313360e+00  9.14694191e+00]
nelec by numeric integration = 15.999999999385864
    CPU time for vxc      0.80 sec, wall time      0.80 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86179224e-01 -1.39166973e-02 -5.47973941e-03 ...  9.13402498e-03
  -1.21795269e-02  1.75779834e-03]
 [-1.39166973e-02  4.75255133e-04  1.59566019e-03 ... -2.68421744e-04
   3.57484696e-04 -5.16965411e-05]
 [-5.47973941e-03  1.59566019e-03  7.83114417e-01 ... -3.52102324e-02
   2.41491032e-03  2.11407295e-02]
 ...
 [ 9.13402498e-03 -2.68421744e-04 -3.52102324e-02 ...  3.43453437e-03
  -5.43472017e-04  7.05198375e-04]
 [-1.21795269e-02  3.57484696e-04  2.41491032e-03 ... -5.43472017e-04
   3.66677378e-03  2.15460941e-04]
 [ 1.75779834e-03 -5.16965411e-05  2.11407295e-02 ...  7.05198375e-04
   2.15460941e-04  4.13522625e-03]]
[[ 3.43138588e-01 -3.21244574e-01  1.48819821e-01 ... -8.34964407e-01
   9.04676079e-01  1.01181560e+00]
 [-1.26902880e-02  8.66648079e-03  1.21090212e-03 ... -8.65397700e-01
   8.82716896e-01  8.23149098e-01]
 [-2.64773607e-04  7.02763990e-02  1.33404096e-01 ... -1.02738130e-04
  -1.52320883e-02  1.44098293e-01]
 ...
 [-1.80904872e-04 -1.52427486e-02 -1.74886108e-03 ... -4.25747260e-04
  -3.82717116e-02 -5.44410003e-02]
 [ 2.41346171e-04  2.03241849e-02  2.33173548e-03 ...  5.84190212e-04
   5.10280485e-02  7.26127497e-02]
 [-3.48635714e-05 -2.93354417e-03 -3.36711455e-04 ... -8.68086457e-05
  -7.36957760e-03 -1.04799817e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.13205242156982422
    CPU time for vj and vk      0.53 sec, wall time      0.53 sec
E1 = 8.784669100113199  Ecoul = 2.8272322432151746  Exc = -6.605365980204899
Extra cycle  E= -20.6112108328487  delta_E= -1.33e-11  |g|= 9.14e-06  |ddm|= 1.84e-05
    CPU time for scf_cycle      4.03 sec, wall time      4.05 sec
    CPU time for SCF      4.09 sec, wall time      4.11 sec
converged SCF energy = -20.6112108328487
Successfully saved all results to /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftdf-occri-1-100-/48098869/scf.h5
