SLURMD_NODENAME = hpc-52-18
Start time = Wed Mar 19 05:12:03 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 409600
TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-5e-05/48100077/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-5e-05/48100077/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-ks
chk_path = ../../../gdf-64/tmp/scf.h5
mesh = 1,1,2
rcut_epsilon =  1.00e-05
ke_epsilon =  1.00e-02
isdf_thresh =  5.00e-05

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
None

******** <class 'ISDFX'> ********
lin_dep_thresh: 1e-10
alpha_cutoff: 2.8
rcut_epsilon: 1e-05
ke_epsilon: 0.01
isdf_thresh: 5e-05
grid_vol_cutoff: 0.05
ke_step: 2.0
ao_tol: 1e-12
multigrid_on: True
direct_j: True
iterative_build: True
occRI: True
voronoi: True
fit_sparse_grid: False
fit_dense_grid: True
direct_k_sparse: True
direct_k: False
use_kpt_symm: False
kmesh: [1, 1, 1]
isdf_pts_from_q0: True
isdf_pts_from_gamma_point: False
alpha: None
do_real_isdf: False
N_xi: None
use_cell_periodic: False
isdf_thresh_sparse: None
ncopy: [1, 1, 1]
j_grid_mesh: None
k_grid_mesh: None
num_j_grids: 100
get_ao_from_pyscf: False
nuc_pp_version: 0
vppnl_ver: 0
universal_dense_grid: None
same_jk_grids: None
coulomb_only: False
max_memory   409600 MB (current use       90 MB)

Exchange function: getK_occRI  

cell mesh: [23 23 47]
nbas:  48
Grid     keMax    keMin    keGrid   expMax   expMin   nexp     lmax     PWs      mesh        
0        51.6     51.6     105.5    5.6      5.6      1        2        24863    [23 23 47]
1        19.5     3.2      19.5     2.1      0.3      3        2        2541     [11 11 21]
0        77.4     52.8     105.5    5.6      5.6      1        2        24863    [23 23 47]
1        29.2     4.8      29.2     2.1      0.3      3        2        4225     [13 13 25]

ISDF

atm      grid     Ng       NI       Nxi      sharp    on_grid  diffuse  maxexp   minexp   lmax     lmin    
0        0        24863    2021     111      9        108      99       5.61     5.61     2        0       
1        0        24863    2012     110      9        108      99       5.61     5.61     2        0       
2        0        24863    2012     110      9        108      99       5.61     5.61     2        0       
3        0        24863    2021     111      9        108      99       5.61     5.61     2        0       
-        1        2541     2541     2541     108      108      108      2.11     0.35     2        0       
ISDF-pts:       0.34
ISDF-vec:       0.03
Fit dense grids ISDF:       0.37
Fit sparse grids ISDF:       0.00

Grid     PWs      Ng_i     N_xi     N_mu    
0        24863    8066     442      432     
1        2541     2541     2541     108     

nTHC: 2983
Mem Required (MB):       9.96
Curent RAM Use (MB) :        137 

Build W
ISDF-fft dense grids (sec):       0.81
Curent RAM Use (MB) :        159 
ISDF-fft:       0.81

Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 16.1866)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 16
Successfully loaded dm0 from ../../../gdf-64/tmp/scf.h5
Successfully loaded h1e and s1e from ../../../gdf-64/tmp/scf.h5
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.007940053939819336


******** <class 'pyscf.pbc.dft.rks.RKS'> ********
method = RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-5e-05/48100077/tmptb561xax
max_memory 409600 MB (current use 160 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <isdfx.isdfx.ISDFX object at 0x7fc7a3e934f0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Overwritten attributes  get_hcore get_ovlp  of <class 'pyscf.pbc.dft.rks.RKS'>
Set gradient conv threshold to 0.0001
nelec by numeric integration = 15.999999999385867
    CPU time for vxc      0.63 sec, wall time      0.63 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.007944822311401367
    CPU time for vj and vk      0.37 sec, wall time      0.38 sec
E1 = 8.784676807250891  Ecoul = 2.827202858991142  Exc = -6.605317085052475
init E= -20.6111836147826
    CPU time for initialize scf      1.01 sec, wall time      1.01 sec
  HOMO = 0.617485988149969  LUMO = 0.871931171830875
  mo_energy =
[-2.23595108e-01 -7.28255109e-03  7.94967461e-02  4.86947413e-01
  4.86968093e-01  5.99499892e-01  5.99523844e-01  6.17485988e-01
  8.71931172e-01  8.75239376e-01  8.75253469e-01  9.96349262e-01
  9.96363272e-01  1.02620041e+00  1.22627030e+00  1.38954740e+00
  1.74927057e+00  1.78006739e+00  1.78006755e+00  1.94436693e+00
  1.94439374e+00  2.08926443e+00  2.08926979e+00  2.43893361e+00
  2.44480356e+00  2.44480892e+00  2.51765633e+00  2.51778216e+00
  2.51785602e+00  2.67921353e+00  2.93556134e+00  2.97055901e+00
  2.97061042e+00  3.01082206e+00  3.01086440e+00  3.30313080e+00
  3.59739942e+00  3.59739978e+00  3.64871336e+00  3.64873228e+00
  3.77126343e+00  3.77134281e+00  3.77144281e+00  4.54702680e+00
  4.54704319e+00  4.66024477e+00  4.66443743e+00  4.66445683e+00
  8.76296388e+00  9.08996958e+00  9.10318299e+00  9.14699043e+00]
nelec by numeric integration = 15.999999999385874
    CPU time for vxc      0.59 sec, wall time      0.60 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86181799e-01 -1.39169153e-02 -5.47992566e-03 ...  9.13422946e-03
  -1.21791877e-02  1.75787213e-03]
 [-1.39169153e-02  4.75258218e-04  1.59428060e-03 ... -2.68375530e-04
   3.57489508e-04 -5.17449579e-05]
 [-5.47992566e-03  1.59428060e-03  7.83113882e-01 ... -3.52103058e-02
   2.41500586e-03  2.11402423e-02]
 ...
 [ 9.13422946e-03 -2.68375530e-04 -3.52103058e-02 ...  3.43457832e-03
  -5.43475128e-04  7.05227175e-04]
 [-1.21791877e-02  3.57489508e-04  2.41500586e-03 ... -5.43475128e-04
   3.66681245e-03  2.15426677e-04]
 [ 1.75787213e-03 -5.17449579e-05  2.11402423e-02 ...  7.05227175e-04
   2.15426677e-04  4.13519738e-03]]
[[ 3.43142616e-01 -3.21241199e-01 -1.48822138e-01 ...  8.35584675e-01
  -9.04104591e-01  1.01179892e+00]
 [-1.26903863e-02  8.66648182e-03 -1.21052541e-03 ...  8.66002132e-01
  -8.82123627e-01  8.23128876e-01]
 [-2.65684556e-04  7.02760874e-02 -1.33404344e-01 ...  9.29913688e-05
   1.52306599e-02  1.44098731e-01]
 ...
 [-1.80499372e-04 -1.52429180e-02  1.74897725e-03 ...  4.00384948e-04
   3.82708440e-02 -5.44409730e-02]
 [ 2.41287584e-04  2.03239222e-02 -2.33130059e-03 ... -5.47229661e-04
  -5.10297362e-02  7.26122336e-02]
 [-3.46731079e-05 -2.93367577e-03  3.36802819e-04 ...  8.19211904e-05
   7.36930952e-03 -1.04800152e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.007879495620727539
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = 8.784686283036987  Ecoul = 2.8271914187508695  Exc = -6.605315121600136
cycle= 1 E= -20.6111836157844  delta_E= -1e-09  |g|= 1.56e-05  |ddm|= 7.95e-05
    CPU time for cycle= 1      0.97 sec, wall time      0.98 sec
  HOMO = 0.617486252241793  LUMO = 0.87193005856119
  mo_energy =
[-2.23595718e-01 -7.28393699e-03  7.94975157e-02  4.86946432e-01
  4.86967201e-01  5.99498509e-01  5.99522566e-01  6.17486252e-01
  8.71930059e-01  8.75239060e-01  8.75253000e-01  9.96348346e-01
  9.96362177e-01  1.02619882e+00  1.22626921e+00  1.38954687e+00
  1.74926984e+00  1.78006711e+00  1.78006731e+00  1.94436630e+00
  1.94439326e+00  2.08926466e+00  2.08926993e+00  2.43893243e+00
  2.44480309e+00  2.44480827e+00  2.51765552e+00  2.51778079e+00
  2.51785472e+00  2.67921311e+00  2.93556119e+00  2.97055782e+00
  2.97060914e+00  3.01082064e+00  3.01086296e+00  3.30312922e+00
  3.59739869e+00  3.59739911e+00  3.64871251e+00  3.64873149e+00
  3.77126287e+00  3.77134163e+00  3.77144169e+00  4.54702612e+00
  4.54704254e+00  4.66024394e+00  4.66443652e+00  4.66445598e+00
  8.76296099e+00  9.08996646e+00  9.10318046e+00  9.14698784e+00]
nelec by numeric integration = 15.999999999385869
    CPU time for vxc      0.61 sec, wall time      0.61 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86180601e-01 -1.39168063e-02 -5.48152739e-03 ...  9.13427317e-03
  -1.21792280e-02  1.75788161e-03]
 [-1.39168063e-02  4.75255332e-04  1.59443881e-03 ... -2.68388165e-04
   3.57507138e-04 -5.17485772e-05]
 [-5.48152739e-03  1.59443881e-03  7.83111565e-01 ... -3.52101880e-02
   2.41488432e-03  2.11402616e-02]
 ...
 [ 9.13427317e-03 -2.68388165e-04 -3.52101880e-02 ...  3.43454122e-03
  -5.43472605e-04  7.05228559e-04]
 [-1.21792280e-02  3.57507138e-04  2.41488432e-03 ... -5.43472605e-04
   3.66677831e-03  2.15438524e-04]
 [ 1.75788161e-03 -5.17485772e-05  2.11402616e-02 ...  7.05228559e-04
   2.15438524e-04  4.13517912e-03]]
[[ 3.43133855e-01 -3.21250257e-01  1.48820779e-01 ... -8.34965136e-01
   9.04676722e-01  1.01181602e+00]
 [-1.26900611e-02  8.66684457e-03  1.21071757e-03 ... -8.65397717e-01
   8.82716633e-01  8.23149189e-01]
 [-2.64530974e-04  7.02752147e-02  1.33403244e-01 ... -1.03446638e-04
  -1.52306844e-02  1.44098818e-01]
 ...
 [-1.80815291e-04 -1.52427482e-02 -1.74900903e-03 ... -4.26650418e-04
  -3.82706486e-02 -5.44410010e-02]
 [ 2.41720390e-04  2.03236760e-02  2.33135356e-03 ...  5.82273701e-04
   5.10294452e-02  7.26122727e-02]
 [-3.47312862e-05 -2.93365330e-03 -3.36804507e-04 ... -8.69829669e-05
  -7.36926551e-03 -1.04800147e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.008040666580200195
    CPU time for vj and vk      0.37 sec, wall time      0.38 sec
E1 = 8.784685077522717  Ecoul = 2.8271931330998963  Exc = -6.605315630456726
Extra cycle  E= -20.6111836158063  delta_E= -2.18e-11  |g|= 1.22e-05  |ddm|= 2.44e-05
    CPU time for scf_cycle      2.97 sec, wall time      2.98 sec
    CPU time for SCF      3.01 sec, wall time      3.03 sec
converged SCF energy = -20.6111836158063
Successfully saved all results to /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-5e-05/48100077/scf.h5
