SLURMD_NODENAME = hpc-54-10
Start time = Wed Mar 19 05:11:33 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 409600
TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-0.0005/48100076/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-0.0005/48100076/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-ks
chk_path = ../../../gdf-64/tmp/scf.h5
mesh = 1,1,2
rcut_epsilon =  1.00e-05
ke_epsilon =  1.00e-02
isdf_thresh =  5.00e-04

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
None

******** <class 'ISDFX'> ********
lin_dep_thresh: 1e-10
alpha_cutoff: 2.8
rcut_epsilon: 1e-05
ke_epsilon: 0.01
isdf_thresh: 0.0005
grid_vol_cutoff: 0.05
ke_step: 2.0
ao_tol: 1e-12
multigrid_on: True
direct_j: True
iterative_build: True
occRI: True
voronoi: True
fit_sparse_grid: False
fit_dense_grid: True
direct_k_sparse: True
direct_k: False
use_kpt_symm: False
kmesh: [1, 1, 1]
isdf_pts_from_q0: True
isdf_pts_from_gamma_point: False
alpha: None
do_real_isdf: False
N_xi: None
use_cell_periodic: False
isdf_thresh_sparse: None
ncopy: [1, 1, 1]
j_grid_mesh: None
k_grid_mesh: None
num_j_grids: 100
get_ao_from_pyscf: False
nuc_pp_version: 0
vppnl_ver: 0
universal_dense_grid: None
same_jk_grids: None
coulomb_only: False
max_memory   409600 MB (current use       90 MB)

Exchange function: getK_occRI  

cell mesh: [23 23 47]
nbas:  48
Grid     keMax    keMin    keGrid   expMax   expMin   nexp     lmax     PWs      mesh        
0        51.6     51.6     105.5    5.6      5.6      1        2        24863    [23 23 47]
1        19.5     3.2      19.5     2.1      0.3      3        2        2541     [11 11 21]
0        77.4     52.8     105.5    5.6      5.6      1        2        24863    [23 23 47]
1        29.2     4.8      29.2     2.1      0.3      3        2        4225     [13 13 25]

ISDF

atm      grid     Ng       NI       Nxi      sharp    on_grid  diffuse  maxexp   minexp   lmax     lmin    
0        0        24863    2021     78       9        108      99       5.61     5.61     2        0       
1        0        24863    2012     75       9        108      99       5.61     5.61     2        0       
2        0        24863    2012     75       9        108      99       5.61     5.61     2        0       
3        0        24863    2021     78       9        108      99       5.61     5.61     2        0       
-        1        2541     2541     2541     108      108      108      2.11     0.35     2        0       
ISDF-pts:       0.29
ISDF-vec:       0.02
Fit dense grids ISDF:       0.30
Fit sparse grids ISDF:       0.00

Grid     PWs      Ng_i     N_xi     N_mu    
0        24863    8066     306      432     
1        2541     2541     2541     108     

nTHC: 2847
Mem Required (MB):       6.69
Curent RAM Use (MB) :        138 

Build W
ISDF-fft dense grids (sec):       0.53
Curent RAM Use (MB) :        203 
ISDF-fft:       0.53

Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 16.1866)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 16
Successfully loaded dm0 from ../../../gdf-64/tmp/scf.h5
Successfully loaded h1e and s1e from ../../../gdf-64/tmp/scf.h5
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.007946252822875977


******** <class 'pyscf.pbc.dft.rks.RKS'> ********
method = RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-0.0005/48100076/tmp06n0_7zf
max_memory 409600 MB (current use 204 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <isdfx.isdfx.ISDFX object at 0x7f70974c04f0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Overwritten attributes  get_ovlp get_hcore  of <class 'pyscf.pbc.dft.rks.RKS'>
Set gradient conv threshold to 0.0001
nelec by numeric integration = 15.999999999385867
    CPU time for vxc      0.62 sec, wall time      0.62 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86172193e-01 -1.39157814e-02 -5.48149956e-03 ...  9.13456109e-03
  -1.21802416e-02  1.75790149e-03]
 [-1.39157814e-02  4.75208863e-04  1.59535658e-03 ... -2.68386526e-04
   3.57437715e-04 -5.16897598e-05]
 [-5.48149956e-03  1.59535658e-03  7.83114655e-01 ... -3.52104339e-02
   2.41358660e-03  2.11413002e-02]
 ...
 [ 9.13456109e-03 -2.68386526e-04 -3.52104339e-02 ...  3.43456457e-03
  -5.43261351e-04  7.05178178e-04]
 [-1.21802416e-02  3.57437715e-04  2.41358660e-03 ... -5.43261351e-04
   3.66659588e-03  2.15409911e-04]
 [ 1.75790149e-03 -5.16897598e-05  2.11413002e-02 ...  7.05178178e-04
   2.15409911e-04  4.13531469e-03]]
[[ 3.43138044e-01 -3.21239995e-01  1.48819146e-01 ... -8.35271853e-01
   9.05003501e-01  1.01235205e+00]
 [-1.26902860e-02  8.66516395e-03  1.21082496e-03 ... -8.65349065e-01
   8.82649247e-01  8.22969836e-01]
 [-2.65227932e-04  7.02796132e-02  1.33403637e-01 ... -4.67579470e-05
  -1.52561423e-02  1.44412452e-01]
 ...
 [-1.80384789e-04 -1.52432558e-02 -1.74880003e-03 ... -3.73965876e-04
  -3.82990561e-02 -5.44957798e-02]
 [ 2.40652775e-04  2.03248609e-02  2.33165397e-03 ...  5.15109871e-04
   5.10645343e-02  7.26857653e-02]
 [-3.47635032e-05 -2.93364175e-03 -3.36699731e-04 ... -7.68381247e-05
  -7.37483546e-03 -1.04905210e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.007696628570556641
    CPU time for vj and vk      0.36 sec, wall time      0.37 sec
E1 = 8.784676807250891  Ecoul = 2.827202858991142  Exc = -6.605226934676221
init E= -20.6110934644064
    CPU time for initialize scf      0.99 sec, wall time      1.00 sec
  HOMO = 0.617498715533148  LUMO = 0.871931171846762
  mo_energy =
[-2.23598428e-01 -7.28243594e-03  7.95030221e-02  4.86966644e-01
  4.86985655e-01  5.99518787e-01  5.99542505e-01  6.17498716e-01
  8.71931172e-01  8.75239376e-01  8.75253469e-01  9.96349262e-01
  9.96363272e-01  1.02620041e+00  1.22627030e+00  1.38954740e+00
  1.74927057e+00  1.78006739e+00  1.78006755e+00  1.94436693e+00
  1.94439374e+00  2.08926443e+00  2.08926979e+00  2.43893361e+00
  2.44480356e+00  2.44480892e+00  2.51765633e+00  2.51778216e+00
  2.51785602e+00  2.67921353e+00  2.93556134e+00  2.97055901e+00
  2.97061042e+00  3.01082206e+00  3.01086440e+00  3.30313080e+00
  3.59739942e+00  3.59739978e+00  3.64871336e+00  3.64873228e+00
  3.77126343e+00  3.77134281e+00  3.77144281e+00  4.54702680e+00
  4.54704319e+00  4.66024477e+00  4.66443743e+00  4.66445683e+00
  8.76296388e+00  9.08996958e+00  9.10318299e+00  9.14699043e+00]
nelec by numeric integration = 15.999999999385878
    CPU time for vxc      0.59 sec, wall time      0.59 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86201163e-01 -1.39109813e-02 -5.47214089e-03 ...  9.13674009e-03
  -1.21801230e-02  1.75792496e-03]
 [-1.39109813e-02  4.74916293e-04  1.59640802e-03 ... -2.68523060e-04
   3.57488152e-04 -5.17011176e-05]
 [-5.47214089e-03  1.59640802e-03  7.83116386e-01 ... -3.52094054e-02
   2.41779461e-03  2.11421432e-02]
 ...
 [ 9.13674009e-03 -2.68523060e-04 -3.52094054e-02 ...  3.43472504e-03
  -5.43731817e-04  7.05184928e-04]
 [-1.21801230e-02  3.57488152e-04  2.41779461e-03 ... -5.43731817e-04
   3.66670322e-03  2.15203280e-04]
 [ 1.75792496e-03 -5.17011176e-05  2.11421432e-02 ...  7.05184928e-04
   2.15203280e-04  4.13502641e-03]]
[[ 3.43152401e-01 -3.21241352e-01 -1.48831777e-01 ...  8.35584533e-01
  -9.04104123e-01  1.01179744e+00]
 [-1.26856175e-02  8.66321135e-03 -1.21316916e-03 ...  8.66002129e-01
  -8.82123625e-01  8.23128919e-01]
 [-2.65133924e-04  7.02717276e-02 -1.33404325e-01 ...  9.28653323e-05
   1.52310813e-02  1.44098357e-01]
 ...
 [-1.78020904e-04 -1.52446811e-02  1.75025442e-03 ...  4.00386676e-04
   3.82708384e-02 -5.44410477e-02]
 [ 2.40091911e-04  2.03251200e-02 -2.33369610e-03 ... -5.47231964e-04
  -5.10297288e-02  7.26122919e-02]
 [-3.51241362e-05 -2.93356316e-03  3.36084553e-04 ...  8.19215234e-05
   7.36930845e-03 -1.04800529e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.007850408554077148
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = 8.784695380625143  Ecoul = 2.827179148671762  Exc = -6.605221803060734
cycle= 1 E= -20.611093469736  delta_E= -5.33e-09  |g|= 1.6e-05  |ddm|= 0.000146
    CPU time for cycle= 1      0.95 sec, wall time      0.96 sec
  HOMO = 0.61749871019749  LUMO = 0.871929045214983
  mo_energy =
[-2.23599658e-01 -7.28478835e-03  7.95039118e-02  4.86964543e-01
  4.86984199e-01  5.99515989e-01  5.99540612e-01  6.17498710e-01
  8.71929045e-01  8.75238584e-01  8.75252610e-01  9.96347808e-01
  9.96361345e-01  1.02619728e+00  1.22626813e+00  1.38954601e+00
  1.74926909e+00  1.78006662e+00  1.78006714e+00  1.94436540e+00
  1.94439296e+00  2.08926416e+00  2.08927015e+00  2.43893144e+00
  2.44480258e+00  2.44480763e+00  2.51765466e+00  2.51777946e+00
  2.51785376e+00  2.67921252e+00  2.93556071e+00  2.97055669e+00
  2.97060815e+00  3.01081929e+00  3.01086202e+00  3.30312803e+00
  3.59739774e+00  3.59739863e+00  3.64871168e+00  3.64873099e+00
  3.77126213e+00  3.77134038e+00  3.77144094e+00  4.54702535e+00
  4.54704203e+00  4.66024306e+00  4.66443560e+00  4.66445523e+00
  8.76295855e+00  9.08996413e+00  9.10317795e+00  9.14698557e+00]
nelec by numeric integration = 15.999999999385881
    CPU time for vxc      0.59 sec, wall time      0.59 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 4.86200601e-01 -1.39109665e-02 -5.47331236e-03 ...  9.13682331e-03
  -1.21800555e-02  1.75789941e-03]
 [-1.39109665e-02  4.74917339e-04  1.59659633e-03 ... -2.68543307e-04
   3.57508696e-04 -5.17045017e-05]
 [-5.47331236e-03  1.59659633e-03  7.83114377e-01 ... -3.52094639e-02
   2.41759302e-03  2.11424657e-02]
 ...
 [ 9.13682331e-03 -2.68543307e-04 -3.52094639e-02 ...  3.43471043e-03
  -5.43703377e-04  7.05180368e-04]
 [-1.21800555e-02  3.57508696e-04  2.41759302e-03 ... -5.43703377e-04
   3.66664008e-03  2.15205659e-04]
 [ 1.75789941e-03 -5.17045017e-05  2.11424657e-02 ...  7.05180368e-04
   2.15205659e-04  4.13502114e-03]]
[[ 3.43144792e-01 -3.21249467e-01  1.48830865e-01 ... -8.35122259e-01
   9.04531221e-01  1.01181041e+00]
 [-1.26853628e-02  8.66359396e-03  1.21328923e-03 ... -8.65551076e-01
   8.82566228e-01  8.23144093e-01]
 [-2.64315869e-04  7.02711508e-02  1.33403541e-01 ... -1.00643132e-04
  -1.52310607e-02  1.44098474e-01]
 ...
 [-1.78205897e-04 -1.52445769e-02 -1.75042230e-03 ... -4.20030185e-04
  -3.82706824e-02 -5.44411164e-02]
 [ 2.40474071e-04  2.03248205e-02  2.33388727e-03 ...  5.73403556e-04
   5.10295095e-02  7.26123242e-02]
 [-3.51994194e-05 -2.93350141e-03 -3.36113833e-04 ... -8.56987497e-05
  -7.36927321e-03 -1.04800472e-02]]
[2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
start SG
end SG -->  0.008255481719970703
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = 8.784693026737136  Ecoul = 2.827182507694767  Exc = -6.605222808229011
Extra cycle  E= -20.6110934697693  delta_E= -3.33e-11  |g|= 1.01e-05  |ddm|= 2.24e-05
    CPU time for scf_cycle      2.90 sec, wall time      2.91 sec
    CPU time for SCF      2.94 sec, wall time      2.96 sec
converged SCF energy = -20.6110934697693
Successfully saved all results to /central/scratch/yangjunjie//run-scf-spc-diamond-prim-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-0.0005/48100076/scf.h5
