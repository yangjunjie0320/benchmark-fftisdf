SLURMD_NODENAME = hpc-52-03
Start time = Mon Mar 17 04:17:51 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 409600
TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-conv-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-4e-05/48050899/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-spc-diamond-conv-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-4e-05/48050899/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-conv
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-ks
chk_path = ../../../gdf-32/tmp/scf.h5
mesh = 1,1,2
rcut_epsilon =  1.00e-05
ke_epsilon =  1.00e-02
isdf_thresh =  4.00e-05

Discarded 24 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
None

******** <class 'ISDFX'> ********
lin_dep_thresh: 1e-10
alpha_cutoff: 2.8
rcut_epsilon: 1e-05
ke_epsilon: 0.01
isdf_thresh: 4e-05
grid_vol_cutoff: 0.05
ke_step: 2.0
ao_tol: 1e-12
multigrid_on: True
direct_j: True
iterative_build: True
occRI: True
voronoi: True
fit_sparse_grid: False
fit_dense_grid: True
direct_k_sparse: True
direct_k: False
use_kpt_symm: False
kmesh: [1, 1, 1]
isdf_pts_from_q0: True
isdf_pts_from_gamma_point: False
alpha: None
do_real_isdf: False
N_xi: None
use_cell_periodic: False
isdf_thresh_sparse: None
ncopy: [1, 1, 1]
j_grid_mesh: None
k_grid_mesh: None
num_j_grids: 100
get_ao_from_pyscf: False
nuc_pp_version: 0
vppnl_ver: 0
universal_dense_grid: None
same_jk_grids: None
coulomb_only: False
max_memory   409600 MB (current use       90 MB)

Exchange function: getK_occRI  

cell mesh: [33 33 67]
nbas:  192
Grid     keMax    keMin    keGrid   expMax   expMin   nexp     lmax     PWs      mesh        
0        51.6     51.6     111.6    5.6      5.6      1        2        72963    [33 33 67]
1        19.5     3.2      19.5     2.1      0.3      3        2        6525     [15 15 29]
0        77.4     55.8     111.6    5.6      5.6      1        2        72963    [33 33 67]
1        29.2     14.6     29.2     2.1      2.1      1        2        12635    [19 19 35]
2        10.6     4.8      10.6     0.8      0.3      2        2        2541     [11 11 21]

ISDF

atm      grid     Ng       NI       Nxi      sharp    on_grid  diffuse  maxexp   minexp   lmax     lmin    
0        0        72963    1458     120      9        279      270      5.61     5.61     2        0       
1        0        72963    1474     119      9        279      270      5.61     5.61     2        0       
2        0        72963    1470     120      9        279      270      5.61     5.61     2        0       
3        0        72963    1487     119      9        279      270      5.61     5.61     2        0       
4        0        72963    1470     120      9        279      270      5.61     5.61     2        0       
5        0        72963    1487     119      9        279      270      5.61     5.61     2        0       
6        0        72963    1464     119      9        279      270      5.61     5.61     2        0       
7        0        72963    1474     119      9        279      270      5.61     5.61     2        0       
8        0        72963    1458     120      9        279      270      5.61     5.61     2        0       
9        0        72963    1487     119      9        279      270      5.61     5.61     2        0       
10       0        72963    1484     118      9        279      270      5.61     5.61     2        0       
11       0        72963    1474     119      9        279      270      5.61     5.61     2        0       
12       0        72963    1484     118      9        279      270      5.61     5.61     2        0       
13       0        72963    1474     119      9        279      270      5.61     5.61     2        0       
14       0        72963    1464     119      9        279      270      5.61     5.61     2        0       
15       0        72963    1487     119      9        279      270      5.61     5.61     2        0       
-        1        6525     6525     6525     432      432      432      2.11     0.35     2        0       
ISDF-pts:       1.67
ISDF-vec:       0.18
Fit dense grids ISDF:       1.85
Fit sparse grids ISDF:       0.00

Grid     PWs      Ng_i     N_xi     N_mu    
0        72963    23596    1906     4464    
1        6525     6525     6525     432     

nTHC: 8431
Mem Required (MB):     114.93
Curent RAM Use (MB) :        215 

Build W
ISDF-fft dense grids (sec):      14.54
Curent RAM Use (MB) :        302 
ISDF-fft:      14.54

Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 63.9864)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 64
Successfully loaded dm0 from ../../../gdf-32/tmp/scf.h5
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.92609815e-01 -2.07733389e-02 -1.49374411e-10 ...  3.29312158e-03
  -3.30285561e-03  3.70086867e-13]
 [-2.07733389e-02  8.44685909e-04 -2.19531692e-13 ... -2.09902515e-04
   1.65272475e-04 -3.14121417e-14]
 [-1.49374411e-10 -2.19531692e-13  6.49906929e-01 ...  1.14960616e-04
   2.10995193e-03  3.14505479e-03]
 ...
 [ 3.29312158e-03 -2.09902515e-04  1.14960616e-04 ...  4.46214761e-04
   2.63029861e-08  5.06489513e-15]
 [-3.30285561e-03  1.65272475e-04  2.10995193e-03 ...  2.63029861e-08
   2.26887108e-03  4.99288212e-08]
 [ 3.70086867e-13 -3.14121417e-14  3.14505479e-03 ...  5.06489513e-15
   4.99288212e-08  6.71985021e-04]]
[[ 1.71226849e-01 -1.71868037e-05  2.07241950e-01 ...  2.53723403e-09
  -1.69503661e-11 -1.15456586e+00]
 [-6.74284167e-03  7.43617044e-06 -4.11327152e-03 ...  2.30836473e-09
  -1.52694452e-11 -1.06092267e+00]
 [-9.60288977e-11 -1.84902267e-10 -1.78613800e-11 ... -5.27918257e-02
   1.48520477e-11 -1.18363527e-10]
 ...
 [-6.95558329e-05  1.20762008e-03  1.20741071e-03 ... -1.84653773e-02
  -3.83714359e-12 -4.53892981e-03]
 [ 1.02250060e-07  6.87865355e-08  1.96724149e-07 ...  3.72783696e-05
  -5.79794753e-02 -4.16962067e-02]
 [ 1.72642797e-13 -1.25175997e-14 -4.37896978e-13 ... -2.06932479e-04
   8.52717544e-06 -2.00410681e-13]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.
 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.92609815e-01 -2.07733389e-02 -1.49374411e-10 ...  3.29312158e-03
  -3.30285561e-03  3.70086867e-13]
 [-2.07733389e-02  8.44685909e-04 -2.19531692e-13 ... -2.09902515e-04
   1.65272475e-04 -3.14121417e-14]
 [-1.49374411e-10 -2.19531692e-13  6.49906929e-01 ...  1.14960616e-04
   2.10995193e-03  3.14505479e-03]
 ...
 [ 3.29312158e-03 -2.09902515e-04  1.14960616e-04 ...  4.46214761e-04
   2.63029861e-08  5.06489513e-15]
 [-3.30285561e-03  1.65272475e-04  2.10995193e-03 ...  2.63029861e-08
   2.26887108e-03  4.99288212e-08]
 [ 3.70086867e-13 -3.14121417e-14  3.14505479e-03 ...  5.06489513e-15
   4.99288212e-08  6.71985021e-04]]
[[ 1.71226849e-01 -1.71868037e-05  2.07241950e-01 ...  2.53723403e-09
  -1.69503661e-11 -1.15456586e+00]
 [-6.74284167e-03  7.43617044e-06 -4.11327152e-03 ...  2.30836473e-09
  -1.52694452e-11 -1.06092267e+00]
 [-9.60288977e-11 -1.84902267e-10 -1.78613800e-11 ... -5.27918257e-02
   1.48520477e-11 -1.18363527e-10]
 ...
 [-6.95558329e-05  1.20762008e-03  1.20741071e-03 ... -1.84653773e-02
  -3.83714359e-12 -4.53892981e-03]
 [ 1.02250060e-07  6.87865355e-08  1.96724149e-07 ...  3.72783696e-05
  -5.79794753e-02 -4.16962067e-02]
 [ 1.72642797e-13 -1.25175997e-14 -4.37896978e-13 ... -2.06932479e-04
   8.52717544e-06 -2.00410681e-13]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.
 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  0.5046632289886475


******** <class 'pyscf.pbc.dft.rks.RKS'> ********
method = RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-spc-diamond-conv-1-1-2-fftisdf-ks-1-100-rcut_epsilon-1e-05-ke_epsilon-0.01-isdf_thresh-4e-05/48050899/tmp9lxob13p
max_memory 409600 MB (current use 281 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <isdfx.isdfx.ISDFX object at 0x7f5a53f6f670>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 63.999999995674415
    CPU time for vxc      5.12 sec, wall time      5.13 sec
~/packages/PeriodicIntegrals/PeriodicIntegrals-junjie-benchmark/isdfx/isdfx.py +4733
[[ 5.92609815e-01 -2.07733389e-02 -1.49374411e-10 ...  3.29312158e-03
  -3.30285561e-03  3.70086867e-13]
 [-2.07733389e-02  8.44685909e-04 -2.19531692e-13 ... -2.09902515e-04
   1.65272475e-04 -3.14121417e-14]
 [-1.49374411e-10 -2.19531692e-13  6.49906929e-01 ...  1.14960616e-04
   2.10995193e-03  3.14505479e-03]
 ...
 [ 3.29312158e-03 -2.09902515e-04  1.14960616e-04 ...  4.46214761e-04
   2.63029861e-08  5.06489513e-15]
 [-3.30285561e-03  1.65272475e-04  2.10995193e-03 ...  2.63029861e-08
   2.26887108e-03  4.99288212e-08]
 [ 3.70086867e-13 -3.14121417e-14  3.14505479e-03 ...  5.06489513e-15
   4.99288212e-08  6.71985021e-04]]
[[ 1.71226849e-01 -1.71868037e-05  2.07241950e-01 ...  2.53723403e-09
  -1.69503661e-11 -1.15456586e+00]
 [-6.74284167e-03  7.43617044e-06 -4.11327152e-03 ...  2.30836473e-09
  -1.52694452e-11 -1.06092267e+00]
 [-9.60288977e-11 -1.84902267e-10 -1.78613800e-11 ... -5.27918257e-02
   1.48520477e-11 -1.18363527e-10]
 ...
 [-6.95558329e-05  1.20762008e-03  1.20741071e-03 ... -1.84653773e-02
  -3.83714359e-12 -4.53892981e-03]
 [ 1.02250060e-07  6.87865355e-08  1.96724149e-07 ...  3.72783696e-05
  -5.79794753e-02 -4.16962067e-02]
 [ 1.72642797e-13 -1.25175997e-14 -4.37896978e-13 ... -2.06932479e-04
   8.52717544e-06 -2.00410681e-13]]
[2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.
 2. 2. 2. 2. 2. 2. 2. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
start SG
end SG -->  0.41167783737182617
    CPU time for vj and vk      3.07 sec, wall time      3.09 sec
E1 = 32.24977427473257  Ecoul = 8.78255097695386  Exc = -26.90113813876419
init E= -88.3397976709662
    CPU time for initialize scf     13.71 sec, wall time     13.76 sec
  HOMO = 0.536067178450008  LUMO = 0.80943574522557
  mo_energy =
[-0.30703877 -0.23037826 -0.23037676  0.01819639  0.01819794  0.01819805
  0.01819869  0.02074365  0.02074367  0.0498261   0.04982773  0.04982784
  0.04982874  0.20941228  0.20941295  0.20941305  0.20941316  0.27473875
  0.2747391   0.28470579  0.28470649  0.28470659  0.28470677  0.35003462
  0.35003519  0.36703906  0.36703943  0.36704053  0.36704087  0.53175007
  0.53606671  0.53606718  0.80943575  0.80943642  0.84213356  0.84353787
  0.84353789  0.86872865  0.86872918  0.86987392  0.86987392  0.8698741
  0.86987463  1.07968484  1.07968487  1.07968768  1.07968769  1.08825455
  1.08825483  1.08825484  1.08825594  1.11764364  1.11764467  1.1176447
  1.11764601  1.1350069   1.13500731  1.17884348  1.27842803  1.27842811
  1.27842842  1.27843303  1.27938163  1.27938167  1.59326122  1.59326317
  1.59326318  1.5932677   1.63353002  1.63353148  1.71408149  1.71408581
  1.7149492   1.71495294  1.71495296  1.71496108  1.75642909  1.75799241
  1.87335783  1.87336078  1.90147614  1.90147761  2.04010309  2.04010317
  2.04018391  2.04018392  2.04019131  2.04019145  2.06112723  2.06112948
  2.0611295   2.06113318  2.25906887  2.25906895  2.25907224  2.25907227
  2.34568164  2.3458016   2.34580236  2.34580236  2.3472139   2.34733457
  2.40765157  2.40765157  2.40805498  2.47230706  2.4726437   2.47264393
  2.49628961  2.49628975  2.49629015  2.49629095  2.53729004  2.53729006
  2.53729419  2.53729429  2.768707    2.76870736  2.76870752  2.76870944
  2.78765079  2.78765092  2.7876648   2.78766924  2.7877318   2.78773186
  2.79524065  2.79524129  2.88460084  2.88460161  2.88460165  2.88460496
  2.98052063  2.98052996  2.98053003  2.98053044  2.98075935  2.98076893
  3.02121465  3.02121487  3.02150409  3.02150433  3.0215104   3.02151077
  3.07447423  3.07447429  3.10636196  3.10636198  3.10636208  3.10636351
  3.26842822  3.26843134  3.2684315   3.26843471  3.28599818  3.28600204
  3.35178441  3.35178687  3.41724502  3.41724514  3.41725126  3.41725137
  3.42814217  3.42821298  3.42901555  3.42901648  3.42901653  3.42908437
  3.56124428  3.56379307  3.73143572  3.73165951  3.73165997  3.83440032
  3.83440834  4.3391518   4.33915511  4.33915517  4.33915935  4.62138589
  4.62138593  4.62243872  4.72312818  4.72312876  4.72324692  4.72324712
  4.72362683  4.7236269   4.72370425  4.7237095   4.72392278  4.72392307
  8.67247094  8.85902269  8.85904052  9.00050428  9.01011898  9.014484
  9.01453887  9.01453888  9.01465391  9.02133397  9.0277252   9.03150284
  9.03630374  9.03630376  9.03651447  9.0405501 ]
