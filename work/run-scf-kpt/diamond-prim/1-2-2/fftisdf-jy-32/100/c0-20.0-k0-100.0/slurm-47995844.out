SLURMD_NODENAME = hpc-19-30
Start time = Thu Mar 13 04:24:47 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-100.0/47995844/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-100.0/47995844/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  1.00e+02

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.20686971]
 [ 0.          0.          0.41373942]
 ...
 [-0.2388726  -0.16890841 -0.82747884]
 [-0.2388726  -0.16890841 -0.62060913]
 [-0.2388726  -0.16890841 -0.41373942]], m0 = [23 23 23]
Pivoted Cholesky rank = 375, estimated error = 0.00e+00
Parent grid size = 12167, selected grid size = 520
    CPU time for interpolating functions     23.30 sec, wall time      4.75 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.26 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      6.49 sec, wall time      1.46 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    225.11 sec, wall time     24.88 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 291 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    230.75 sec, wall time     24.89 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 291 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    203.02 sec, wall time     18.83 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 291 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    194.27 sec, wall time     16.47 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 291 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-100.0/47995844/tmpapt6n35u
    CPU time for building ISDF    864.33 sec, wall time     87.14 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-100.0/47995844/tmp1579h0sk
max_memory 81920 MB (current use 301 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f92e41c1cd0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc     11.76 sec, wall time      1.20 sec
    CPU time for vj and vk     11.68 sec, wall time      1.27 sec
E1 = (4.673183787659305-4.658492596340378e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.391488820715659
init E= -10.0507140589067
    CPU time for initialize scf     37.69 sec, wall time      4.24 sec
HOMO = 0.61703092995  LUMO = 0.80393558859
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655643  0.61115172  0.61138921  0.61703093] [0.80393559 0.80814325 0.8109267  1.13006432 1.73332515 1.73555938
 2.40667472 2.4072241  2.4080125  2.50110856 2.50172513 2.50205362
 3.56784068 3.56831734 3.76714001 3.76716363 3.76793494 4.64476299
 4.64490848 4.64502915 8.84194556 9.17012074]
   1 ( 0.000  0.000  0.500)   [-0.0376923   0.06166882  0.49459452  0.5013061 ] [0.93251585 0.93680297 0.94438468 1.33409961 1.72140178 1.90372392
 1.90506899 2.0447733  2.04669216 2.65773401 2.90262878 2.95423629
 2.95472515 2.98948619 2.9903856  3.28771919 3.6266439  3.62702986
 4.52707203 4.52716825 9.18283316 9.22710006]
   2 ( 0.000  0.500  0.000)   [-0.0376936   0.06166748  0.49459475  0.50130625] [0.93251953 0.93680441 0.94438577 1.33409839 1.72140192 1.9037278
 1.90506795 2.04477411 2.04669063 2.65773769 2.90262691 2.95423757
 2.95472517 2.98948626 2.99038439 3.28772105 3.62664655 3.62703021
 4.52706835 4.52716838 9.18283345 9.22709996]
   3 ( 0.000  0.500  0.500)   [0.07640462 0.07937175 0.34926045 0.36058394] [0.82049171 0.82899902 1.27129897 1.27175742 1.72863911 1.72939637
 2.03063086 2.03250334 2.33430092 2.33445606 2.81522388 2.81661527
 2.98769413 2.988782   3.03483434 3.03570975 3.43441416 3.43506244
 4.75293878 4.7532495  9.18254845 9.18256366]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc     16.47 sec, wall time      1.84 sec
    CPU time for vj and vk     11.93 sec, wall time      1.20 sec
E1 = (4.205081771496302-1.6804999381883782e-18j)  Ecoul = (1.1845402051728244+4.452267840194973e-25j)  Exc = -3.288181584056638
cycle= 1 E= -10.7074327053736  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     28.68 sec, wall time      3.07 sec
HOMO = 0.569684969785  LUMO = 0.774545866169
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823324  0.55648842  0.56495316  0.56968497] [0.77454587 0.77912875 0.78469258 1.11984172 1.7080974  1.70832813
 2.37427777 2.37655608 2.37739451 2.44836278 2.45168814 2.45230422
 3.53690012 3.54001663 3.71838494 3.71995551 3.72041599 4.60534805
 4.60715513 4.60870955 8.68226348 9.01323732]
   1 ( 0.000  0.000  0.500)   [-0.0541298   0.04171891  0.44623152  0.45411332] [0.90552525 0.90923707 0.92942319 1.2916495  1.67221956 1.86345389
 1.86548535 2.01769975 2.01914227 2.63026884 2.86488074 2.90392686
 2.90479856 2.95101764 2.95202033 3.24884372 3.59221963 3.59322974
 4.49054194 4.49146396 9.02632879 9.07132327]
   2 ( 0.000  0.500  0.000)   [-0.05413201  0.04171802  0.44623163  0.45411351] [0.90552783 0.90923903 0.92942485 1.29164719 1.67222097 1.86345309
 1.86549039 2.01770222 2.01914007 2.63026816 2.86487684 2.90392879
 2.90479949 2.95101579 2.95202158 3.24883862 3.5922202  3.59323079
 4.4905443  4.49146215 9.026329   9.07132246]
   3 ( 0.000  0.500  0.500)   [0.05607714 0.05914667 0.31090113 0.31918056] [0.80607978 0.81832842 1.22742278 1.22770167 1.67536817 1.67852512
 1.99604235 1.99673171 2.30681811 2.3090258  2.76485626 2.76597712
 2.95644759 2.95653467 2.99691738 3.00058544 3.402071   3.4032339
 4.71033473 4.71232919 9.02590828 9.02633923]
nelec by numeric integration = 7.999999999846837
    CPU time for vxc     17.71 sec, wall time      1.92 sec
    CPU time for vj and vk     12.30 sec, wall time      1.24 sec
E1 = (4.1655308330975975-1.6092151398569368e-18j)  Ecoul = (1.2397196634502565-8.502027292109977e-26j)  Exc = -3.306816882990818
cycle= 2 E= -10.710439484429  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     35.22 sec, wall time      3.75 sec
HOMO = 0.575298482086  LUMO = 0.779929165329
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343253  0.56308218  0.57102713  0.57529848] [0.77992917 0.78431737 0.78990023 1.12771625 1.71171539 1.71189735
 2.38020941 2.38220065 2.38283896 2.4556885  2.45875213 2.45938942
 3.54255136 3.54556103 3.72517556 3.72656245 3.726891   4.61194281
 4.61361082 4.61520019 8.69868182 9.0292878 ]
   1 ( 0.000  0.000  0.500)   [-0.0487487   0.04515902  0.4523129   0.45952051] [0.91067655 0.91469429 0.93574977 1.29962847 1.67872738 1.869367
 1.87099451 2.02146881 2.0230056  2.63471663 2.8712174  2.91135689
 2.91206546 2.95699791 2.95785879 3.2553095  3.59791717 3.59891122
 4.49658198 4.497582   9.04235143 9.08717044]
   2 ( 0.000  0.500  0.000)   [-0.048751    0.04515816  0.4523129   0.45952067] [0.91067891 0.91469625 0.93575147 1.29962623 1.67872883 1.86936622
 1.87099943 2.02147133 2.02300359 2.63471598 2.8712136  2.91135879
 2.91206642 2.95699621 2.95785998 3.25530477 3.59791766 3.59891216
 4.49658436 4.49758002 9.04235165 9.08716959]
   3 ( 0.000  0.500  0.500)   [0.06141298 0.06333601 0.31629014 0.32378082] [0.80986409 0.82299847 1.23521954 1.23561478 1.68271688 1.68607779
 2.00033187 2.00101501 2.31115147 2.31294707 2.77210933 2.77308476
 2.96178728 2.96199307 3.00305226 3.00623228 3.40835073 3.40914762
 4.71684731 4.71853135 9.0418805  9.0423478 ]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc     16.61 sec, wall time      1.94 sec
    CPU time for vj and vk     13.23 sec, wall time      1.34 sec
E1 = (4.170644276157631-1.5836405927931298e-18j)  Ecoul = (1.2320378791563456+1.0217326444422545e-25j)  Exc = -3.304307268009098
cycle= 3 E= -10.7104982106812  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3     35.18 sec, wall time      3.87 sec
HOMO = 0.575157336881  LUMO = 0.779854656269
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350551  0.562888    0.57084666  0.57515734] [0.77985466 0.78421367 0.78980426 1.12763441 1.71163376 1.71181831
 2.38011289 2.38208692 2.38270232 2.45545727 2.45856129 2.45917869
 3.54243866 3.54543287 3.72497046 3.72637571 3.72673916 4.61181053
 4.613444   4.61504232 8.69813661 9.0287528 ]
   1 ( 0.000  0.000  0.500)   [-0.04881762  0.04506378  0.45214663  0.45937012] [0.91056497 0.91460064 0.93566552 1.29947911 1.67853206 1.86920151
 1.87083416 2.02140906 2.02290767 2.63460527 2.87107699 2.91117977
 2.9118504  2.95684016 2.95773995 3.25516337 3.59776992 3.59876398
 4.49642085 4.49743056 9.0418173  9.08663812]
   2 ( 0.000  0.500  0.000)   [-0.04881991  0.04506291  0.45214663  0.45937031] [0.91056734 0.9146026  0.93566723 1.29947686 1.6785335  1.86920072
 1.87083909 2.02141158 2.02290567 2.63460461 2.87107318 2.91118166
 2.91185136 2.95683846 2.95774115 3.25515863 3.59777041 3.5987649
 4.49642324 4.49742858 9.04181752 9.08663727]
   3 ( 0.000  0.500  0.500)   [0.06129387 0.06327195 0.31615144 0.32365974] [0.80981831 0.82290655 1.23502454 1.2354958  1.68250034 1.6858493
 2.00022745 2.00088228 2.31105771 2.31285497 2.77194289 2.77286812
 2.96163564 2.96186252 3.00289773 3.00611131 3.40822198 3.40904278
 4.71672132 4.71835274 9.04134596 9.0418135 ]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     16.89 sec, wall time      1.92 sec
    CPU time for vj and vk     12.65 sec, wall time      1.30 sec
E1 = (4.170516820710687-1.5836386823361004e-18j)  Ecoul = (1.232227367559954-1.3959682578791025e-26j)  Exc = -3.304369345131634
cycle= 4 E= -10.7104982548471  delta_E= -4.42e-08  |g|= 7.17e-05  |ddm|= 0.000637
    CPU time for cycle= 4     34.87 sec, wall time      3.82 sec
HOMO = 0.575157189632  LUMO = 0.779853871653
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350628  0.56288763  0.57084539  0.57515719] [0.77985387 0.78421374 0.78980325 1.12763352 1.71163333 1.71181773
 2.38011128 2.38208628 2.38270262 2.45545659 2.45856037 2.45917752
 3.54243808 3.54543208 3.7249702  3.72637475 3.72673826 4.61180923
 4.61344371 4.61504141 8.69813532 9.02875153]
   1 ( 0.000  0.000  0.500)   [-0.04881846  0.04506305  0.45214635  0.45936951] [0.91056501 0.91459973 0.93566446 1.29947832 1.67853094 1.86920067
 1.87083381 2.02140764 2.02290764 2.63460396 2.87107603 2.91117869
 2.91185002 2.95683977 2.95773843 3.25516212 3.59776973 3.59876349
 4.49642061 4.49742983 9.0418161  9.08663679]
   2 ( 0.000  0.500  0.000)   [-0.04882075  0.04506219  0.45214635  0.45936969] [0.91056737 0.91460169 0.93566617 1.29947607 1.67853238 1.86919988
 1.87083874 2.02141016 2.02290563 2.6346033  2.87107222 2.91118058
 2.91185098 2.95683807 2.95773963 3.25515738 3.59777023 3.59876441
 4.496423   4.49742785 9.04181632 9.08663594]
   3 ( 0.000  0.500  0.500)   [0.0612931  0.06327112 0.31615119 0.32365934] [0.80981732 0.82290575 1.23502448 1.23549512 1.68249835 1.68584818
 2.00022619 2.00088202 2.3110569  2.3128545  2.77194178 2.77286763
 2.96163533 2.96186104 3.00289763 3.00611028 3.40822186 3.40904168
 4.7167199  4.71835294 9.04134453 9.04181235]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     16.22 sec, wall time      1.71 sec
    CPU time for vj and vk     12.63 sec, wall time      1.34 sec
E1 = (4.170516546132526-1.5838784215070875e-18j)  Ecoul = (1.2322277697133188+6.034470380578652e-26j)  Exc = -3.3043694723272927
cycle= 5 E= -10.7104982544675  delta_E= 3.8e-10  |g|= 0.000106  |ddm|= 0.000187
    CPU time for cycle= 5     34.06 sec, wall time      3.58 sec
HOMO = 0.575157170791  LUMO = 0.779853767141
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350639  0.56288757  0.57084521  0.57515717] [0.77985377 0.78421374 0.78980311 1.12763339 1.71163327 1.71181765
 2.38011106 2.38208619 2.38270265 2.45545648 2.45856025 2.45917735
 3.54243799 3.54543197 3.72497015 3.72637462 3.72673814 4.61180905
 4.61344366 4.61504128 8.69813514 9.02875136]
   1 ( 0.000  0.000  0.500)   [-0.04881857  0.04506295  0.4521463   0.45936943] [0.910565   0.91459961 0.93566431 1.29947821 1.67853078 1.86920055
 1.87083375 2.02140744 2.02290762 2.63460378 2.8710759  2.91117854
 2.91184995 2.95683971 2.95773823 3.25516196 3.5977697  3.59876341
 4.49642057 4.49742973 9.04181594 9.0866366 ]
   2 ( 0.000  0.500  0.000)   [-0.04882087  0.04506209  0.4521463   0.45936961] [0.91056737 0.91460156 0.93566602 1.29947596 1.67853223 1.86919976
 1.87083868 2.02140997 2.02290562 2.63460312 2.87107208 2.91118043
 2.91185092 2.95683801 2.95773942 3.25515721 3.59777019 3.59876433
 4.49642296 4.49742775 9.04181615 9.08663575]
   3 ( 0.000  0.500  0.500)   [0.06129299 0.063271   0.31615115 0.32365929] [0.80981717 0.82290564 1.23502445 1.23549503 1.68249808 1.68584801
 2.00022602 2.00088198 2.3110568  2.31285442 2.77194164 2.77286755
 2.96163526 2.96186085 3.00289761 3.00611014 3.40822184 3.40904152
 4.71671971 4.71835295 9.04134448 9.04181205]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc     16.88 sec, wall time      1.81 sec
    CPU time for vj and vk     12.34 sec, wall time      1.32 sec
E1 = (4.170516505835591-1.5837283735743482e-18j)  Ecoul = (1.2322278275213432-7.603988037606377e-26j)  Exc = -3.3043694905391403
cycle= 6 E= -10.7104982551683  delta_E= -7.01e-10  |g|= 2.69e-07  |ddm|= 0.000112
    CPU time for cycle= 6     34.50 sec, wall time      3.72 sec
HOMO = 0.575157166632  LUMO = 0.77985376546
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350641  0.56288755  0.5708452   0.57515717] [0.77985377 0.78421371 0.78980309 1.12763337 1.71163326 1.71181763
 2.38011105 2.38208617 2.38270263 2.45545645 2.45856025 2.45917733
 3.54243798 3.54543195 3.72497013 3.7263746  3.72673814 4.61180904
 4.61344364 4.61504127 8.69813511 9.02875133]
   1 ( 0.000  0.000  0.500)   [-0.04881858  0.04506293  0.45214628  0.45936941] [0.91056498 0.91459959 0.9356643  1.29947819 1.67853078 1.86920053
 1.87083373 2.02140743 2.02290761 2.63460377 2.87107588 2.91117853
 2.91184992 2.95683969 2.95773822 3.25516195 3.59776968 3.59876339
 4.49642054 4.49742971 9.04181591 9.08663657]
   2 ( 0.000  0.500  0.000)   [-0.04882088  0.04506207  0.45214628  0.45936959] [0.91056734 0.91460155 0.93566602 1.29947594 1.67853222 1.86919974
 1.87083866 2.02140996 2.0229056  2.63460311 2.87107206 2.91118042
 2.91185089 2.95683799 2.95773941 3.25515721 3.59777017 3.59876432
 4.49642293 4.49742773 9.04181613 9.08663572]
   3 ( 0.000  0.500  0.500)   [0.06129298 0.06327098 0.31615113 0.32365928] [0.80981715 0.82290563 1.23502442 1.23549503 1.68249805 1.68584799
 2.00022601 2.00088196 2.31105679 2.3128544  2.77194163 2.77286752
 2.96163524 2.96186084 3.00289759 3.00611013 3.40822182 3.40904151
 4.71671971 4.71835292 9.04134444 9.04181202]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc     17.39 sec, wall time      1.93 sec
    CPU time for vj and vk     12.23 sec, wall time      1.31 sec
E1 = (4.170516494382-1.5837291773794344e-18j)  Ecoul = (1.2322278445852441+5.600281338345007e-26j)  Exc = -3.3043694961494463
Extra cycle  E= -10.7104982551683  delta_E= 3.55e-15  |g|= 4.02e-07  |ddm|= 6.72e-07
    CPU time for scf_cycle    270.39 sec, wall time     29.35 sec
    CPU time for SCF    272.29 sec, wall time     29.61 sec
converged SCF energy = -10.7104982551683
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-100.0/47995844/scf.h5
