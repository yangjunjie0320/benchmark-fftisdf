SLURMD_NODENAME = hpc-34-20
Start time = Thu Mar 13 04:24:11 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-5.0/47995798/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-5.0/47995798/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  5.00e+00
k0 = None

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
Pivoted Cholesky rank = 245, estimated error = 2.56e-02
Parent grid size = 245, selected grid size = 130
    CPU time for interpolating functions      3.39 sec, wall time      0.11 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 130, nao = 26, cisdf =   5.00
    CPU time for get interpolating vectors      3.30 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 1.01e-01 GB
    CPU time for aoR_loop: [      0,   12167]      8.52 sec, wall time      0.30 sec
eta_kpt.shape = (4, 12167, 130)
Memory used for eta_kpt = 1.01e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      7.24 sec, wall time      0.25 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 130 / 130

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      7.54 sec, wall time      0.25 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 130 / 130

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      8.08 sec, wall time      0.27 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 130 / 130

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      7.71 sec, wall time      0.26 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 130 / 130
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-5.0/47995798/tmplu_0d5co
    CPU time for building ISDF     47.43 sec, wall time      1.60 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-5.0/47995798/tmpni0rwb1t
max_memory 81920 MB (current use 313 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7fe7d59e7be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.50 sec, wall time      0.27 sec
    CPU time for vj and vk      6.09 sec, wall time      0.19 sec
E1 = (4.673183787659304-5.8684906733120314e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.4019315398685515
init E= -10.0611567780596
    CPU time for initialize scf     22.86 sec, wall time      0.76 sec
HOMO = 0.615929674416  LUMO = 0.801776929096
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24915481  0.60940768  0.60972547  0.61592967] [0.80177693 0.8067234  0.81008953 1.12391299 1.73260406 1.73515471
 2.40454349 2.4071855  2.40819253 2.49798547 2.4989886  2.50094241
 3.56751333 3.56806887 3.76362505 3.76525106 3.76733597 4.64280699
 4.64458227 4.64474478 8.84219901 9.1705979 ]
   1 ( 0.000  0.000  0.500)   [-0.04029862  0.06088059  0.49254401  0.50016568] [0.93225517 0.93624204 0.93977538 1.33105167 1.72090374 1.9023335
 1.90463728 2.04394764 2.04582594 2.65642517 2.901554   2.95006083
 2.95489367 2.98862363 2.98910501 3.28431956 3.62494355 3.62705254
 4.5248533  4.52689843 9.18336189 9.2272195 ]
   2 ( 0.000  0.500  0.000)   [-0.04340286  0.0637376   0.49271857  0.50003079] [0.93054576 0.93619974 0.94084982 1.33444197 1.71700016 1.90284361
 1.90469137 2.04420667 2.04628693 2.65737827 2.89804511 2.95341724
 2.95495063 2.98807745 2.98968993 3.28248535 3.62541389 3.62626767
 4.52588988 4.52677887 9.1827179  9.2274339 ]
   3 ( 0.000  0.500  0.500)   [0.07189368 0.07938923 0.34768809 0.35974383] [0.82021613 0.82758999 1.26916049 1.27078686 1.72633386 1.72831108
 2.02969138 2.03205716 2.33394232 2.3342327  2.812145   2.81730928
 2.98526078 2.98652827 3.03372783 3.03415448 3.43320317 3.43452251
 4.75022722 4.75273829 9.18241759 9.18322871]
nelec by numeric integration = 7.999999999848145
    CPU time for vxc     11.95 sec, wall time      0.39 sec
    CPU time for vj and vk      7.03 sec, wall time      0.23 sec
E1 = (4.202585359050597-2.2234490770663017e-18j)  Ecoul = (1.1882492938576497-1.102322674519633e-25j)  Exc = -3.2946610524014073
cycle= 1 E= -10.7126994974792  delta_E= -0.652  |g|= 0.237  |ddm|= 5.73
    CPU time for cycle= 1     19.21 sec, wall time      0.62 sec
HOMO = 0.568607118653  LUMO = 0.772718791648
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26873479  0.555823    0.56420441  0.56860712] [0.77271879 0.77841308 0.78367038 1.11743587 1.70749965 1.70793728
 2.37384469 2.3766178  2.37788889 2.44828694 2.44951542 2.45137531
 3.53768494 3.5405646  3.71734419 3.71921402 3.7203527  4.60372635
 4.60759535 4.60819147 8.68546295 9.01580506]
   1 ( 0.000  0.000  0.500)   [-0.05564236  0.04178015  0.44543882  0.45289453] [0.90494452 0.90902977 0.92782019 1.29073681 1.67310932 1.86388167
 1.86461059 2.01701845 2.01912002 2.63027875 2.86497396 2.90108656
 2.90527838 2.95086879 2.95174881 3.24788291 3.59168362 3.59387047
 4.48896568 4.49116565 9.02914101 9.07373626]
   2 ( 0.000  0.500  0.000)   [-0.05719982  0.04317357  0.44512572  0.45310267] [0.90554425 0.90890369 0.92867584 1.29091793 1.66988476 1.8637836
 1.86564521 2.01731486 2.01907136 2.62968948 2.86314634 2.90377005
 2.90537679 2.95114127 2.9521057  3.2448028  3.59268409 3.59376865
 4.49044934 4.49129989 9.02833953 9.07392232]
   3 ( 0.000  0.500  0.500)   [0.05357996 0.05916627 0.31009283 0.31830231] [0.80690083 0.8188633  1.22632541 1.22714348 1.67563444 1.67784547
 1.99533833 1.99738832 2.30663748 2.30911803 2.76343137 2.76726989
 2.95591803 2.95600653 2.99670098 3.00035588 3.40228514 3.40311237
 4.70749069 4.71201923 9.02844164 9.02895863]
nelec by numeric integration = 7.99999999984656
    CPU time for vxc      8.92 sec, wall time      0.28 sec
    CPU time for vj and vk      6.16 sec, wall time      0.20 sec
E1 = (4.164290212588256-2.292258546148946e-18j)  Ecoul = (1.241826260960002+1.9368112944986282e-26j)  Exc = -3.3128686778482486
cycle= 2 E= -10.7156253022861  delta_E= -0.00293  |g|= 0.0342  |ddm|= 0.168
    CPU time for cycle= 2     17.39 sec, wall time      0.56 sec
HOMO = 0.574051944958  LUMO = 0.777906659556
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26410066  0.56220355  0.57005618  0.57405194] [0.77790666 0.7835253  0.78874181 1.12514486 1.7110532  1.71143779
 2.37950208 2.38213327 2.38319095 2.4554616  2.45630516 2.45829589
 3.54316565 3.54592992 3.72366857 3.72589808 3.72680083 4.61023818
 4.61389366 4.61451873 8.70155397 9.03151595]
   1 ( 0.000  0.000  0.500)   [-0.05026978  0.04490691  0.45129761  0.45818773] [0.91014418 0.91429411 0.9339951  1.29838504 1.67935652 1.86948644
 1.86997392 2.02068279 2.02280041 2.63463635 2.87102673 2.90818468
 2.91242327 2.95679735 2.95749706 3.25431939 3.59720927 3.59940132
 4.49494318 4.49703274 9.04484382 9.08922207]
   2 ( 0.000  0.500  0.000)   [-0.0521284   0.04673539  0.45107155  0.4582515 ] [0.91045416 0.91414304 0.93478013 1.29869322 1.67606922 1.86959902
 1.87102603 2.02110015 2.02297019 2.63396924 2.86942123 2.91104198
 2.91245345 2.95687312 2.95770159 3.25087209 3.59825278 3.59936357
 4.49636099 4.49729231 9.04399753 9.08946369]
   3 ( 0.000  0.500  0.500)   [0.05868856 0.06332525 0.31533879 0.32274794] [0.81060079 0.82331399 1.23395647 1.23476286 1.68271265 1.68507887
 1.99952079 2.00158147 2.31085137 2.31294079 2.77039026 2.77420571
 2.96105391 2.96133971 3.00271116 3.00587873 3.40837662 3.40886865
 4.71379171 4.71812008 9.04414121 9.04457187]
nelec by numeric integration = 7.999999999846856
    CPU time for vxc     10.45 sec, wall time      0.34 sec
    CPU time for vj and vk      5.49 sec, wall time      0.18 sec
E1 = (4.169243346462465-2.273170824169685e-18j)  Ecoul = (1.2343376984919683-4.221983564742855e-27j)  Exc = -3.310388621397117
cycle= 3 E= -10.7156806744288  delta_E= -5.54e-05  |g|= 0.00297  |ddm|= 0.0246
    CPU time for cycle= 3     17.57 sec, wall time      0.57 sec
HOMO = 0.573910275735  LUMO = 0.777834681367
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2641659   0.56202477  0.56987436  0.57391028] [0.77783468 0.78342435 0.7886444  1.12507712 1.71097145 1.71135868
 2.37941238 2.38201709 2.38305583 2.45524547 2.45609948 2.45810514
 3.54305451 3.54580259 3.72348853 3.72571213 3.72664387 4.61009994
 4.6137346  4.61436562 8.70102728 9.03100043]
   1 ( 0.000  0.000  0.500)   [-0.05035116  0.04484666  0.45114892  0.45801506] [0.91001564 0.91418671 0.93391933 1.29826497 1.67918033 1.86933626
 1.86981409 2.0206274  2.02272324 2.634532   2.87090466 2.90800772
 2.91220699 2.95664371 2.95735489 3.25417012 3.59706196 3.59925664
 4.49479526 4.49687718 9.04432263 9.08871657]
   2 ( 0.000  0.500  0.000)   [-0.05216215  0.04660073  0.45091141  0.45811984] [0.91036595 0.91406793 0.93471577 1.29851233 1.6758651  1.86942893
 1.87086963 2.02102931 2.02285724 2.63385922 2.86927077 2.91087365
 2.91225085 2.95674048 2.95760295 3.25074535 3.59811572 3.59922368
 4.49620207 4.49713997 9.04347941 9.08894977]
   3 ( 0.000  0.500  0.500)   [0.05858518 0.06325371 0.31520937 0.32262501] [0.81054887 0.82323559 1.23383955 1.23457714 1.68247629 1.684879
 1.9994142  2.0014583  2.31072784 2.31287924 2.77022993 2.77399744
 2.96090823 2.96121566 3.00256901 3.00575665 3.40824784 3.40876815
 4.71366794 4.71794524 9.04331539 9.04436673]
nelec by numeric integration = 7.999999999846853
    CPU time for vxc      8.58 sec, wall time      0.28 sec
    CPU time for vj and vk      6.32 sec, wall time      0.21 sec
E1 = (4.169119213427415-2.276664768964254e-18j)  Ecoul = (1.234522727847064+1.072850831100576e-27j)  Exc = -3.3104487229773913
cycle= 4 E= -10.715679879689  delta_E= 7.95e-07  |g|= 0.00461  |ddm|= 0.00782
    CPU time for cycle= 4     17.96 sec, wall time      0.58 sec
HOMO = 0.573902928657  LUMO = 0.777829735561
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2641701   0.56201429  0.56986413  0.57390293] [0.77782974 0.78341862 0.78863831 1.12507235 1.71096671 1.71135389
 2.37940585 2.38201054 2.38304879 2.45523301 2.45608881 2.45809334
 3.54304789 3.54579502 3.72347951 3.72570113 3.72663375 4.61009165
 4.61372538 4.61435658 8.70099861 9.03097071]
   1 ( 0.000  0.000  0.500)   [-0.05035479  0.04484034  0.45113955  0.45800735] [0.91001055 0.9141807  0.93391444 1.29825617 1.67916928 1.86932677
 1.86980504 2.02062309 2.02271719 2.63452546 2.87089591 2.90799741
 2.91219677 2.95663411 2.95734802 3.25416251 3.59705404 3.5992482
 4.49478639 4.49686821 9.04429981 9.08868163]
   2 ( 0.000  0.500  0.000)   [-0.052167    0.04659682  0.4509026   0.45811086] [0.91035904 0.91406205 0.93471018 1.29850429 1.6758545  1.86942019
 1.87086089 2.02102581 2.02285267 2.63385269 2.86926377 2.91086361
 2.91223956 2.95673064 2.95759446 3.25073592 3.59810769 3.59921551
 4.49619324 4.4971316  9.0434562  9.0889155 ]
   3 ( 0.000  0.500  0.500)   [0.0585782  0.06324991 0.31520179 0.32261846] [0.81054639 0.8232298  1.2338325  1.23456673 1.68248688 1.68484297
 1.99940791 2.0014512  2.31074809 2.31284782 2.77022052 2.77398571
 2.96090536 2.96120288 3.00256046 3.00574965 3.40824455 3.40875773
 4.71366024 4.71793561 9.0437295  9.04389485]
nelec by numeric integration = 7.999999999846857
    CPU time for vxc      8.90 sec, wall time      0.28 sec
    CPU time for vj and vk      5.93 sec, wall time      0.19 sec
E1 = (4.169111991270454-2.2745747760407128e-18j)  Ecoul = (1.2345321730423597-8.620671972255217e-27j)  Exc = -3.3104522760427693
cycle= 5 E= -10.715681209716  delta_E= -1.33e-06  |g|= 4.93e-05  |ddm|= 0.00489
    CPU time for cycle= 5     15.28 sec, wall time      0.49 sec
HOMO = 0.573903444022  LUMO = 0.777828823993
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26417065  0.56201311  0.56986337  0.57390344] [0.77782882 0.78341882 0.78863764 1.12507172 1.71096638 1.71135339
 2.37940403 2.38201051 2.38304909 2.45523218 2.45608941 2.45809147
 3.54304744 3.54579436 3.72348069 3.72570033 3.72663175 4.61009085
 4.61372494 4.61435581 8.70099717 9.03096932]
   1 ( 0.000  0.000  0.500)   [-0.05035335  0.04483632  0.45113795  0.45800937] [0.91001317 0.91418078 0.933914   1.29825346 1.67916751 1.86932519
 1.86980452 2.02062149 2.02271497 2.63452445 2.8708934  2.90799667
 2.91219711 2.95663452 2.95734939 3.25416333 3.59705429 3.59924757
 4.49478538 4.49686771 9.04429859 9.08867978]
   2 ( 0.000  0.500  0.000)   [-0.05217054  0.04660121  0.45090243  0.45810854] [0.91035666 0.91405985 0.9347079  1.29850667 1.67585523 1.86942088
 1.87086066 2.02102646 2.02285482 2.63385201 2.86926555 2.91086236
 2.91223834 2.95672835 2.95759091 3.25073286 3.59810708 3.599215
 4.49619329 4.49713151 9.04345466 9.08891466]
   3 ( 0.000  0.500  0.500)   [0.05857651 0.0632503  0.31520111 0.32261865] [0.81054679 0.82322822 1.23383217 1.23456651 1.6824855  1.68484187
 1.99940733 2.00145072 2.3107469  2.31284793 2.77021986 2.7739852
 2.96090521 2.9612017  3.00255981 3.00574948 3.40824395 3.40875736
 4.71365911 4.71793573 9.04372638 9.04389515]
nelec by numeric integration = 7.999999999846857
    CPU time for vxc      8.31 sec, wall time      0.27 sec
    CPU time for vj and vk      6.53 sec, wall time      0.22 sec
E1 = (4.169111831859449-2.2745851180955326e-18j)  Ecoul = (1.2345324443025114-2.3602718284212673e-26j)  Exc = -3.31045238804201
cycle= 6 E= -10.7156812098661  delta_E= -1.5e-10  |g|= 6.09e-06  |ddm|= 4.71e-05
    CPU time for cycle= 6     18.13 sec, wall time      0.59 sec
HOMO = 0.573903422463  LUMO = 0.777828784159
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26417073  0.56201314  0.56986319  0.57390342] [0.77782878 0.7834188  0.78863751 1.12507162 1.71096634 1.71135332
 2.37940395 2.38201037 2.38304909 2.45523214 2.45608919 2.45809147
 3.54304738 3.54579427 3.72348039 3.72570035 3.72663183 4.61009072
 4.6137249  4.61435573 8.70099706 9.03096921]
   1 ( 0.000  0.000  0.500)   [-0.05035368  0.04483667  0.45113804  0.45800902] [0.91001287 0.91418057 0.93391383 1.29825366 1.67916756 1.86932524
 1.86980447 2.02062144 2.02271519 2.63452434 2.87089351 2.90799651
 2.91219699 2.95663438 2.95734895 3.25416301 3.59705422 3.59924754
 4.49478536 4.49686771 9.04429847 9.08867971]
   2 ( 0.000  0.500  0.000)   [-0.05217031  0.0466006   0.45090236  0.45810871] [0.91035692 0.91405992 0.93470795 1.29850623 1.67585495 1.86942064
 1.87086062 2.02102616 2.02285456 2.63385188 2.86926518 2.91086231
 2.9122384  2.9567285  2.95759105 3.25073297 3.59810711 3.59921495
 4.49619323 4.49713139 9.04345457 9.08891448]
   3 ( 0.000  0.500  0.500)   [0.05857651 0.06325013 0.31520111 0.32261859] [0.81054661 0.82322822 1.23383212 1.23456651 1.68248526 1.68484175
 1.99940719 2.00145071 2.31074685 2.31284783 2.77021976 2.77398516
 2.96090517 2.96120157 3.00255984 3.00574934 3.40824396 3.40875721
 4.713659   4.71793574 9.0437263  9.043895  ]
nelec by numeric integration = 7.999999999846856
    CPU time for vxc     12.55 sec, wall time      0.41 sec
    CPU time for vj and vk      6.09 sec, wall time      0.20 sec
E1 = (4.169111793669143-2.2745856514791005e-18j)  Ecoul = (1.2345324946310359+5.2380364106675184e-27j)  Exc = -3.3104524001824034
Extra cycle  E= -10.7156812098683  delta_E= -2.17e-12  |g|= 2.39e-06  |ddm|= 8.57e-06
    CPU time for scf_cycle    147.31 sec, wall time      4.79 sec
    CPU time for SCF    150.71 sec, wall time      4.90 sec
converged SCF energy = -10.7156812098683
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-5.0/47995798/scf.h5
