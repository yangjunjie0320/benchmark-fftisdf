SLURMD_NODENAME = hpc-52-33
Start time = Thu Mar 13 04:24:36 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-60.0/47995828/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-60.0/47995828/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  6.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.25042123]
 [ 0.          0.          0.50084245]
 ...
 [-0.28916156 -0.20446807 -1.00168491]
 [-0.28916156 -0.20446807 -0.75126368]
 [-0.28916156 -0.20446807 -0.50084245]], m0 = [19 19 19]
Pivoted Cholesky rank = 371, estimated error = 0.00e+00
Parent grid size = 6859, selected grid size = 390
    CPU time for interpolating functions     10.47 sec, wall time      1.31 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.42 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]      9.75 sec, wall time      0.80 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     24.65 sec, wall time      1.51 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     28.51 sec, wall time      1.80 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     25.48 sec, wall time      1.68 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     27.46 sec, wall time      1.84 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 332 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-60.0/47995828/tmp6h0i4hc4
    CPU time for building ISDF    120.70 sec, wall time      7.95 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-60.0/47995828/tmpcbmmxgzh
max_memory 81920 MB (current use 259 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f77913b6be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.82 sec, wall time      0.54 sec
    CPU time for vj and vk      7.08 sec, wall time      0.44 sec
E1 = (4.673183787659304+1.811972120264893e-17j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.3914815357847834
init E= -10.0507067739758
    CPU time for initialize scf     26.92 sec, wall time      1.73 sec
HOMO = 0.617033014222  LUMO = 0.803939360211
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655311  0.61114694  0.61138389  0.61703301] [0.80393936 0.80814032 0.81092521 1.13007308 1.73333603 1.73556102
 2.40667469 2.40722363 2.40801624 2.50110588 2.50172362 2.50205541
 3.56784268 3.56831857 3.76714553 3.76716134 3.76793853 4.64476305
 4.64490933 4.6450243  8.84194614 9.17011978]
   1 ( 0.000  0.000  0.500)   [-0.03769274  0.06166935  0.49459002  0.5013079 ] [0.93252606 0.93680536 0.94438476 1.33409674 1.72139853 1.90372553
 1.90506805 2.04477568 2.04669364 2.65773436 2.9026305  2.95423634
 2.95472587 2.9894896  2.99038621 3.28772296 3.6266419  3.62702775
 4.52706828 4.52716375 9.18283376 9.22709997]
   2 ( 0.000  0.500  0.000)   [-0.03769327  0.06167429  0.49459139  0.50130865] [0.93252216 0.93680454 0.94438377 1.33409805 1.72140078 1.90372571
 1.90506912 2.044774   2.04669121 2.65773429 2.90263071 2.9542358
 2.9547241  2.98949159 2.99038375 3.2877154  3.62664418 3.62702994
 4.52707084 4.52716859 9.18283335 9.22709985]
   3 ( 0.000  0.500  0.500)   [0.07640181 0.07937631 0.34925794 0.36058582] [0.82050655 0.82899515 1.27129842 1.27175851 1.72863503 1.72939714
 2.03063292 2.03250343 2.33429945 2.33445889 2.81522002 2.81661606
 2.98769889 2.98878534 3.03483418 3.03571265 3.43441115 3.435058
 4.75294797 4.753239   9.18254994 9.18256271]
nelec by numeric integration = 7.9999999998482005
    CPU time for vxc     12.14 sec, wall time      0.72 sec
    CPU time for vj and vk     10.31 sec, wall time      0.62 sec
E1 = (4.205084549931659+8.610911548165352e-18j)  Ecoul = (1.1845361198914584+1.0145003676631883e-24j)  Exc = -3.2881824967289996
cycle= 1 E= -10.707434924892  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     22.59 sec, wall time      1.35 sec
HOMO = 0.56967977067  LUMO = 0.774554244169
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823092  0.55649123  0.56494565  0.56967977] [0.77455424 0.7791234  0.78469157 1.11984424 1.70811172 1.70832887
 2.37427958 2.37655344 2.37739652 2.44836474 2.45168435 2.4523021
 3.53689872 3.54001622 3.71838545 3.71995834 3.72041864 4.60534088
 4.60715341 4.60870686 8.68226271 9.01323539]
   1 ( 0.000  0.000  0.500)   [-0.05413229  0.04171715  0.44623457  0.45410758] [0.90552543 0.90924442 0.92942047 1.2916429  1.6722181  1.8634521
 1.86548579 2.01770597 2.01914103 2.63026674 2.86488    2.90392574
 2.90479799 2.95101828 2.9520209  3.24884339 3.59221665 3.5932271
 4.49053544 4.49146109 9.02632674 9.0713221 ]
   2 ( 0.000  0.500  0.000)   [-0.05413403  0.04172201  0.44623364  0.45411216] [0.90552639 0.90923594 0.92942189 1.29164942 1.67221951 1.86345353
 1.86548674 2.01770064 2.01913794 2.6302717  2.86487924 2.90392656
 2.90479823 2.95101195 2.95202277 3.24883211 3.59221877 3.59322901
 4.4905407  4.49146448 9.02632678 9.07132153]
   3 ( 0.000  0.500  0.500)   [0.05607456 0.05914707 0.31090416 0.31917505] [0.806096   0.81832515 1.22741947 1.22770674 1.67536477 1.67852538
 1.99604721 1.99673031 2.30682132 2.30902325 2.76485021 2.76597766
 2.95644799 2.95654011 2.99691894 3.00058717 3.40206496 3.40322947
 4.71034589 4.71231977 9.02590722 9.02633785]
nelec by numeric integration = 7.999999999846832
    CPU time for vxc     12.98 sec, wall time      0.73 sec
    CPU time for vj and vk      9.81 sec, wall time      0.55 sec
E1 = (4.165530195425333+8.61501799021418e-18j)  Ecoul = (1.239721110611926-1.0894484645464261e-25j)  Exc = -3.3068200579083014
cycle= 2 E= -10.7104418498571  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     26.04 sec, wall time      1.47 sec
HOMO = 0.575293927745  LUMO = 0.779937843172
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26342981  0.56308543  0.57102003  0.57529393] [0.77993784 0.78431266 0.78989976 1.12771918 1.71172977 1.71189837
 2.38021159 2.38219859 2.38284143 2.45569111 2.45874912 2.45938806
 3.5425504  3.5455611  3.72517641 3.72656573 3.72689408 4.61193641
 4.61360957 4.61519826 8.69868259 9.0292873 ]
   1 ( 0.000  0.000  0.500)   [-0.04875102  0.04515786  0.45231639  0.45951518] [0.9106771  0.91470208 0.93574725 1.29962265 1.67872647 1.86936566
 1.87099563 2.02147544 2.02300479 2.63471504 2.87121749 2.91135647
 2.91206566 2.95699884 2.95785949 3.25530975 3.59791477 3.59890921
 4.49657601 4.49757959 9.04235086 9.08717079]
   2 ( 0.000  0.500  0.000)   [-0.04875264  0.04516245  0.45231538  0.45951982] [0.91067823 0.91469351 0.9357488  1.29962915 1.67872788 1.86936699
 1.87099652 2.02147009 2.02300173 2.63471984 2.87121656 2.9113572
 2.9120658  2.95699283 2.95786138 3.25529865 3.59791682 3.59891097
 4.49658124 4.49758301 9.04235091 9.08717018]
   3 ( 0.000  0.500  0.500)   [0.06141052 0.06333695 0.31629364 0.32377582] [0.80988067 0.82299547 1.23521703 1.23562031 1.68271415 1.68607869
 2.00033712 2.00101403 2.31115488 2.31294496 2.77210396 2.77308596
 2.96179311 2.96199356 3.00305396 3.00623442 3.40834526 3.40914382
 4.71685825 4.7185223  9.04188089 9.04234792]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc     13.48 sec, wall time      0.87 sec
    CPU time for vj and vk      8.02 sec, wall time      0.51 sec
E1 = (4.1706440598471355+8.562979213784679e-18j)  Ecoul = (1.2320386858946688-5.130120238833284e-26j)  Exc = -3.304310233985202
cycle= 3 E= -10.7105005862295  delta_E= -5.87e-05  |g|= 0.000976  |ddm|= 0.0247
    CPU time for cycle= 3     24.81 sec, wall time      1.58 sec
HOMO = 0.575152841023  LUMO = 0.779863390018
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350275  0.56289135  0.57083961  0.57515284] [0.77986339 0.78420902 0.78980384 1.12763739 1.7116482  1.71181937
 2.38011516 2.38208491 2.38270484 2.45545998 2.45855833 2.45917742
 3.54243776 3.54543301 3.72497138 3.72637905 3.72674229 4.6118042
 4.61344284 4.61504046 8.69813759 9.0287525 ]
   1 ( 0.000  0.000  0.500)   [-0.04881986  0.04506263  0.45215021  0.45936489] [0.91056559 0.9146085  0.9356631  1.29947335 1.67853123 1.86920023
 1.87083536 2.02141573 2.02290689 2.63460374 2.87107713 2.91117946
 2.91185069 2.95684118 2.9577407  3.25516372 3.5977676  3.59876205
 4.49641496 4.49742824 9.04181694 9.08663867]
   2 ( 0.000  0.500  0.000)   [-0.04882153  0.04506728  0.4521492   0.45936947] [0.9105667  0.91459988 0.93566464 1.29947988 1.67853265 1.86920158
 1.87083624 2.02141037 2.02290387 2.63460853 2.87107622 2.91118017
 2.91185084 2.95683515 2.95774257 3.25515257 3.59776964 3.59876379
 4.49642019 4.49743165 9.04181698 9.08663807]
   3 ( 0.000  0.500  0.500)   [0.06129149 0.06327289 0.31615502 0.3236548 ] [0.80983488 0.82290363 1.23502212 1.23550141 1.68249768 1.68585031
 2.00023276 2.00088137 2.31106118 2.3128529  2.7719376  2.77286942
 2.96164151 2.96186312 3.00289951 3.0061135  3.4082166  3.40903904
 4.71673233 4.71834377 9.04134645 9.04181393]
nelec by numeric integration = 7.999999999847125
    CPU time for vxc     16.72 sec, wall time      1.17 sec
    CPU time for vj and vk      7.18 sec, wall time      0.46 sec
E1 = (4.170516661391627+8.563439364491739e-18j)  Ecoul = (1.232228092131446+8.404839628586748e-26j)  Exc = -3.304372285520485
cycle= 4 E= -10.7105006299835  delta_E= -4.38e-08  |g|= 0.000118  |ddm|= 0.000655
    CPU time for cycle= 4     28.02 sec, wall time      1.89 sec
HOMO = 0.575152712833  LUMO = 0.779862713446
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350342  0.56289103  0.57083851  0.57515271] [0.77986271 0.78420907 0.78980297 1.12763663 1.71164782 1.71181887
 2.38011377 2.38208436 2.3827051  2.45545938 2.45855753 2.45917641
 3.54243726 3.54543232 3.72497115 3.72637822 3.72674152 4.61180308
 4.61344258 4.61503968 8.69813646 9.02875139]
   1 ( 0.000  0.000  0.500)   [-0.04882058  0.04506201  0.45214996  0.45936436] [0.91056561 0.91460771 0.93566218 1.29947266 1.67853026 1.8691995
 1.87083505 2.02141451 2.02290686 2.63460261 2.8710763  2.91117853
 2.91185036 2.95684083 2.95773939 3.25516264 3.59776744 3.59876162
 4.49641475 4.49742761 9.04181589 9.08663751]
   2 ( 0.000  0.500  0.000)   [-0.04882225  0.04506666  0.45214895  0.45936895] [0.91056673 0.91459909 0.93566373 1.29947919 1.67853167 1.86920085
 1.87083593 2.02140916 2.02290383 2.63460741 2.87107539 2.91117924
 2.91185051 2.95683481 2.95774126 3.2551515  3.59776948 3.59876336
 4.49641998 4.49743102 9.04181593 9.0866369 ]
   3 ( 0.000  0.500  0.500)   [0.06129082 0.06327218 0.3161548  0.32365445] [0.80983403 0.82290294 1.23502206 1.23550082 1.68249598 1.68584933
 2.00023168 2.00088114 2.31106047 2.31285251 2.77193664 2.77286899
 2.96164127 2.9618618  3.00289941 3.00611261 3.40821649 3.40903809
 4.7167311  4.71834393 9.04134521 9.04181291]
nelec by numeric integration = 7.999999999847125
    CPU time for vxc     12.27 sec, wall time      0.75 sec
    CPU time for vj and vk      8.52 sec, wall time      0.52 sec
E1 = (4.170516421309639+8.563390734448106e-18j)  Ecoul = (1.232228443536049-4.673843091253451e-26j)  Exc = -3.3043723966078145
cycle= 5 E= -10.7105006297482  delta_E= 2.35e-10  |g|= 0.000133  |ddm|= 0.000263
    CPU time for cycle= 5     24.01 sec, wall time      1.46 sec
HOMO = 0.575152677186  LUMO = 0.779862499
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350364  0.56289092  0.57083816  0.57515268] [0.7798625  0.78420908 0.78980268 1.12763638 1.7116477  1.7118187
 2.38011333 2.38208418 2.38270517 2.45545919 2.45855728 2.45917608
 3.5424371  3.5454321  3.72497108 3.72637796 3.72674128 4.61180272
 4.6134425  4.61503942 8.69813611 9.02875105]
   1 ( 0.000  0.000  0.500)   [-0.04882082  0.04506181  0.45214988  0.45936419] [0.91056561 0.91460746 0.93566189 1.29947244 1.67852995 1.86919927
 1.87083495 2.02141412 2.02290685 2.63460225 2.87107603 2.91117823
 2.91185024 2.95684072 2.95773897 3.2551623  3.59776738 3.59876148
 4.49641468 4.4974274  9.04181557 9.08663715]
   2 ( 0.000  0.500  0.000)   [-0.04882248  0.04506645  0.45214887  0.45936878] [0.91056673 0.91459884 0.93566343 1.29947897 1.67853136 1.86920062
 1.87083583 2.02140876 2.02290382 2.63460704 2.87107512 2.91117894
 2.91185039 2.9568347  2.95774084 3.25515115 3.59776943 3.59876322
 4.49641991 4.49743081 9.04181561 9.08663654]
   3 ( 0.000  0.500  0.500)   [0.06129061 0.06327194 0.31615473 0.32365434] [0.80983374 0.82290272 1.23502203 1.23550064 1.68249543 1.68584901
 2.00023133 2.00088107 2.31106027 2.31285235 2.77193634 2.77286885
 2.96164115 2.96186142 3.00289938 3.00611232 3.40821646 3.40903778
 4.71673072 4.71834398 9.04134513 9.0418123 ]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc     12.45 sec, wall time      0.76 sec
    CPU time for vj and vk      7.69 sec, wall time      0.47 sec
E1 = (4.170516344874939+8.56341080801727e-18j)  Ecoul = (1.2322285536363813-6.259769055109773e-26j)  Exc = -3.304372431372622
cycle= 6 E= -10.7105006308474  delta_E= -1.1e-09  |g|= 2.41e-07  |ddm|= 0.00014
    CPU time for cycle= 6     23.02 sec, wall time      1.41 sec
HOMO = 0.575152672354  LUMO = 0.779862497386
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350365  0.56289089  0.57083814  0.57515267] [0.7798625  0.78420906 0.78980267 1.12763636 1.71164769 1.71181869
 2.38011332 2.38208416 2.38270515 2.45545915 2.45855728 2.45917606
 3.54243708 3.54543208 3.72497105 3.72637794 3.72674127 4.61180271
 4.61344247 4.61503941 8.69813608 9.02875102]
   1 ( 0.000  0.000  0.500)   [-0.04882083  0.04506179  0.45214985  0.45936418] [0.91056559 0.91460744 0.93566188 1.29947243 1.67852994 1.86919925
 1.87083493 2.02141411 2.02290683 2.63460224 2.87107601 2.91117822
 2.91185021 2.95684071 2.95773897 3.25516229 3.59776736 3.59876146
 4.49641465 4.49742738 9.04181554 9.08663711]
   2 ( 0.000  0.500  0.000)   [-0.04882249  0.04506644  0.45214884  0.45936876] [0.9105667  0.91459882 0.93566343 1.29947896 1.67853136 1.86920059
 1.87083582 2.02140875 2.0229038  2.63460703 2.8710751  2.91117892
 2.91185036 2.95683468 2.95774084 3.25515115 3.5977694  3.5987632
 4.49641988 4.4974308  9.04181558 9.08663651]
   3 ( 0.000  0.500  0.500)   [0.0612906  0.06327192 0.31615471 0.32365434] [0.80983372 0.82290271 1.23502199 1.23550065 1.6824954  1.68584899
 2.00023132 2.00088105 2.31106026 2.31285233 2.77193634 2.77286882
 2.96164112 2.96186141 3.00289936 3.00611231 3.40821644 3.40903776
 4.71673071 4.71834395 9.04134509 9.04181227]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc     12.48 sec, wall time      0.74 sec
    CPU time for vj and vk      7.40 sec, wall time      0.40 sec
E1 = (4.17051633328186+8.563411375959257e-18j)  Ecoul = (1.2322285709182024-3.464046007006507e-26j)  Exc = -3.3043724370613643
Extra cycle  E= -10.7105006308474  delta_E=    0  |g|= 2.54e-07  |ddm|= 4.81e-07
    CPU time for scf_cycle    195.60 sec, wall time     12.06 sec
    CPU time for SCF    197.95 sec, wall time     12.23 sec
converged SCF energy = -10.7105006308474
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-60.0/47995828/scf.h5
