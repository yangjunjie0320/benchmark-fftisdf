SLURMD_NODENAME = hpc-20-22
Start time = Thu Mar 13 04:24:29 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-100.0/47995820/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-100.0/47995820/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.00e+01
k0 =  1.00e+02

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.20686971]
 [ 0.          0.          0.41373942]
 ...
 [-0.2388726  -0.16890841 -0.82747884]
 [-0.2388726  -0.16890841 -0.62060913]
 [-0.2388726  -0.16890841 -0.41373942]], m0 = [23 23 23]
Pivoted Cholesky rank = 375, estimated error = 3.00e-03
Parent grid size = 12167, selected grid size = 260
    CPU time for interpolating functions     22.44 sec, wall time      4.75 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 260, nao = 26, cisdf =  10.00
    CPU time for get interpolating vectors      0.40 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 2.02e-01 GB
    CPU time for aoR_loop: [      0,   12167]      5.07 sec, wall time      1.06 sec
eta_kpt.shape = (4, 12167, 260)
Memory used for eta_kpt = 2.02e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     21.93 sec, wall time      2.37 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     56.10 sec, wall time      4.35 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     72.21 sec, wall time      6.39 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     56.22 sec, wall time      4.19 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 259 / 260
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-100.0/47995820/tmpr0qdf4t8
    CPU time for building ISDF    215.08 sec, wall time     19.03 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-100.0/47995820/tmpi2t2qa3r
max_memory 81920 MB (current use 313 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f79a5561be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc     13.22 sec, wall time      1.41 sec
    CPU time for vj and vk     12.18 sec, wall time      1.20 sec
E1 = (4.673183787659304-5.807990769463329e-18j)  Ecoul = (1.4764640721357718+2.331033469502186e-33j)  Exc = -3.3915984516981488
init E= -10.0508236898892
    CPU time for initialize scf     41.08 sec, wall time      4.12 sec
HOMO = 0.617066980538  LUMO = 0.803846266253
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24657966  0.61118467  0.61141284  0.61706698] [0.80384627 0.80800478 0.81082995 1.13000189 1.73328269 1.73553501
 2.40668046 2.40717245 2.40798837 2.50103924 2.50162861 2.50202387
 3.56782495 3.56830875 3.76716984 3.76717589 3.76796579 4.64472071
 4.64489274 4.64496282 8.84194265 9.17011046]
   1 ( 0.000  0.000  0.500)   [-0.03775509  0.06172999  0.49458002  0.50129779] [0.93231903 0.93673995 0.94439131 1.33409955 1.72142084 1.90369937
 1.9050344  2.04476815 2.04668457 2.65771113 2.90257827 2.95421568
 2.954695   2.98943766 2.9903708  3.28772084 3.62658868 3.62703805
 4.52700201 4.52717104 9.18282368 9.22709997]
   2 ( 0.000  0.500  0.000)   [-0.03772262  0.06165989  0.49459512  0.5013009 ] [0.9324636  0.93671469 0.94442347 1.33406723 1.72143092 1.90366987
 1.90504097 2.04477988 2.04669492 2.65779392 2.90261951 2.95420985
 2.95470442 2.98947847 2.99039299 3.28772768 3.6265968  3.62701864
 4.52702878 4.52713022 9.18282709 9.22709282]
   3 ( 0.000  0.500  0.500)   [0.07638636 0.07935572 0.34925865 0.36055062] [0.82043337 0.82911318 1.2712936  1.27174368 1.7286272  1.72939277
 2.03062702 2.03251259 2.33429538 2.33444114 2.81521502 2.81661683
 2.98769837 2.9887647  3.03485164 3.03572224 3.43438279 3.43501226
 4.75295321 4.75322257 9.18254478 9.18255582]
nelec by numeric integration = 7.999999999848186
    CPU time for vxc     18.82 sec, wall time      2.00 sec
    CPU time for vj and vk     10.90 sec, wall time      0.98 sec
E1 = (4.205067196244518-4.8468948996370104e-18j)  Ecoul = (1.1845736627227252+4.090717110114079e-26j)  Exc = -3.2881404421856733
cycle= 1 E= -10.7073726812045  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     30.01 sec, wall time      3.01 sec
HOMO = 0.569708706177  LUMO = 0.77448068025
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26821452  0.55655797  0.56500393  0.56970871] [0.77448068 0.77900867 0.78457971 1.11983017 1.70809192 1.7083243
 2.3742801  2.37650859 2.37735855 2.44828509 2.45161877 2.45221398
 3.53691976 3.54003085 3.71844094 3.71999726 3.72045562 4.6053229
 4.6071574  4.60868203 8.6822692  9.01324008]
   1 ( 0.000  0.000  0.500)   [-0.05418091  0.04177927  0.44625183  0.4541605 ] [0.90544388 0.90913337 0.92943933 1.29167092 1.67224957 1.8634028
 1.86549295 2.01768081 2.01912741 2.63028655 2.86486605 2.90392227
 2.90475731 2.95100921 2.9520352  3.24882695 3.59221023 3.59325597
 4.49053596 4.49143654 9.02633394 9.07133512]
   2 ( 0.000  0.500  0.000)   [-0.05413198  0.04173831  0.44625186  0.45414796] [0.90540671 0.90919374 0.92945178 1.29167179 1.67227096 1.8634114
 1.86542846 2.01772076 2.01914261 2.63034865 2.86493281 2.90391201
 2.90478563 2.95105404 2.95203638 3.24885639 3.59222156 3.59322455
 4.49051657 4.4914616  9.02633387 9.07133259]
   3 ( 0.000  0.500  0.500)   [0.0560853  0.05913966 0.31087097 0.31918424] [0.80606825 0.81841628 1.22742456 1.2277148  1.67539009 1.67855802
 1.99602157 1.99676512 2.30682382 2.30904137 2.76486382 2.76596134
 2.95647118 2.95656964 2.9969616  3.00061936 3.40206503 3.40325316
 4.7103569  4.71232762 9.0259124  9.02635019]
nelec by numeric integration = 7.999999999846822
    CPU time for vxc     17.23 sec, wall time      1.78 sec
    CPU time for vj and vk      9.76 sec, wall time      1.19 sec
E1 = (4.165533183826636-4.993927781737522e-18j)  Ecoul = (1.2397182308425718-1.2211566812821263e-26j)  Exc = -3.306757207260771
cycle= 2 E= -10.7103788905776  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     31.96 sec, wall time      3.43 sec
HOMO = 0.575319317677  LUMO = 0.77986474471
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26341752  0.56314995  0.57107566  0.57531932] [0.77986474 0.78419551 0.78978688 1.12770321 1.71170499 1.71189104
 2.38020986 2.38215097 2.38280016 2.45561272 2.45868115 2.45929843
 3.54256813 3.54557258 3.72522419 3.72659724 3.72692699 4.61191613
 4.61361234 4.61517012 8.69867991 9.02928302]
   1 ( 0.000  0.000  0.500)   [-0.0488025   0.04521873  0.45233088  0.4595622 ] [0.91058962 0.91458835 0.93576552 1.29964713 1.6787535  1.86931662
 1.87099691 2.02144998 2.02299059 2.63473164 2.87120009 2.91135064
 2.91202061 2.95698431 2.95786909 3.25529077 3.59790443 3.59893427
 4.49657519 4.49755247 9.04234897 9.08717455]
   2 ( 0.000  0.500  0.000)   [-0.04874942  0.04517218  0.45233096  0.45955275] [0.91055774 0.91465122 0.93577817 1.29964498 1.67877199 1.86932335
 1.87093479 2.02148786 2.02300151 2.63479162 2.87126289 2.91133974
 2.91205008 2.95703353 2.95787302 3.25531996 3.59791502 3.59890465
 4.49655628 4.4975759  9.04234912 9.08717145]
   3 ( 0.000  0.500  0.500)   [0.06142052 0.06332788 0.31625949 0.32378191] [0.80984635 0.82308364 1.23521493 1.23562478 1.68273392 1.68610408
 2.00030922 2.00104648 2.31115516 2.31295875 2.77211318 2.77306621
 2.96181564 2.96201567 3.00308906 3.00626269 3.40834087 3.40916367
 4.71686746 4.71852159 9.04187755 9.04235036]
nelec by numeric integration = 7.999999999847116
    CPU time for vxc     15.88 sec, wall time      2.09 sec
    CPU time for vj and vk     10.75 sec, wall time      1.21 sec
E1 = (4.170644088387271-4.950698872643696e-18j)  Ecoul = (1.2320402202895668+6.878867093527223e-27j)  Exc = -3.304248766258336
cycle= 3 E= -10.7104375555676  delta_E= -5.87e-05  |g|= 0.00103  |ddm|= 0.0247
    CPU time for cycle= 3     31.62 sec, wall time      3.97 sec
HOMO = 0.575178161487  LUMO = 0.779789802234
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634906   0.56295518  0.57089484  0.57517816] [0.7797898  0.78409153 0.78969059 1.12762122 1.71162347 1.71181171
 2.38011288 2.38203677 2.38266312 2.45538098 2.45848972 2.45908716
 3.54245516 3.54544405 3.72501846 3.72640996 3.72677488 4.61178357
 4.61344506 4.61501179 8.6981339  9.02874727]
   1 ( 0.000  0.000  0.500)   [-0.04887151  0.04512311  0.45216402  0.45941187] [0.91047795 0.91449473 0.93568093 1.29949716 1.67855781 1.86915057
 1.87083651 2.02138982 2.02289217 2.63462013 2.87105911 2.91117324
 2.91180496 2.95682624 2.95775014 3.25514412 3.59775685 3.59878661
 4.4964136  4.49740062 9.04181401 9.08664152]
   2 ( 0.000  0.500  0.000)   [-0.04881895  0.04507727  0.45216423  0.45940201] [0.91044564 0.91455688 0.93569331 1.29949557 1.67857652 1.86915758
 1.870774   2.02142802 2.02290342 2.63468015 2.87112238 2.91116205
 2.91183455 2.95687514 2.95775359 3.25517328 3.59776734 3.59875701
 4.49639475 4.49742404 9.04181413 9.08663852]
   3 ( 0.000  0.500  0.500)   [0.06130075 0.0632638  0.31612034 0.32366059] [0.80980063 0.8229911  1.23501956 1.23550506 1.68251682 1.68587525
 2.00020453 2.0009134  2.31106087 2.31286665 2.77194628 2.77284912
 2.96166292 2.96188562 3.0029339  3.00614151 3.40821165 3.40905865
 4.71674106 4.71834258 9.04133507 9.04182247]
nelec by numeric integration = 7.999999999847113
    CPU time for vxc     15.98 sec, wall time      1.62 sec
    CPU time for vj and vk      9.15 sec, wall time      1.03 sec
E1 = (4.170516434281558-4.951001604251231e-18j)  Ecoul = (1.2322299901403178+5.224152458735629e-26j)  Exc = -3.3043109124646413
cycle= 4 E= -10.7104375860288  delta_E= -3.05e-08  |g|= 0.000572  |ddm|= 0.00113
    CPU time for cycle= 4     30.28 sec, wall time      3.18 sec
HOMO = 0.575177961151  LUMO = 0.779789385272
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26349101  0.56295487  0.57089412  0.57517796] [0.77978939 0.78409147 0.78969005 1.12762074 1.7116232  1.71181138
 2.38011207 2.38203638 2.38266314 2.45538048 2.45848914 2.45908646
 3.5424548  3.54544358 3.72501818 3.72640937 3.72677434 4.61178287
 4.61344479 4.61501126 8.69813288 9.02874625]
   1 ( 0.000  0.000  0.500)   [-0.04887197  0.04512272  0.45216377  0.45941144] [0.91047785 0.91449424 0.93568038 1.29949668 1.67855714 1.86915007
 1.87083621 2.02138912 2.02289209 2.63461945 2.87105857 2.91117261
 2.91180461 2.95682592 2.95774932 3.25514343 3.59775664 3.59878626
 4.49641336 4.49740017 9.04181312 9.08664039]
   2 ( 0.000  0.500  0.000)   [-0.04881936  0.04507683  0.45216397  0.45940162] [0.91044558 0.9145564  0.93569278 1.29949505 1.67857584 1.86915706
 1.87077371 2.02142731 2.02290331 2.63467947 2.87112181 2.91116142
 2.91183421 2.95687484 2.95775282 3.25517262 3.59776713 3.59875667
 4.49639451 4.49742358 9.04181324 9.08663739]
   3 ( 0.000  0.500  0.500)   [0.06130033 0.06326335 0.31612012 0.3236603 ] [0.80980012 0.82299068 1.23501937 1.23550464 1.68251597 1.68587434
 2.00020386 2.00091318 2.31106064 2.31286615 2.77194564 2.77284872
 2.96166336 2.96188413 3.00293374 3.00614093 3.40821149 3.40905806
 4.71674032 4.71834252 9.04134252 9.04181298]
nelec by numeric integration = 7.999999999847116
    CPU time for vxc     14.93 sec, wall time      1.37 sec
    CPU time for vj and vk      8.92 sec, wall time      0.83 sec
E1 = (4.170516196943899-4.951214558590504e-18j)  Ecoul = (1.232230319769747+1.1877089789007554e-26j)  Exc = -3.3043110249016805
cycle= 5 E= -10.7104376061741  delta_E= -2.01e-08  |g|= 6.76e-05  |ddm|= 0.000673
    CPU time for cycle= 5     29.27 sec, wall time      2.76 sec
HOMO = 0.575177850875  LUMO = 0.779788861164
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26349153  0.56295465  0.57089327  0.57517785] [0.77978886 0.78409151 0.78968936 1.12762014 1.71162291 1.71181099
 2.38011098 2.38203594 2.38266334 2.45538003 2.45848852 2.45908567
 3.5424544  3.54544305 3.72501802 3.72640872 3.72677373 4.61178199
 4.6134446  4.61501064 8.69813204 9.02874542]
   1 ( 0.000  0.000  0.500)   [-0.04887255  0.04512225  0.45216361  0.45941101] [0.91047785 0.91449361 0.93567968 1.29949617 1.6785564  1.86914953
 1.87083596 2.02138815 2.02289209 2.63461856 2.87105793 2.91117188
 2.91180436 2.95682566 2.95774827 3.25514258 3.59775651 3.59878593
 4.4964132  4.49739968 9.04181234 9.08663952]
   2 ( 0.000  0.500  0.000)   [-0.0488199   0.04507628  0.45216379  0.45940122] [0.91044562 0.9145558  0.93569208 1.29949448 1.67857507 1.86915648
 1.87077347 2.02142631 2.02290326 2.63467857 2.87112113 2.9111607
 2.91183397 2.95687461 2.95775181 3.2551718  3.59776701 3.59875634
 4.49639435 4.49742308 9.04181246 9.08663651]
   3 ( 0.000  0.500  0.500)   [0.06129984 0.06326276 0.31611997 0.32366002] [0.80979941 0.82299016 1.23501933 1.23550419 1.68251461 1.68587359
 2.000203   2.00091301 2.3110601  2.31286582 2.7719449  2.77284839
 2.96166306 2.96188321 3.00293369 3.00614022 3.40821142 3.4090573
 4.71673936 4.71834265 9.04134144 9.04181238]
nelec by numeric integration = 7.9999999998471125
    CPU time for vxc     14.29 sec, wall time      1.33 sec
    CPU time for vj and vk      9.19 sec, wall time      0.87 sec
E1 = (4.170516013987557-4.951190168639523e-18j)  Ecoul = (1.2322305864408762+2.858831920520947e-26j)  Exc = -3.3043111089020156
cycle= 6 E= -10.7104376064597  delta_E= -2.86e-10  |g|= 8.39e-07  |ddm|= 7.13e-05
    CPU time for cycle= 6     28.54 sec, wall time      2.75 sec
HOMO = 0.575177853023  LUMO = 0.779788858527
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26349155  0.56295462  0.57089325  0.57517785] [0.77978886 0.78409149 0.78968935 1.12762012 1.7116229  1.71181098
 2.38011097 2.38203593 2.38266332 2.45538    2.45848852 2.45908565
 3.54245439 3.54544303 3.72501799 3.7264087  3.72677373 4.61178198
 4.61344458 4.61501063 8.69813201 9.02874539]
   1 ( 0.000  0.000  0.500)   [-0.04887255  0.04512223  0.45216358  0.459411  ] [0.91047783 0.9144936  0.93567967 1.29949615 1.67855639 1.8691495
 1.87083595 2.02138815 2.02289206 2.63461855 2.87105791 2.91117187
 2.91180433 2.95682564 2.95774827 3.25514257 3.59775649 3.59878591
 4.49641318 4.49739966 9.04181231 9.08663949]
   2 ( 0.000  0.500  0.000)   [-0.04881992  0.04507628  0.45216377  0.4594012 ] [0.9104456  0.91455578 0.93569207 1.29949448 1.67857506 1.86915646
 1.87077345 2.02142631 2.02290325 2.63467856 2.87112111 2.91116069
 2.91183394 2.95687459 2.95775179 3.25517179 3.59776699 3.59875632
 4.49639432 4.49742306 9.04181243 9.08663648]
   3 ( 0.000  0.500  0.500)   [0.06129982 0.06326274 0.31611995 0.32366002] [0.8097994  0.82299015 1.2350193  1.2355042  1.68251459 1.68587356
 2.00020299 2.00091299 2.31106009 2.3128658  2.7719449  2.77284836
 2.96166304 2.9618832  3.00293367 3.00614021 3.4082114  3.40905728
 4.71673936 4.71834263 9.04134141 9.04181235]
nelec by numeric integration = 7.999999999847116
    CPU time for vxc     15.17 sec, wall time      1.49 sec
    CPU time for vj and vk      9.60 sec, wall time      0.97 sec
E1 = (4.170516003728787-4.9511911593730896e-18j)  Ecoul = (1.2322306016130373-4.7369519636711317e-26j)  Exc = -3.304311113815449
Extra cycle  E= -10.7104376064597  delta_E= -4.09e-14  |g|= 3.81e-07  |ddm|= 1.33e-06
    CPU time for scf_cycle    247.84 sec, wall time     25.71 sec
    CPU time for SCF    250.29 sec, wall time     25.97 sec
converged SCF energy = -10.7104376064597
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-100.0/47995820/scf.h5
