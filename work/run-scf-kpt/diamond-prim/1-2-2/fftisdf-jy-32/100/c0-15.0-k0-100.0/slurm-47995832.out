SLURMD_NODENAME = hpc-54-27
Start time = Thu Mar 13 04:24:37 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-100.0/47995832/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-100.0/47995832/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  1.00e+02

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.20686971]
 [ 0.          0.          0.41373942]
 ...
 [-0.2388726  -0.16890841 -0.82747884]
 [-0.2388726  -0.16890841 -0.62060913]
 [-0.2388726  -0.16890841 -0.41373942]], m0 = [23 23 23]
Pivoted Cholesky rank = 375, estimated error = 0.00e+00
Parent grid size = 12167, selected grid size = 390
    CPU time for interpolating functions     19.32 sec, wall time      2.72 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.50 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]     14.44 sec, wall time      0.61 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      9.60 sec, wall time      0.36 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 330 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      8.21 sec, wall time      0.31 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 330 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      8.52 sec, wall time      0.32 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 330 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     10.24 sec, wall time      0.38 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 330 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-100.0/47995832/tmp92j3igys
    CPU time for building ISDF     56.70 sec, wall time      2.17 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-100.0/47995832/tmp8z4qi68z
max_memory 81920 MB (current use 272 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f289922ebe0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      7.63 sec, wall time      0.24 sec
    CPU time for vj and vk      7.13 sec, wall time      0.23 sec
E1 = (4.673183787659304-6.715489327192023e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.3914963670406277
init E= -10.0507216052316
    CPU time for initialize scf     23.16 sec, wall time      0.77 sec
HOMO = 0.617029978233  LUMO = 0.80393733292
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655837  0.61115004  0.61138874  0.61702998] [0.80393733 0.8081448  0.81092681 1.13005372 1.73332625 1.73556134
 2.40667046 2.40722261 2.40801222 2.50110764 2.50172468 2.50205506
 3.56783936 3.56831306 3.76713422 3.76716106 3.76793563 4.64476526
 4.64490903 4.64502174 8.84194629 9.17011883]
   1 ( 0.000  0.000  0.500)   [-0.03769333  0.06167168  0.49459321  0.50130471] [0.93251701 0.93680255 0.94438037 1.33409442 1.72140049 1.90372478
 1.90506861 2.04477396 2.04669485 2.65772808 2.90262426 2.95423771
 2.95472431 2.98948739 2.9903895  3.28771733 3.62664024 3.62702812
 4.52706668 4.52716662 9.18283267 9.22709785]
   2 ( 0.000  0.500  0.000)   [-0.03769456  0.06166758  0.49459563  0.50130632] [0.93251846 0.93680203 0.94438305 1.33410051 1.72139784 1.90372697
 1.90506797 2.0447751  2.04669055 2.65773962 2.90262606 2.9542391
 2.95472529 2.98948288 2.99038479 3.28770783 3.62664074 3.62703054
 4.52706375 4.52716511 9.18283242 9.22709773]
   3 ( 0.000  0.500  0.500)   [0.07640224 0.07937145 0.34925929 0.36058342] [0.82048896 0.82900013 1.27130396 1.2717535  1.72863941 1.72939376
 2.03063054 2.0325047  2.33430091 2.33445578 2.81522222 2.81661543
 2.9876928  2.98878324 3.03483711 3.03571221 3.43440873 3.435062
 4.7529408  4.75324086 9.18254865 9.18256096]
nelec by numeric integration = 7.9999999998482
    CPU time for vxc      8.28 sec, wall time      0.26 sec
    CPU time for vj and vk      5.89 sec, wall time      0.20 sec
E1 = (4.205081090296044-3.538955869581339e-18j)  Ecoul = (1.184541832076071-2.9368344868292004e-25j)  Exc = -3.288184730627759
cycle= 1 E= -10.7074349062417  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     14.36 sec, wall time      0.47 sec
HOMO = 0.569685515975  LUMO = 0.774552423223
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823273  0.55648704  0.56495344  0.56968552] [0.77455242 0.779132   0.78469399 1.1198384  1.70809828 1.70833102
 2.37427401 2.37655498 2.37739408 2.44836541 2.45168852 2.45230426
 3.53690153 3.54001323 3.71838433 3.71995557 3.72041871 4.60534861
 4.60715581 4.60870837 8.6822657  9.01323784]
   1 ( 0.000  0.000  0.500)   [-0.05412995  0.04172027  0.44622995  0.4541136 ] [0.90552808 0.90923879 0.92942071 1.29165052 1.67221953 1.86345472
 1.86548484 2.01770025 2.01914451 2.63026339 2.86488322 2.90392978
 2.90479824 2.95102379 2.9520204  3.24884399 3.59221791 3.59323031
 4.49054284 4.49146305 9.02632958 9.07132429]
   2 ( 0.000  0.500  0.000)   [-0.05413231  0.0417166   0.44623058  0.45411503] [0.90552604 0.90924139 0.92942299 1.29165248 1.67221846 1.86345293
 1.86548806 2.01770346 2.01914041 2.63026878 2.86487918 2.90393198
 2.90479943 2.95101711 2.95201745 3.2488324  3.59221844 3.59323219
 4.49054101 4.49146418 9.02632991 9.07132311]
   3 ( 0.000  0.500  0.500)   [0.05607695 0.05914422 0.31090065 0.31917826] [0.80608112 0.81833198 1.22742223 1.22771095 1.67537136 1.67852401
 1.99604464 1.99673516 2.30681916 2.30902548 2.76485556 2.76597765
 2.95644869 2.95653486 2.99691849 3.00058939 3.40207183 3.40323256
 4.71034164 4.71232119 9.02590964 9.02634091]
nelec by numeric integration = 7.999999999846837
    CPU time for vxc      8.39 sec, wall time      0.27 sec
    CPU time for vj and vk      7.66 sec, wall time      0.26 sec
E1 = (4.165529820653389-3.6784485376084466e-18j)  Ecoul = (1.23972137014765+2.620280382782113e-26j)  Exc = -3.30681986333589
cycle= 2 E= -10.7104417705209  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     19.29 sec, wall time      0.64 sec
HOMO = 0.575299262941  LUMO = 0.779935641526
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343192  0.56308073  0.57102743  0.57529926] [0.77993564 0.78432058 0.78990161 1.12771312 1.71171628 1.71190019
 2.38020566 2.38219962 2.38283864 2.45569106 2.45875257 2.45938952
 3.54255286 3.5455577  3.72517495 3.72656249 3.72689386 4.61194347
 4.61361151 4.61519904 8.69868412 9.0292883 ]
   1 ( 0.000  0.000  0.500)   [-0.04874882  0.0451605   0.45231125  0.45952083] [0.91067952 0.91469605 0.93574742 1.29962956 1.67872743 1.86936778
 1.87099409 2.02146938 2.02300785 2.63471123 2.87121985 2.91135982
 2.91206515 2.95700391 2.95785908 3.25530973 3.5979155  3.59891182
 4.49658292 4.49758118 9.04235228 9.0871715 ]
   2 ( 0.000  0.500  0.000)   [-0.04875139  0.04515707  0.45231186  0.45952231] [0.91067715 0.91469861 0.93574948 1.2996318  1.67872637 1.86936622
 1.87099718 2.02147278 2.02300396 2.6347166  2.87121612 2.91136199
 2.91206636 2.95699743 2.95785591 3.2552985  3.59791604 3.59891361
 4.49658114 4.49758213 9.04235255 9.0871704 ]
   3 ( 0.000  0.500  0.500)   [0.06141256 0.06333387 0.31628963 0.32377868] [0.80986578 0.82300186 1.23521915 1.23562414 1.68272016 1.68607657
 2.00033427 2.00101841 2.31115238 2.31294681 2.77210867 2.77308534
 2.9617875  2.96199399 3.00305337 3.00623631 3.4083515  3.40914647
 4.7168541  4.71852348 9.0418819  9.04234952]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      7.89 sec, wall time      0.25 sec
    CPU time for vj and vk      7.14 sec, wall time      0.23 sec
E1 = (4.170643315652146-3.6352006718336585e-18j)  Ecoul = (1.2320394722436956+8.854174800200637e-27j)  Exc = -3.304310186586047
cycle= 3 E= -10.7105004966763  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     17.00 sec, wall time      0.55 sec
HOMO = 0.575158061618  LUMO = 0.779861097787
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350492  0.56288653  0.57084691  0.57515806] [0.7798611  0.78421682 0.78980559 1.12763125 1.71163462 1.71182111
 2.38010909 2.38208584 2.38270195 2.45545978 2.45856167 2.45917872
 3.54244012 3.54542951 3.7249698  3.7263757  3.72674196 4.61181113
 4.61344463 4.61504113 8.69813876 9.02875316]
   1 ( 0.000  0.000  0.500)   [-0.04881777  0.04506525  0.45214495  0.45937038] [0.91056789 0.91460236 0.93566315 1.29948014 1.67853206 1.86920224
 1.87083368 2.02140959 2.0229099  2.63459985 2.8710794  2.91118265
 2.91185003 2.95684612 2.95774016 3.25516355 3.5977682  3.59876453
 4.49642175 4.49742968 9.04181801 9.08663905]
   2 ( 0.000  0.500  0.000)   [-0.04882032  0.04506176  0.45214555  0.4593719 ] [0.91056554 0.91460494 0.93566522 1.29948235 1.67853098 1.86920068
 1.87083679 2.02141299 2.02290598 2.63460518 2.87107564 2.91118483
 2.91185125 2.95683963 2.95773706 3.25515236 3.59776875 3.59876632
 4.49641997 4.49743065 9.04181828 9.08663794]
   3 ( 0.000  0.500  0.500)   [0.06129344 0.06326976 0.3161509  0.32365754] [0.80981997 0.82290992 1.2350241  1.23550509 1.68250355 1.685848
 2.00022982 2.00088565 2.3110586  2.31285467 2.77194217 2.77286866
 2.96163583 2.9618634  3.0028988  3.00611529 3.40822271 3.4090416
 4.71672808 4.71834481 9.04134738 9.04181492]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      7.89 sec, wall time      0.25 sec
    CPU time for vj and vk      6.14 sec, wall time      0.20 sec
E1 = (4.170515818673862-3.635755712056787e-18j)  Ecoul = (1.2322290218274057-4.315384695921023e-26j)  Exc = -3.304372283599378
cycle= 4 E= -10.7105005410842  delta_E= -4.44e-08  |g|= 9.52e-06  |ddm|= 0.000627
    CPU time for cycle= 4     16.33 sec, wall time      0.53 sec
HOMO = 0.575157903592  LUMO = 0.779860209874
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350579  0.56288611  0.57084547  0.5751579 ] [0.77986021 0.78421691 0.78980445 1.12763024 1.71163413 1.71182046
 2.38010727 2.38208512 2.3827023  2.45545901 2.45856063 2.4591774
 3.54243946 3.54542861 3.72496951 3.72637463 3.72674095 4.61180967
 4.61344431 4.61504011 8.69813732 9.02875174]
   1 ( 0.000  0.000  0.500)   [-0.04881872  0.04506443  0.45214463  0.4593697 ] [0.91056794 0.91460133 0.93566195 1.29947925 1.67853079 1.8692013
 1.87083329 2.02140799 2.02290986 2.63459837 2.87107832 2.91118143
 2.9118496  2.95684568 2.95773844 3.25516214 3.597768   3.59876397
 4.49642148 4.49742886 9.04181667 9.08663755]
   2 ( 0.000  0.500  0.000)   [-0.04882127  0.04506095  0.45214524  0.45937121] [0.91056558 0.91460391 0.93566402 1.29948146 1.67852972 1.86919973
 1.87083639 2.02141138 2.02290595 2.6346037  2.87107456 2.9111836
 2.91185082 2.95683919 2.95773534 3.25515095 3.59776855 3.59876576
 4.49641971 4.49742983 9.04181694 9.08663644]
   3 ( 0.000  0.500  0.500)   [0.06129256 0.06326882 0.31615062 0.3236571 ] [0.80981885 0.82290901 1.23502404 1.23550432 1.68250131 1.68584674
 2.0002284  2.00088536 2.3110577  2.31285413 2.77194092 2.77286811
 2.96163545 2.96186174 3.00289869 3.00611412 3.40822258 3.40904035
 4.71672647 4.71834504 9.04134577 9.04181365]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      8.50 sec, wall time      0.27 sec
    CPU time for vj and vk      6.23 sec, wall time      0.20 sec
E1 = (4.170515511986845-3.635755212625793e-18j)  Ecoul = (1.2322294698184848-9.529439735069823e-28j)  Exc = -3.304372424901028
cycle= 5 E= -10.7105005410818  delta_E= 2.41e-12  |g|= 1.1e-05  |ddm|= 1.92e-05
    CPU time for cycle= 5     17.90 sec, wall time      0.57 sec
HOMO = 0.575157893717  LUMO = 0.779860205945
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350582  0.56288607  0.57084544  0.57515789] [0.77986021 0.78421687 0.78980442 1.12763021 1.71163412 1.71182044
 2.38010725 2.38208509 2.38270226 2.45545896 2.45856063 2.45917736
 3.54243944 3.54542859 3.72496947 3.72637459 3.72674094 4.61180964
 4.61344427 4.61504008 8.69813727 9.02875169]
   1 ( 0.000  0.000  0.500)   [-0.04881873  0.04506441  0.4521446   0.45936967] [0.9105679  0.91460131 0.93566193 1.29947922 1.67853078 1.86920126
 1.87083326 2.02140797 2.02290983 2.63459835 2.87107828 2.9111814
 2.91184955 2.95684566 2.95773843 3.25516212 3.59776797 3.59876394
 4.49642144 4.49742883 9.04181662 9.0866375 ]
   2 ( 0.000  0.500  0.000)   [-0.04882129  0.04506092  0.4521452   0.45937119] [0.91056554 0.91460388 0.935664   1.29948143 1.6785297  1.8691997
 1.87083636 2.02141137 2.02290592 2.63460368 2.87107452 2.91118358
 2.91185077 2.95683916 2.95773533 3.25515094 3.59776851 3.59876573
 4.49641967 4.4974298  9.04181689 9.08663639]
   3 ( 0.000  0.500  0.500)   [0.06129255 0.06326878 0.31615059 0.32365708] [0.80981881 0.82290899 1.23502398 1.23550432 1.68250126 1.68584669
 2.00022838 2.00088533 2.31105768 2.3128541  2.77194091 2.77286806
 2.96163541 2.96186172 3.00289866 3.0061141  3.40822255 3.40904033
 4.71672647 4.71834499 9.04134568 9.04181363]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      7.88 sec, wall time      0.25 sec
    CPU time for vj and vk      7.85 sec, wall time      0.25 sec
E1 = (4.170515493106004-3.635757464236765e-18j)  Ecoul = (1.2322294979542459+4.9496288637187165e-26j)  Exc = -3.3043724341382177
Extra cycle  E= -10.7105005410641  delta_E= 1.77e-11  |g|= 2.01e-05  |ddm|= 3.28e-05
    CPU time for scf_cycle    123.99 sec, wall time      4.03 sec
    CPU time for SCF    126.87 sec, wall time      4.12 sec
converged SCF energy = -10.7105005410641
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-100.0/47995832/scf.h5
