SLURMD_NODENAME = hpc-54-27
Start time = Thu Mar 13 04:24:33 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0/47995822/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0/47995822/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 = None

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
Pivoted Cholesky rank = 360, estimated error = 0.00e+00
Parent grid size = 567, selected grid size = 390
    CPU time for interpolating functions      1.82 sec, wall time      0.06 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.77 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]     14.71 sec, wall time      0.61 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      9.80 sec, wall time      0.37 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 321 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      8.99 sec, wall time      0.35 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 320 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      8.06 sec, wall time      0.30 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 320 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      8.57 sec, wall time      0.32 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 320 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0/47995822/tmp_s65avqm
    CPU time for building ISDF     56.31 sec, wall time      2.14 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0/47995822/tmp1mkt5xiq
max_memory 81920 MB (current use 265 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f35dc9b5cd0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.02 sec, wall time      0.26 sec
    CPU time for vj and vk      7.01 sec, wall time      0.22 sec
E1 = (4.673183787659304+4.99124206750764e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.3911261156264723
init E= -10.0503513538175
    CPU time for initialize scf     23.82 sec, wall time      0.81 sec
HOMO = 0.617077091233  LUMO = 0.804019452429
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24646662  0.61123466  0.61152783  0.61707709] [0.80401945 0.80822318 0.81097085 1.13012904 1.73331781 1.73555013
 2.40668721 2.40722426 2.40801293 2.50109576 2.50172208 2.50205955
 3.56781491 3.56829209 3.76700492 3.7671017  3.76787366 4.64457566
 4.6448787  4.6449513  8.84157217 9.1697703 ]
   1 ( 0.000  0.000  0.500)   [-0.03763808  0.06177069  0.4947503   0.50135276] [0.93251796 0.93685453 0.94449894 1.33424902 1.72137547 1.90373004
 1.90506577 2.04473089 2.04668569 2.65771186 2.90262035 2.95420171
 2.95471766 2.98945963 2.9903696  3.28773371 3.62659471 3.62697329
 4.52688431 4.52712964 9.18248326 9.22670404]
   2 ( 0.000  0.500  0.000)   [-0.03752846  0.06168455  0.49464495  0.50135417] [0.93260034 0.93682973 0.94456331 1.3340695  1.72147863 1.90373639
 1.90507747 2.04477158 2.04668361 2.65762584 2.90258959 2.95422704
 2.95471933 2.98945387 2.99036459 3.28770532 3.62663259 3.62702654
 4.52705104 4.52715359 9.18245022 9.22675244]
   3 ( 0.000  0.500  0.500)   [0.07654305 0.07940685 0.34938273 0.36063067] [0.82048062 0.82912025 1.2714132  1.27180517 1.72858229 1.72946533
 2.03059916 2.03249236 2.33430146 2.33443174 2.81519097 2.81661566
 2.98769306 2.9887694  3.03477249 3.03569185 3.4343677  3.4350451
 4.75283053 4.75321453 9.1821627  9.18221133]
nelec by numeric integration = 7.9999999998482
    CPU time for vxc      8.46 sec, wall time      0.27 sec
    CPU time for vj and vk      6.40 sec, wall time      0.22 sec
E1 = (4.205091283323892+2.720304808043436e-19j)  Ecoul = (1.1845269452757918-2.400661506768583e-26j)  Exc = -3.287929401901249
cycle= 1 E= -10.7071842712876  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     15.09 sec, wall time      0.50 sec
HOMO = 0.569781855879  LUMO = 0.774580155525
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26813252  0.5564937   0.56499668  0.56978186] [0.77458016 0.77914334 0.78473443 1.11994539 1.70809341 1.70831726
 2.37426581 2.37655102 2.37738568 2.44834979 2.45167431 2.45229669
 3.53688831 3.54001274 3.71833691 3.71991446 3.72032203 4.60519663
 4.60710657 4.60861701 8.68176236 9.01274646]
   1 ( 0.000  0.000  0.500)   [-0.05404565  0.04177281  0.44623575  0.45422542] [0.90555727 0.90925134 0.92952137 1.29171496 1.67220802 1.86343091
 1.86548084 2.01766139 2.01913274 2.63022679 2.86486107 2.90390212
 2.90479107 2.95099897 2.95201397 3.24889249 3.59219012 3.59321014
 4.49048918 4.49128023 9.02584119 9.07078994]
   2 ( 0.000  0.500  0.000)   [-0.0540011   0.04177672  0.44624666  0.45412212] [0.90550576 0.90927158 0.92955018 1.29164621 1.67227242 1.86345347
 1.86548821 2.01770029 2.01913469 2.63020113 2.86486871 2.90392691
 2.90478977 2.95098179 2.95199301 3.24882073 3.59221371 3.59323765
 4.49053595 4.49144019 9.02579276 9.07086366]
   3 ( 0.000  0.500  0.500)   [0.05617282 0.05921462 0.31091344 0.31925482] [0.80610145 0.81840642 1.22741078 1.22776415 1.67532948 1.67855492
 1.99602854 1.99672541 2.30678821 2.30902469 2.76482791 2.76597713
 2.95645438 2.95655687 2.99689476 3.00053752 3.40206337 3.40320358
 4.71021574 4.71231728 9.0254315  9.02580872]
nelec by numeric integration = 7.999999999846834
    CPU time for vxc      7.63 sec, wall time      0.24 sec
    CPU time for vj and vk      5.79 sec, wall time      0.19 sec
E1 = (4.165551072703875+1.3214518196247498e-19j)  Ecoul = (1.2396840820644395+1.0133265426362194e-24j)  Exc = -3.3065550103696983
cycle= 2 E= -10.7101929535875  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     16.67 sec, wall time      0.53 sec
HOMO = 0.575390688569  LUMO = 0.779963717237
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26333221  0.56308847  0.57106929  0.57539069] [0.77996372 0.78432916 0.78994087 1.12782104 1.71170946 1.71188527
 2.3801975  2.38219396 2.38282661 2.45567433 2.45873429 2.45937927
 3.54253799 3.54555619 3.72512658 3.72651761 3.72679428 4.61178594
 4.61356049 4.61510325 8.69816823 9.02878616]
   1 ( 0.000  0.000  0.500)   [-0.04866962  0.04521868  0.45231895  0.45962431] [0.9107003  0.91470653 0.93584846 1.29969764 1.67871593 1.86934763
 1.87098552 2.02143086 2.02299836 2.63467118 2.8712009  2.91133099
 2.91205345 2.95697468 2.95784367 3.25535423 3.59788497 3.59889182
 4.49652836 4.49739155 9.0418525  9.08662459]
   2 ( 0.000  0.500  0.000)   [-0.04861395  0.04520302  0.45232639  0.45953121] [0.91066003 0.9147304  0.93588165 1.29961689 1.67877597 1.8693608
 1.87099465 2.02146373 2.0229919  2.6346485  2.87119785 2.91135599
 2.91205688 2.95696687 2.95783665 3.25529124 3.59790935 3.59891712
 4.49657175 4.4975539  9.04180337 9.0866982 ]
   3 ( 0.000  0.500  0.500)   [0.06150997 0.06340004 0.31630187 0.32385142] [0.80988219 0.8230792  1.23520529 1.23567658 1.68267549 1.68610724
 2.0003157  2.00100823 2.31112198 2.31294291 2.77207973 2.77308276
 2.96180771 2.96199932 3.00302948 3.00618049 3.40834242 3.40911441
 4.71672004 4.71851675 9.04139234 9.04180442]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      9.11 sec, wall time      0.30 sec
    CPU time for vj and vk      6.57 sec, wall time      0.21 sec
E1 = (4.170664489338747+1.2502687444274092e-19j)  Ecoul = (1.2320029901694343+5.554401188097353e-25j)  Exc = -3.304046055854576
cycle= 3 E= -10.7102516743325  delta_E= -5.87e-05  |g|= 0.000983  |ddm|= 0.0247
    CPU time for cycle= 3     19.08 sec, wall time      0.62 sec
HOMO = 0.575249148814  LUMO = 0.779888436361
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340559  0.56289329  0.5708881   0.57524915] [0.77988844 0.78422489 0.78984438 1.12773881 1.71162739 1.71180584
 2.38010034 2.38207966 2.38268937 2.45544224 2.45854288 2.45916793
 3.54242474 3.54542753 3.72492074 3.72633096 3.72664147 4.6116532
 4.61339304 4.61494485 8.69762132 9.02824952]
   1 ( 0.000  0.000  0.500)   [-0.04873811  0.04512163  0.45215151  0.45947411] [0.91058907 0.91461296 0.93576362 1.29954651 1.67851969 1.86918098
 1.87082491 2.02137061 2.02289911 2.63455919 2.87105921 2.91115337
 2.91183782 2.95681647 2.95772521 3.25520808 3.59773742 3.59874415
 4.49636668 4.49723953 9.04131677 9.08609052]
   2 ( 0.000  0.500  0.000)   [-0.04868446  0.04510919  0.4521595   0.45937951] [0.910547   0.91463537 0.93579649 1.29946801 1.67858049 1.86919508
 1.8708337  2.02140417 2.02289449 2.63453703 2.87105778 2.91117799
 2.91184079 2.95680808 2.95771633 3.25514376 3.59776126 3.59876918
 4.49641006 4.49740194 9.04126754 9.08616443]
   3 ( 0.000  0.500  0.500)   [0.06138991 0.06333605 0.31616241 0.3237298 ] [0.80983653 0.82298643 1.2350094  1.23555675 1.68245844 1.68587798
 2.00021098 2.00087498 2.31102767 2.31285053 2.77191268 2.77286533
 2.96165566 2.9618681  3.00287415 3.00605918 3.40821294 3.4090092
 4.71659343 4.71833755 9.04085523 9.04126938]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      9.42 sec, wall time      0.30 sec
    CPU time for vj and vk      6.38 sec, wall time      0.21 sec
E1 = (4.1705366492036475+1.248634771785715e-19j)  Ecoul = (1.2321930329508992+9.589771817101126e-25j)  Exc = -3.3041083014856993
cycle= 4 E= -10.7102517173172  delta_E= -4.3e-08  |g|= 0.000198  |ddm|= 0.000707
    CPU time for cycle= 4     19.20 sec, wall time      0.62 sec
HOMO = 0.575248986331  LUMO = 0.779887901813
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340612  0.56289304  0.57088722  0.57524899] [0.7798879  0.78422492 0.78984368 1.1277382  1.71162709 1.71180543
 2.38009925 2.38207921 2.38268954 2.45544176 2.45854221 2.45916711
 3.54242433 3.54542698 3.72492055 3.72633028 3.72664084 4.61165231
 4.61339283 4.61494422 8.69762037 9.02824859]
   1 ( 0.000  0.000  0.500)   [-0.04873879  0.04512131  0.45215136  0.45947356] [0.91058895 0.91461228 0.93576288 1.29954606 1.67851896 1.86918048
 1.87082461 2.02136968 2.02289918 2.63455829 2.87105863 2.91115261
 2.91183749 2.95681614 2.95772405 3.25520713 3.59773724 3.5987438
 4.4963665  4.49723904 9.04131589 9.08608955]
   2 ( 0.000  0.500  0.000)   [-0.0486849   0.04510845  0.45215927  0.45937917] [0.91054711 0.91463481 0.93579583 1.29946731 1.67857963 1.86919442
 1.87083344 2.02140313 2.02289434 2.63453612 2.87105699 2.91117726
 2.91184054 2.95680787 2.95771542 3.255143   3.59776114 3.59876882
 4.49640986 4.4974014  9.04126667 9.08616342]
   3 ( 0.000  0.500  0.500)   [0.06138942 0.06333544 0.31616223 0.32372949] [0.80983581 0.82298591 1.23500932 1.23555627 1.6824571  1.68587717
 2.0002101  2.0008748  2.31102713 2.31285018 2.77191191 2.77286497
 2.96165532 2.96186718 3.00287408 3.00605844 3.40821284 3.40900843
 4.71659246 4.71833765 9.04085516 9.04126756]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc      8.27 sec, wall time      0.26 sec
    CPU time for vj and vk      6.17 sec, wall time      0.20 sec
E1 = (4.170536440630345+1.248430036758608e-19j)  Ecoul = (1.2321933389939035-1.7176594241409893e-24j)  Exc = -3.304108400327631
cycle= 5 E= -10.7102517186895  delta_E= -1.37e-09  |g|= 0.000132  |ddm|= 0.000348
    CPU time for cycle= 5     17.67 sec, wall time      0.56 sec
HOMO = 0.575248901003  LUMO = 0.779887544357
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340648  0.56289288  0.57088663  0.5752489 ] [0.77988754 0.78422494 0.78984321 1.12773778 1.71162689 1.71180516
 2.3800985  2.38207891 2.38268967 2.45544144 2.45854178 2.45916657
 3.54242406 3.54542661 3.72492044 3.72632982 3.72664043 4.6116517
 4.61339269 4.6149438  8.69761979 9.02824802]
   1 ( 0.000  0.000  0.500)   [-0.04873924  0.04512106  0.45215125  0.45947321] [0.91058889 0.91461183 0.93576238 1.29954575 1.67851847 1.86918014
 1.87082442 2.02136904 2.02289921 2.63455769 2.87105823 2.9111521
 2.91183729 2.95681594 2.95772328 3.25520651 3.59773714 3.59874357
 4.49636639 4.49723871 9.04131535 9.08608896]
   2 ( 0.000  0.500  0.000)   [-0.04868522  0.04510799  0.45215913  0.45937894] [0.91054718 0.91463442 0.93579538 1.29946686 1.67857907 1.86919399
 1.87083327 2.02140243 2.02289426 2.63453551 2.87105648 2.91117677
 2.91184038 2.95680773 2.95771478 3.25514248 3.59776106 3.59876859
 4.49640973 4.49740105 9.04126614 9.08616279]
   3 ( 0.000  0.500  0.500)   [0.06138908 0.06333502 0.31616212 0.3237293 ] [0.80983532 0.82298556 1.23500929 1.23555596 1.68245617 1.68587665
 2.00020951 2.00087468 2.31102678 2.31284994 2.7719114  2.77286474
 2.9616552  2.96186646 3.00287404 3.00605795 3.4082128  3.4090079
 4.71659181 4.71833773 9.04085472 9.04126684]
nelec by numeric integration = 7.999999999847126
    CPU time for vxc      9.23 sec, wall time      0.30 sec
    CPU time for vj and vk      6.75 sec, wall time      0.22 sec
E1 = (4.1705363122092525+1.2484471650114532e-19j)  Ecoul = (1.232193524965478+4.920661891279001e-25j)  Exc = -3.304108458967639
cycle= 6 E= -10.710251719779  delta_E= -1.09e-09  |g|= 4.56e-07  |ddm|= 0.000139
    CPU time for cycle= 6     19.30 sec, wall time      0.63 sec
HOMO = 0.575248906285  LUMO = 0.779887541575
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340649  0.56289285  0.57088662  0.57524891] [0.77988754 0.78422491 0.7898432  1.12773776 1.71162688 1.71180515
 2.3800985  2.3820789  2.38268965 2.45544141 2.45854179 2.45916654
 3.54242404 3.54542659 3.72492041 3.72632981 3.72664043 4.61165169
 4.61339266 4.61494378 8.69761976 9.02824799]
   1 ( 0.000  0.000  0.500)   [-0.04873922  0.045121    0.45215122  0.45947322] [0.9105889  0.91461183 0.93576237 1.29954571 1.67851845 1.86918009
 1.87082441 2.02136903 2.02289917 2.63455768 2.87105819 2.91115209
 2.91183727 2.95681594 2.9577233  3.25520653 3.59773713 3.59874355
 4.49636636 4.49723869 9.04131532 9.08608892]
   2 ( 0.000  0.500  0.000)   [-0.04868526  0.04510803  0.45215911  0.4593789 ] [0.91054713 0.91463439 0.93579535 1.29946688 1.67857908 1.86919399
 1.87083326 2.02140244 2.02289427 2.6345355  2.87105649 2.91117676
 2.91184034 2.95680769 2.95771474 3.25514245 3.59776103 3.59876858
 4.49640971 4.49740103 9.04126611 9.08616277]
   3 ( 0.000  0.500  0.500)   [0.06138906 0.06333501 0.3161621  0.3237293 ] [0.80983531 0.82298554 1.23500926 1.23555596 1.68245614 1.68587662
 2.0002095  2.00087466 2.31102677 2.31284992 2.7719114  2.77286471
 2.96165517 2.96186646 3.00287402 3.00605795 3.40821278 3.40900789
 4.71659181 4.7183377  9.04085469 9.04126681]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      7.84 sec, wall time      0.25 sec
    CPU time for vj and vk      6.87 sec, wall time      0.22 sec
E1 = (4.1705363023770525+1.248460848655824e-19j)  Ecoul = (1.2321935394618022-1.2367445727692935e-25j)  Exc = -3.304108463631774
Extra cycle  E= -10.710251719779  delta_E= -1.07e-14  |g|= 2.11e-07  |ddm|= 5.34e-07
    CPU time for scf_cycle    145.76 sec, wall time      4.74 sec
    CPU time for SCF    149.59 sec, wall time      4.88 sec
converged SCF energy = -10.710251719779
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0/47995822/scf.h5
