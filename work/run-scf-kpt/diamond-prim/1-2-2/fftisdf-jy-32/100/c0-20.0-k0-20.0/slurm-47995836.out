SLURMD_NODENAME = hpc-54-27
Start time = Thu Mar 13 04:24:43 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-20.0/47995836/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-20.0/47995836/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  2.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.43254576]
 [ 0.          0.          0.86509151]
 ...
 [-0.49946088 -0.35317212 -1.73018302]
 [-0.49946088 -0.35317212 -1.29763727]
 [-0.49946088 -0.35317212 -0.86509151]], m0 = [11 11 11]
Pivoted Cholesky rank = 359, estimated error = 0.00e+00
Parent grid size = 1331, selected grid size = 520
    CPU time for interpolating functions      3.24 sec, wall time      0.10 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      1.74 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]     16.29 sec, wall time      0.79 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     12.64 sec, wall time      0.48 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 327 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     11.06 sec, wall time      0.42 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     11.02 sec, wall time      0.42 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     11.43 sec, wall time      0.43 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 326 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-20.0/47995836/tmpilv0tzfz
    CPU time for building ISDF     70.88 sec, wall time      2.81 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-20.0/47995836/tmpdfb01fv1
max_memory 81920 MB (current use 242 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f212e04fbe0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.34 sec, wall time      0.27 sec
    CPU time for vj and vk      7.13 sec, wall time      0.24 sec
E1 = (4.673183787659303-5.535741202144736e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.391484781117709
init E= -10.0507100193087
    CPU time for initialize scf     23.40 sec, wall time      0.79 sec
HOMO = 0.617030699526  LUMO = 0.803931489975
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655624  0.61115157  0.61139168  0.6170307 ] [0.80393149 0.80814619 0.81092405 1.13007007 1.73332489 1.73555821
 2.40667454 2.40722501 2.40801221 2.50110562 2.50172813 2.50205506
 3.56784277 3.56831848 3.76714383 3.76716602 3.76793283 4.64475893
 4.64491029 4.64501791 8.84194626 9.17011898]
   1 ( 0.000  0.000  0.500)   [-0.03769349  0.06166781  0.4945936   0.50130526] [0.93252203 0.93680285 0.9443849  1.33410427 1.7214025  1.90372551
 1.90506898 2.04477358 2.0466892  2.65774062 2.90262933 2.95423614
 2.95472472 2.98948976 2.99038419 3.28771706 3.62664827 3.62703125
 4.52706572 4.52716609 9.18283296 9.22709898]
   2 ( 0.000  0.500  0.000)   [-0.0376925   0.06166656  0.49459362  0.50130591] [0.93252629 0.93680225 0.94438573 1.33410121 1.72140236 1.9037259
 1.90506867 2.04477353 2.04668876 2.65773977 2.90262956 2.95423637
 2.95472548 2.98948863 2.99038404 3.28771703 3.62664675 3.62703215
 4.5270641  4.52716529 9.18283287 9.22709906]
   3 ( 0.000  0.500  0.500)   [0.0764014  0.07937393 0.34926299 0.36058418] [0.82049543 0.82899623 1.27129938 1.27175843 1.7286405  1.7293973
 2.03063647 2.03250382 2.33430072 2.33445689 2.81522295 2.8166142
 2.98769785 2.98877931 3.03482797 3.03570734 3.43441845 3.43506126
 4.75293915 4.75324045 9.18254915 9.18256161]
nelec by numeric integration = 7.999999999848204
    CPU time for vxc      8.09 sec, wall time      0.26 sec
    CPU time for vj and vk      6.57 sec, wall time      0.21 sec
E1 = (4.20508273063051-5.949867447135721e-19j)  Ecoul = (1.1845380491370119+8.615497044716967e-25j)  Exc = -3.2881811081491312
cycle= 1 E= -10.7074334263677  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     14.88 sec, wall time      0.48 sec
HOMO = 0.569687584447  LUMO = 0.774539607377
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823545  0.55648761  0.56495053  0.56968758] [0.77453961 0.77912451 0.78469329 1.11984346 1.70809773 1.70832398
 2.37427674 2.37655413 2.37739263 2.44836517 2.45168395 2.45230683
 3.53690164 3.54001807 3.71838002 3.7199565  3.72041576 4.60534257
 4.60715615 4.60870584 8.6822641  9.01323574]
   1 ( 0.000  0.000  0.500)   [-0.05413091  0.04171947  0.44623041  0.45411283] [0.90552553 0.90923879 0.92942254 1.29164796 1.67222062 1.86345137
 1.86548698 2.01770053 2.0191393  2.63027022 2.86487657 2.90392683
 2.90479724 2.95101306 2.95202168 3.24884003 3.59222231 3.59323062
 4.49054055 4.49146042 9.02632722 9.0713219 ]
   2 ( 0.000  0.500  0.000)   [-0.05413078  0.04171896  0.44623134  0.45411265] [0.90552399 0.90924301 0.92942239 1.29164728 1.67221988 1.86345175
 1.8654873  2.01770142 2.01913844 2.63026937 2.86487897 2.90392658
 2.9047983  2.95101325 2.95202177 3.24884084 3.5922206  3.59323056
 4.49053907 4.49145862 9.0263274  9.07132231]
   3 ( 0.000  0.500  0.500)   [0.05607248 0.05914845 0.31090052 0.31918246] [0.8060807  0.81832519 1.2274219  1.22770199 1.67536761 1.67852492
 1.99604764 1.9967293  2.30681577 2.30902331 2.76485524 2.76597835
 2.95644588 2.95653684 2.99691441 3.00058127 3.40206989 3.40323573
 4.71033757 4.71231691 9.02590808 9.02633831]
nelec by numeric integration = 7.999999999846837
    CPU time for vxc      8.64 sec, wall time      0.28 sec
    CPU time for vj and vk      6.32 sec, wall time      0.20 sec
E1 = (4.165531299933384-5.564610904495286e-19j)  Ecoul = (1.23971858810728+2.994515996218961e-26j)  Exc = -3.3068169054824423
cycle= 2 E= -10.7104401154279  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     18.75 sec, wall time      0.61 sec
HOMO = 0.575301168033  LUMO = 0.779923015045
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343465  0.56308159  0.57102456  0.57530117] [0.77992302 0.78431329 0.78990099 1.12771793 1.71171569 1.71189338
 2.38020847 2.38219881 2.38283705 2.45569111 2.45874828 2.45939219
 3.54255296 3.54556253 3.7251711  3.72656348 3.72689091 4.61193769
 4.61361185 4.61519664 8.69868282 9.02928649]
   1 ( 0.000  0.000  0.500)   [-0.04874982  0.04515949  0.45231189  0.45952   ] [0.91067677 0.91469598 0.93574923 1.29962695 1.67872851 1.86936453
 1.87099613 2.02146958 2.02300276 2.63471815 2.87121344 2.91135705
 2.91206433 2.95699364 2.95786001 3.255306   3.59791984 3.59891212
 4.49658077 4.49757856 9.04235017 9.08716944]
   2 ( 0.000  0.500  0.000)   [-0.04874971  0.04515904  0.45231284  0.45951985] [0.91067526 0.91470015 0.935749   1.29962625 1.67872778 1.86936493
 1.87099645 2.0214705  2.02300193 2.63471729 2.87121581 2.91135676
 2.91206538 2.95699377 2.95786005 3.25530681 3.59791815 3.59891202
 4.49657927 4.49757677 9.04235034 9.08716983]
   3 ( 0.000  0.500  0.500)   [0.06140835 0.06333763 0.31628964 0.32378278] [0.80986485 0.82299546 1.23521885 1.23561517 1.68271642 1.68607775
 2.00033717 2.00101268 2.31114928 2.31294464 2.77210841 2.77308606
 2.96178954 2.96199141 3.00304932 3.00622827 3.40834971 3.40914936
 4.71684992 4.71851929 9.0418806  9.0423472 ]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc      8.26 sec, wall time      0.26 sec
    CPU time for vj and vk      6.95 sec, wall time      0.23 sec
E1 = (4.170644776508302-5.469231907807846e-19j)  Ecoul = (1.232036771220615+2.6379508670590635e-26j)  Exc = -3.3043072935241216
cycle= 3 E= -10.7104988437813  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     18.43 sec, wall time      0.59 sec
HOMO = 0.57516009919  LUMO = 0.77984854194
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350761  0.56288747  0.57084414  0.5751601 ] [0.77984854 0.78420964 0.78980506 1.12763614 1.71163411 1.71181437
 2.38011201 2.38208511 2.38270046 2.45545995 2.45855753 2.45918154
 3.54244031 3.54543442 3.72496606 3.72637679 3.72673913 4.61180547
 4.6134451  4.61503884 8.69813777 9.02875165]
   1 ( 0.000  0.000  0.500)   [-0.0488187   0.04506429  0.45214567  0.45936967] [0.91056524 0.91460236 0.93566503 1.29947765 1.67853327 1.86919908
 1.87083587 2.02140987 2.02290487 2.63460683 2.87107309 2.91118
 2.91184933 2.95683593 2.95774121 3.25515994 3.59777264 3.59876493
 4.49641971 4.49742719 9.04181621 9.08663729]
   2 ( 0.000  0.500  0.000)   [-0.04881859  0.04506383  0.45214662  0.45936953] [0.91056374 0.91460653 0.9356648  1.29947695 1.67853255 1.86919947
 1.87083619 2.02141079 2.02290404 2.63460597 2.87107546 2.9111797
 2.9118504  2.95683606 2.95774126 3.25516076 3.59777096 3.59876482
 4.4964182  4.4974254  9.04181638 9.08663768]
   3 ( 0.000  0.500  0.500)   [0.06128928 0.0632736  0.31615099 0.32366177] [0.80981909 0.82290357 1.23502392 1.23549626 1.68249995 1.68584932
 2.00023282 2.00087999 2.31105555 2.31285258 2.77194205 2.77286949
 2.96163796 2.9618609  3.00289485 3.00610737 3.40822101 3.40904458
 4.716724   4.71834075 9.04134639 9.0418129 ]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc      8.95 sec, wall time      0.29 sec
    CPU time for vj and vk      7.57 sec, wall time      0.25 sec
E1 = (4.170517370565625-5.469311962800903e-19j)  Ecoul = (1.2322261861217532+9.953531357716639e-26j)  Exc = -3.3043693468271056
cycle= 4 E= -10.7104988881258  delta_E= -4.43e-08  |g|= 1.82e-05  |ddm|= 0.000627
    CPU time for cycle= 4     16.92 sec, wall time      0.56 sec
HOMO = 0.575159936055  LUMO = 0.779847661916
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350848  0.56288707  0.57084271  0.57515994] [0.77984766 0.78420973 0.78980392 1.12763514 1.71163362 1.71181371
 2.3801102  2.3820844  2.38270081 2.45545918 2.45855649 2.45918023
 3.54243966 3.54543353 3.72496578 3.72637572 3.72673812 4.61180401
 4.61344478 4.61503783 8.69813634 9.02875025]
   1 ( 0.000  0.000  0.500)   [-0.04881964  0.04506347  0.45214536  0.45936899] [0.91056528 0.91460134 0.93566384 1.29947676 1.67853201 1.86919815
 1.87083547 2.02140827 2.02290483 2.63460536 2.87107201 2.91117879
 2.91184891 2.9568355  2.9577395  3.25515854 3.59777244 3.59876437
 4.49641945 4.49742637 9.04181488 9.08663581]
   2 ( 0.000  0.500  0.000)   [-0.04881953  0.04506302  0.45214631  0.45936884] [0.91056378 0.9146055  0.93566361 1.29947606 1.67853129 1.86919854
 1.87083579 2.0214092  2.02290401 2.6346045  2.87107438 2.91117849
 2.91184998 2.95683563 2.95773955 3.25515935 3.59777075 3.59876427
 4.49641794 4.49742458 9.04181505 9.0866362 ]
   3 ( 0.000  0.500  0.500)   [0.06128841 0.06327266 0.31615072 0.32366132] [0.80981797 0.82290267 1.23502386 1.2354955  1.68249773 1.68584807
 2.0002314  2.0008797  2.31105465 2.31285205 2.77194081 2.77286895
 2.96163758 2.96185926 3.00289474 3.00610621 3.40822088 3.40904334
 4.71672241 4.71834097 9.04134476 9.04181166]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      9.26 sec, wall time      0.29 sec
    CPU time for vj and vk      9.91 sec, wall time      0.32 sec
E1 = (4.170517065025782-5.469023412375467e-19j)  Ecoul = (1.2322266326267408-3.0052445045299666e-26j)  Exc = -3.304369487756444
cycle= 5 E= -10.71049888809  delta_E= 3.58e-11  |g|= 2.99e-05  |ddm|= 4.95e-05
    CPU time for cycle= 5     21.37 sec, wall time      0.69 sec
HOMO = 0.575159926331  LUMO = 0.779847651415
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350851  0.56288702  0.57084267  0.57515993] [0.77984765 0.78420969 0.78980389 1.1276351  1.7116336  1.71181369
 2.38011017 2.38208436 2.38270077 2.45545913 2.45855648 2.45918018
 3.54243963 3.54543349 3.72496574 3.72637568 3.72673811 4.61180398
 4.61344474 4.61503779 8.69813628 9.02875019]
   1 ( 0.000  0.000  0.500)   [-0.04881966  0.04506344  0.45214532  0.45936896] [0.91056524 0.91460131 0.93566382 1.29947673 1.67853198 1.86919811
 1.87083544 2.02140825 2.0229048  2.63460533 2.87107197 2.91117876
 2.91184886 2.95683547 2.95773948 3.25515852 3.5977724  3.59876434
 4.4964194  4.49742633 9.04181482 9.08663574]
   2 ( 0.000  0.500  0.000)   [-0.04881955  0.04506299  0.45214628  0.45936882] [0.91056374 0.91460547 0.93566359 1.29947603 1.67853126 1.8691985
 1.87083576 2.02140917 2.02290398 2.63460447 2.87107434 2.91117846
 2.91184993 2.9568356  2.95773953 3.25515933 3.59777072 3.59876423
 4.4964179  4.49742454 9.04181499 9.08663613]
   3 ( 0.000  0.500  0.500)   [0.06128839 0.06327262 0.31615068 0.32366131] [0.80981793 0.82290265 1.2350238  1.2354955  1.68249766 1.68584802
 2.00023137 2.00087967 2.31105463 2.31285201 2.77194079 2.7728689
 2.96163754 2.96185923 3.00289472 3.00610618 3.40822085 3.40904331
 4.71672239 4.71834093 9.04134466 9.04181165]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      8.65 sec, wall time      0.28 sec
    CPU time for vj and vk      8.30 sec, wall time      0.27 sec
E1 = (4.170517044224266-5.469525157319922e-19j)  Ecoul = (1.2322266637236179-5.539065732099856e-26j)  Exc = -3.304369497920394
Extra cycle  E= -10.7104988879586  delta_E= 1.31e-10  |g|= 5.48e-05  |ddm|= 8.92e-05
    CPU time for scf_cycle    130.93 sec, wall time      4.27 sec
    CPU time for SCF    134.78 sec, wall time      4.39 sec
converged SCF energy = -10.7104988879586
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-20.0/47995836/scf.h5
