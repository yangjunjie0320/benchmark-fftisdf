SLURMD_NODENAME = hpc-34-20
Start time = Thu Mar 13 04:24:44 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-40.0/47995838/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-40.0/47995838/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  4.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.31720022]
 [ 0.          0.          0.63440044]
 ...
 [-0.36627131 -0.25899289 -1.26880088]
 [-0.36627131 -0.25899289 -0.95160066]
 [-0.36627131 -0.25899289 -0.63440044]], m0 = [15 15 15]
Pivoted Cholesky rank = 369, estimated error = 0.00e+00
Parent grid size = 3375, selected grid size = 520
    CPU time for interpolating functions     10.08 sec, wall time      0.35 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.47 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]     15.71 sec, wall time      0.79 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     14.26 sec, wall time      0.55 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 327 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     15.40 sec, wall time      0.57 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     17.33 sec, wall time      0.69 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     14.22 sec, wall time      0.55 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 326 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-40.0/47995838/tmp33pm_vm8
    CPU time for building ISDF     83.53 sec, wall time      3.35 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-40.0/47995838/tmpvn79j7lx
max_memory 81920 MB (current use 222 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f983b74abe0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      9.29 sec, wall time      0.30 sec
    CPU time for vj and vk      8.62 sec, wall time      0.29 sec
E1 = (4.673183787659304-1.2069730817791162e-17j)  Ecoul = (1.4764640721357722+2.331033469502186e-33j)  Exc = -3.391483677714365
init E= -10.0507089159054
    CPU time for initialize scf     26.31 sec, wall time      0.89 sec
HOMO = 0.617031784638  LUMO = 0.803936218734
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2465547   0.6111499   0.61139047  0.61703178] [0.80393622 0.80814401 0.8109272  1.13006822 1.73332565 1.73555895
 2.40667575 2.40722515 2.40801215 2.50110666 2.50172758 2.50205453
 3.56784246 3.56831888 3.76714798 3.76716415 3.76793383 4.64475777
 4.64490827 4.6450281  8.84194686 9.17011906]
   1 ( 0.000  0.000  0.500)   [-0.03769181  0.06166953  0.49459204  0.50130767] [0.93252041 0.93680383 0.94438754 1.33409916 1.72140029 1.90372335
 1.90506804 2.04477169 2.04669088 2.65773793 2.90262798 2.95423701
 2.9547246  2.98948776 2.99038562 3.28771751 3.62664729 3.62703113
 4.52707092 4.52716708 9.18283323 9.22709996]
   2 ( 0.000  0.500  0.000)   [-0.03769241  0.06166938  0.49459417  0.50130791] [0.93252075 0.93680549 0.94438595 1.33409958 1.72140013 1.90372459
 1.90506796 2.04477182 2.04669041 2.65773829 2.90262813 2.95423628
 2.95472472 2.98948838 2.99038464 3.28771413 3.62664814 3.62703082
 4.52706617 4.52716568 9.18283301 9.22709967]
   3 ( 0.000  0.500  0.500)   [0.07640226 0.07937332 0.34926279 0.36058609] [0.82049195 0.82900016 1.2712994  1.2717577  1.72863791 1.7293951
 2.03063439 2.03250306 2.33430076 2.3344568  2.81522203 2.81661485
 2.9876953  2.98877826 3.03483041 3.03571039 3.43441695 3.43506141
 4.75294761 4.75324292 9.18254955 9.18256217]
nelec by numeric integration = 7.9999999998482005
    CPU time for vxc      9.39 sec, wall time      0.30 sec
    CPU time for vj and vk      9.50 sec, wall time      0.33 sec
E1 = (4.20508253000293-2.8692634283304483e-18j)  Ecoul = (1.184538595888113-4.841397147522394e-25j)  Exc = -3.2881804874900635
cycle= 1 E= -10.7074324595851  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     19.10 sec, wall time      0.64 sec
HOMO = 0.569686505765  LUMO = 0.774544875867
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823222  0.55648821  0.56494935  0.56968651] [0.77454488 0.77913145 0.78469186 1.1198424  1.70810129 1.70832746
 2.3742782  2.37655557 2.37739323 2.44836344 2.45168576 2.45230591
 3.53690068 3.54001755 3.71838171 3.71995892 3.72041687 4.60534292
 4.60715371 4.60870906 8.68226409 9.0132366 ]
   1 ( 0.000  0.000  0.500)   [-0.05413055  0.04171986  0.44623149  0.45411031] [0.9055272  0.90923868 0.92942437 1.29164569 1.67221971 1.86345149
 1.86548643 2.01769765 2.01914093 2.63026858 2.86487595 2.90392893
 2.9047984  2.951016   2.95202074 3.24884084 3.59222134 3.59323064
 4.4905411  4.49146285 9.02632826 9.07132268]
   2 ( 0.000  0.500  0.000)   [-0.05412984  0.04171955  0.4462324   0.45411263] [0.90553049 0.90923884 0.92942265 1.29164649 1.67221892 1.86345186
 1.86548675 2.01769823 2.01913889 2.63026934 2.86487668 2.90392725
 2.90479777 2.95101482 2.95202061 3.24883807 3.59222167 3.59323101
 4.49053805 4.49146094 9.02632869 9.07132418]
   3 ( 0.000  0.500  0.500)   [0.05607299 0.0591469  0.31090294 0.31918208] [0.80608306 0.81832831 1.22742251 1.2276998  1.67536622 1.67852412
 1.996047   1.99672975 2.3068169  2.30902496 2.76485358 2.76597819
 2.9564455  2.95653352 2.99691687 3.00058235 3.40207038 3.40323389
 4.7103428  4.7123195  9.02590852 9.02633926]
nelec by numeric integration = 7.999999999846837
    CPU time for vxc      9.47 sec, wall time      0.31 sec
    CPU time for vj and vk      8.08 sec, wall time      0.26 sec
E1 = (4.165532167671492-2.8490227138911694e-18j)  Ecoul = (1.2397174364443573-1.9626859321898774e-27j)  Exc = -3.3068157207193725
cycle= 2 E= -10.7104392145896  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     20.35 sec, wall time      0.67 sec
HOMO = 0.575299986433  LUMO = 0.779928031224
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343148  0.56308184  0.57102321  0.57529999] [0.77992803 0.78432001 0.78989948 1.12771685 1.71171921 1.71189668
 2.3802098  2.38220013 2.38283756 2.4556891  2.4587498  2.45939108
 3.54255189 3.54556186 3.72517234 3.72656578 3.72689185 4.61193792
 4.61360942 4.61519962 8.69868226 9.02928688]
   1 ( 0.000  0.000  0.500)   [-0.04874944  0.04515972  0.45231273  0.45951747] [0.91067844 0.91469585 0.93575092 1.29962455 1.67872747 1.86936444
 1.87099551 2.02146663 2.02300419 2.63471653 2.87121254 2.91135895
 2.91206528 2.95699636 2.95785916 3.25530679 3.59791873 3.598912
 4.49658099 4.49758076 9.0423507  9.08716963]
   2 ( 0.000  0.500  0.000)   [-0.04874897  0.04515974  0.45231369  0.45951963] [0.91068156 0.91469591 0.93574918 1.29962551 1.67872674 1.8693649
 1.87099581 2.02146733 2.02300237 2.63471724 2.87121354 2.91135725
 2.91206453 2.95699515 2.95785877 3.25530378 3.59791905 3.59891232
 4.49657806 4.49757894 9.04235114 9.0871712 ]
   3 ( 0.000  0.500  0.500)   [0.06140877 0.06333617 0.31629187 0.3237823 ] [0.80986725 0.82299833 1.23521919 1.23561282 1.68271487 1.68607675
 2.00033641 2.00101295 2.31115022 2.31294622 2.77210664 2.77308572
 2.96178621 2.96199092 3.0030516  3.00622924 3.40835011 3.40914744
 4.71685512 4.71852125 9.0418805  9.04234766]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     12.10 sec, wall time      0.39 sec
    CPU time for vj and vk      7.18 sec, wall time      0.23 sec
E1 = (4.170645535496776-2.828062867022311e-18j)  Ecoul = (1.2320358133315554+6.902848465045942e-26j)  Exc = -3.304306189649203
cycle= 3 E= -10.710497938807  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     22.90 sec, wall time      0.74 sec
HOMO = 0.575158856225  LUMO = 0.779853505748
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350446  0.56288766  0.57084273  0.57515886] [0.77985351 0.78421631 0.78980351 1.12763501 1.7116376  1.71181764
 2.38011329 2.38208639 2.38270092 2.45545787 2.45855898 2.45918037
 3.5424392  3.5454337  3.72496723 3.72637903 3.72674002 4.61180565
 4.61344261 4.61504176 8.69813707 9.0287519 ]
   1 ( 0.000  0.000  0.500)   [-0.04881838  0.04506451  0.45214646  0.45936707] [0.91056685 0.91460219 0.93566667 1.29947521 1.67853219 1.86919895
 1.87083519 2.02140689 2.02290629 2.63460518 2.87107215 2.91118184
 2.91185022 2.9568386  2.9577403  3.25516066 3.59777148 3.59876476
 4.49641987 4.49742932 9.04181659 9.08663733]
   2 ( 0.000  0.500  0.000)   [-0.04881787  0.04506448  0.45214741  0.45936926] [0.91057001 0.91460226 0.93566494 1.29947614 1.67853144 1.86919939
 1.8708355  2.02140757 2.02290443 2.63460588 2.87107312 2.91118014
 2.91184948 2.9568374  2.95773995 3.25515768 3.59777181 3.59876507
 4.49641694 4.49742751 9.04181704 9.0866389 ]
   3 ( 0.000  0.500  0.500)   [0.06128966 0.06327211 0.31615317 0.32366122] [0.80982148 0.82290641 1.23502419 1.23549386 1.68249835 1.68584826
 2.00023202 2.00088022 2.31105646 2.31285413 2.77194022 2.77286908
 2.9616346  2.96186037 3.00289708 3.00610828 3.40822136 3.40904261
 4.71672915 4.71834265 9.04134615 9.04181321]
nelec by numeric integration = 7.999999999847125
    CPU time for vxc      8.36 sec, wall time      0.27 sec
    CPU time for vj and vk      8.15 sec, wall time      0.26 sec
E1 = (4.170518093020804-2.8281210962662264e-18j)  Ecoul = (1.2322252822454864-5.145897456937704e-26j)  Exc = -3.3043682604434412
cycle= 4 E= -10.7104979831632  delta_E= -4.44e-08  |g|= 2.41e-05  |ddm|= 0.000627
    CPU time for cycle= 4     20.04 sec, wall time      0.66 sec
HOMO = 0.575158695195  LUMO = 0.779852631075
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350532  0.56288725  0.57084131  0.5751587 ] [0.77985263 0.78421639 0.78980238 1.12763402 1.71163712 1.711817
 2.38011149 2.38208568 2.38270126 2.45545711 2.45855795 2.45917907
 3.54243855 3.54543282 3.72496695 3.72637796 3.72673902 4.6118042
 4.61344229 4.61504075 8.69813564 9.0287505 ]
   1 ( 0.000  0.000  0.500)   [-0.04881931  0.0450637   0.45214615  0.4593664 ] [0.9105669  0.91460118 0.93566549 1.29947432 1.67853093 1.86919802
 1.8708348  2.02140531 2.02290625 2.63460372 2.87107108 2.91118063
 2.9118498  2.95683817 2.95773861 3.25515927 3.59777128 3.59876421
 4.49641961 4.49742851 9.04181527 9.08663586]
   2 ( 0.000  0.500  0.000)   [-0.04881881  0.04506368  0.4521471   0.45936858] [0.91057004 0.91460124 0.93566376 1.29947526 1.67853018 1.86919847
 1.8708351  2.02140599 2.0229044  2.63460442 2.87107205 2.91117894
 2.91184906 2.95683696 2.95773825 3.25515629 3.59777161 3.59876452
 4.49641668 4.4974267  9.04181572 9.08663743]
   3 ( 0.000  0.500  0.500)   [0.0612888  0.06327118 0.3161529  0.32366078] [0.80982037 0.82290551 1.23502412 1.2354931  1.68249614 1.68584702
 2.00023061 2.00087994 2.31105557 2.3128536  2.77193899 2.77286854
 2.96163422 2.96185874 3.00289697 3.00610713 3.40822124 3.40904138
 4.71672757 4.71834287 9.04134451 9.041812  ]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc      8.28 sec, wall time      0.27 sec
    CPU time for vj and vk      7.19 sec, wall time      0.23 sec
E1 = (4.1705177896853-2.8281092428927516e-18j)  Ecoul = (1.2322257255303877+2.642368488128301e-26j)  Exc = -3.304368400324712
cycle= 5 E= -10.7104979830951  delta_E= 6.81e-11  |g|= 4.08e-05  |ddm|= 6.75e-05
    CPU time for cycle= 5     19.30 sec, wall time      0.63 sec
HOMO = 0.575158683728  LUMO = 0.779852614118
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350535  0.56288721  0.57084126  0.57515868] [0.77985261 0.78421636 0.78980234 1.12763397 1.71163709 1.71181697
 2.38011145 2.38208564 2.38270123 2.45545705 2.45855793 2.45917901
 3.54243852 3.54543278 3.72496691 3.72637791 3.726739   4.61180416
 4.61344225 4.6150407  8.69813557 9.02875043]
   1 ( 0.000  0.000  0.500)   [-0.04881934  0.04506366  0.45214611  0.45936637] [0.91056686 0.91460114 0.93566546 1.29947429 1.6785309  1.86919797
 1.87083476 2.02140527 2.02290622 2.63460368 2.87107103 2.91118059
 2.91184975 2.95683814 2.95773857 3.25515924 3.59777124 3.59876417
 4.49641957 4.49742847 9.0418152  9.08663579]
   2 ( 0.000  0.500  0.000)   [-0.04881884  0.04506364  0.45214706  0.45936855] [0.91057    0.91460121 0.93566373 1.29947522 1.67853015 1.86919842
 1.87083507 2.02140595 2.02290437 2.63460438 2.871072   2.9111789
 2.911849   2.95683693 2.95773821 3.25515626 3.59777157 3.59876449
 4.49641664 4.49742666 9.04181565 9.08663735]
   3 ( 0.000  0.500  0.500)   [0.06128877 0.06327113 0.31615286 0.32366076] [0.80982032 0.82290549 1.23502407 1.23549309 1.68249606 1.68584696
 2.00023057 2.0008799  2.31105554 2.31285356 2.77193896 2.77286849
 2.96163418 2.96185869 3.00289695 3.00610709 3.4082212  3.40904133
 4.71672754 4.71834283 9.04134437 9.04181199]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      9.29 sec, wall time      0.31 sec
    CPU time for vj and vk      7.49 sec, wall time      0.24 sec
E1 = (4.170517766537635-2.8281341494150964e-18j)  Ecoul = (1.2322257602327666+5.689895937178114e-26j)  Exc = -3.304368411635504
Extra cycle  E= -10.7104979828512  delta_E= 2.44e-10  |g|= 7.46e-05  |ddm|= 0.000122
    CPU time for scf_cycle    145.09 sec, wall time      4.79 sec
    CPU time for SCF    148.70 sec, wall time      4.93 sec
converged SCF energy = -10.7104979828512
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-40.0/47995838/scf.h5
