SLURMD_NODENAME = hpc-21-27
Start time = Thu Mar 13 04:24:45 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-80.0/47995842/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-80.0/47995842/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  8.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.22657159]
 [ 0.          0.          0.45314317]
 ...
 [-0.26162237 -0.18499492 -0.90628634]
 [-0.26162237 -0.18499492 -0.67971476]
 [-0.26162237 -0.18499492 -0.45314317]], m0 = [21 21 21]
Pivoted Cholesky rank = 374, estimated error = 0.00e+00
Parent grid size = 9261, selected grid size = 520
    CPU time for interpolating functions     24.45 sec, wall time      4.48 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.37 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      6.38 sec, wall time      1.25 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    172.70 sec, wall time     17.73 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 307 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     82.85 sec, wall time      8.79 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 306 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    109.36 sec, wall time      9.89 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 306 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    116.23 sec, wall time     11.08 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 306 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-80.0/47995842/tmp88igeag3
    CPU time for building ISDF    492.47 sec, wall time     49.56 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-80.0/47995842/tmp1yqlenij
max_memory 81920 MB (current use 234 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f27c3b9fcd0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      9.81 sec, wall time      1.20 sec
    CPU time for vj and vk     11.60 sec, wall time      1.32 sec
E1 = (4.673183787659303+1.636522399104028e-17j)  Ecoul = (1.4764640721357722+2.331033469502186e-33j)  Exc = -3.3914851130041805
init E= -10.0507103511952
    CPU time for initialize scf     34.12 sec, wall time      4.24 sec
HOMO = 0.617029773342  LUMO = 0.80393414533
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655476  0.61115001  0.61138965  0.61702977] [0.80393415 0.80814545 0.81092457 1.13007076 1.73332809 1.7355599
 2.40667684 2.40722385 2.40800981 2.50110647 2.50172455 2.50205383
 3.56784243 3.56831899 3.76714393 3.76715783 3.76793637 4.64476503
 4.64490842 4.64502088 8.84194492 9.17011982]
   1 ( 0.000  0.000  0.500)   [-0.03769268  0.06166824  0.49459295  0.50130514] [0.93252225 0.93680209 0.94438512 1.33410044 1.72140003 1.90372395
 1.90506742 2.04477211 2.04669074 2.65773673 2.90262768 2.9542365
 2.95472568 2.98949084 2.99038326 3.28772013 3.62664601 3.62703227
 4.52706643 4.52716297 9.18283264 9.22709873]
   2 ( 0.000  0.500  0.000)   [-0.03769405  0.06167041  0.49459321  0.50130424] [0.93252055 0.93680106 0.94438654 1.33409989 1.72140021 1.90372623
 1.90506874 2.0447722  2.04669221 2.65774024 2.90262943 2.95423752
 2.95472434 2.98949153 2.99038534 3.28771275 3.62664528 3.6270301
 4.52706986 4.52716584 9.18283342 9.22709795]
   3 ( 0.000  0.500  0.500)   [0.07640046 0.07937488 0.34926158 0.36058303] [0.82049844 0.8289978  1.27130022 1.2717561  1.72863741 1.72939699
 2.03063402 2.03250387 2.33430226 2.33446003 2.81522255 2.81661378
 2.98770096 2.98878202 3.0348342  3.03570904 3.43441726 3.4350612
 4.75295488 4.75324236 9.18254852 9.18256222]
nelec by numeric integration = 7.999999999848207
    CPU time for vxc     14.80 sec, wall time      1.82 sec
    CPU time for vj and vk     10.33 sec, wall time      1.26 sec
E1 = (4.2050844424281495+4.951236481438957e-18j)  Ecoul = (1.184535961868357-4.353937906080984e-24j)  Exc = -3.2881846919189672
cycle= 1 E= -10.7074373856085  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     25.48 sec, wall time      3.13 sec
HOMO = 0.569685597112  LUMO = 0.774542925509
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823263  0.55648387  0.56494892  0.5696856 ] [0.77454293 0.77912642 0.78469457 1.11984281 1.70810269 1.70832705
 2.37427993 2.37655382 2.37739284 2.44836235 2.45168255 2.45230417
 3.53690019 3.54001579 3.71838117 3.71995485 3.72041403 4.60534558
 4.60715301 4.6087065  8.68226212 9.01323564]
   1 ( 0.000  0.000  0.500)   [-0.05413149  0.0417196   0.44622865  0.45411105] [0.90552368 0.90923735 0.92942062 1.29164622 1.672218   1.86345097
 1.86548675 2.01770039 2.01913964 2.63026611 2.86487494 2.9039259
 2.90479883 2.95101331 2.95202249 3.24883834 3.59221958 3.59323073
 4.49053629 4.4914593  9.02632762 9.07132242]
   2 ( 0.000  0.500  0.000)   [-0.05413174  0.04171947  0.44622578  0.45411208] [0.90552403 0.90923781 0.9294227  1.29164446 1.67221933 1.86345383
 1.86548796 2.01770046 2.01914001 2.63026966 2.86487863 2.9039277
 2.9047967  2.95101449 2.95202592 3.24883451 3.5922193  3.59322923
 4.49053993 4.49146066 9.02632747 9.07132077]
   3 ( 0.000  0.500  0.500)   [0.05607296 0.05914856 0.31089753 0.31917938] [0.80608441 0.81832543 1.22741893 1.22769971 1.67536598 1.67852609
 1.99604499 1.99673005 2.30682501 2.30902535 2.76485594 2.76597589
 2.95644728 2.95654351 2.99691452 3.00058455 3.40206907 3.40323558
 4.71035416 4.71232433 9.02590759 9.02633895]
nelec by numeric integration = 7.999999999846839
    CPU time for vxc     15.11 sec, wall time      1.91 sec
    CPU time for vj and vk     11.01 sec, wall time      1.34 sec
E1 = (4.165531074612843+4.85752742690089e-18j)  Ecoul = (1.2397192399508665-4.0818818679756035e-26j)  Exc = -3.3068215644815027
cycle= 2 E= -10.7104443479039  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     30.84 sec, wall time      3.87 sec
HOMO = 0.57529938661  LUMO = 0.779926433281
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343157  0.56307797  0.57102319  0.57529939] [0.77992643 0.78431536 0.78990255 1.12771766 1.71172074 1.71189654
 2.38021187 2.3821988  2.38283763 2.45568852 2.45874715 2.45938981
 3.54255178 3.54556051 3.72517235 3.72656229 3.72688941 4.61194105
 4.61360934 4.61519775 8.69868153 9.02928711]
   1 ( 0.000  0.000  0.500)   [-0.04875006  0.04515977  0.45231039  0.4595186 ] [0.91067528 0.91469478 0.93574763 1.29962556 1.67872619 1.86936448
 1.87099616 2.02146962 2.02300326 2.63471418 2.87121202 2.91135641
 2.91206627 2.95699407 2.95786116 3.25530465 3.59791738 3.59891248
 4.49657687 4.49757762 9.04235128 9.08717063]
   2 ( 0.000  0.500  0.000)   [-0.04875042  0.04515983  0.4523076   0.45951945] [0.91067557 0.91469531 0.93574968 1.29962389 1.67872748 1.8693674
 1.8709975  2.02146972 2.0230038  2.63471788 2.87121581 2.91135821
 2.91206407 2.95699528 2.95786448 3.25530084 3.59791712 3.59891094
 4.49658056 4.49757903 9.04235113 9.08716898]
   3 ( 0.000  0.500  0.500)   [0.06140908 0.06333803 0.316287   0.3237799 ] [0.80986877 0.82299589 1.23521635 1.23561326 1.68271515 1.68607926
 2.00033473 2.00101365 2.31115853 2.31294689 2.77210943 2.77308398
 2.9617962  2.96199309 3.00304986 3.00623173 3.40834931 3.4091495
 4.7168668  4.71852707 9.04188084 9.04234852]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc     14.07 sec, wall time      1.69 sec
    CPU time for vj and vk     11.63 sec, wall time      1.50 sec
E1 = (4.170644817795981+4.815009754357449e-18j)  Ecoul = (1.2320370114350427-4.278150461194591e-26j)  Exc = -3.3043118131707514
cycle= 3 E= -10.7105030819258  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     30.39 sec, wall time      3.77 sec
HOMO = 0.57515828092  LUMO = 0.779851922922
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350453  0.56288383  0.57084274  0.57515828] [0.77985192 0.7842117  0.7898066  1.12763585 1.71163915 1.71181752
 2.3801154  2.38208509 2.38270102 2.45545734 2.45855633 2.45917914
 3.5424391  3.54543239 3.72496728 3.72637558 3.72673761 4.61180881
 4.61344257 4.61503992 8.69813641 9.02875219]
   1 ( 0.000  0.000  0.500)   [-0.04881896  0.04506456  0.45214415  0.45936825] [0.91056373 0.91460113 0.93566342 1.29947625 1.67853093 1.86919902
 1.87083586 2.02140989 2.02290537 2.63460284 2.87107165 2.91117933
 2.91185126 2.95683636 2.95774233 3.25515857 3.59777017 3.59876526
 4.49641579 4.49742621 9.04181724 9.0866384 ]
   2 ( 0.000  0.500  0.000)   [-0.0488193   0.04506459  0.45214137  0.45936911] [0.91056405 0.91460168 0.93566549 1.29947456 1.67853221 1.86920193
 1.87083722 2.02140999 2.0229059  2.63460653 2.87107543 2.91118113
 2.91184906 2.95683758 2.95774566 3.25515475 3.59776991 3.59876373
 4.49641949 4.49742765 9.0418171  9.08663676]
   3 ( 0.000  0.500  0.500)   [0.06129001 0.06327398 0.31614834 0.32365885] [0.80982299 0.822904   1.2350214  1.23549433 1.68249866 1.68585082
 2.00023035 2.00088095 2.3110648  2.31285482 2.77194304 2.77286738
 2.96164464 2.96186255 3.00289537 3.00611079 3.4082206  3.4090447
 4.71674085 4.71834852 9.04134658 9.04181414]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     14.63 sec, wall time      1.88 sec
    CPU time for vj and vk     10.91 sec, wall time      1.27 sec
E1 = (4.170517392693658+4.8151114739953186e-18j)  Ecoul = (1.2322264555532578+3.2942831402029453e-26j)  Exc = -3.3043738765477446
cycle= 4 E= -10.7105031262869  delta_E= -4.44e-08  |g|= 1.41e-05  |ddm|= 0.000626
    CPU time for cycle= 4     30.07 sec, wall time      3.73 sec
HOMO = 0.575158119348  LUMO = 0.779851038941
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2635054   0.56288342  0.57084131  0.57515812] [0.77985104 0.78421178 0.78980546 1.12763485 1.71163866 1.71181686
 2.38011358 2.38208437 2.38270137 2.45545657 2.45855529 2.45917782
 3.54243845 3.54543149 3.724967   3.72637451 3.7267366  4.61180735
 4.61344225 4.61503891 8.69813497 9.02875078]
   1 ( 0.000  0.000  0.500)   [-0.0488199   0.04506374  0.45214384  0.45936757] [0.91056378 0.91460011 0.93566222 1.29947535 1.67852966 1.86919808
 1.87083546 2.02140829 2.02290533 2.63460136 2.87107057 2.91117811
 2.91185083 2.95683592 2.95774062 3.25515716 3.59776996 3.59876471
 4.49641552 4.49742539 9.04181591 9.08663691]
   2 ( 0.000  0.500  0.000)   [-0.04882025  0.04506378  0.45214106  0.45936842] [0.91056409 0.91460066 0.93566429 1.29947366 1.67853094 1.86920099
 1.87083682 2.02140839 2.02290587 2.63460506 2.87107435 2.91117992
 2.91184863 2.95683714 2.95774394 3.25515334 3.59776971 3.59876317
 4.49641923 4.49742683 9.04181576 9.08663527]
   3 ( 0.000  0.500  0.500)   [0.06128914 0.06327304 0.31614806 0.3236584 ] [0.80982187 0.8229031  1.23502134 1.23549356 1.68249643 1.68584956
 2.00022893 2.00088067 2.3110639  2.31285428 2.7719418  2.77286684
 2.96164425 2.96186091 3.00289526 3.00610963 3.40822047 3.40904346
 4.71673925 4.71834874 9.04134494 9.04181291]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     13.79 sec, wall time      1.65 sec
    CPU time for vj and vk     12.54 sec, wall time      1.23 sec
E1 = (4.17051708646976+4.81510777229392e-18j)  Ecoul = (1.2322269029558013+2.2971629560035864e-27j)  Exc = -3.3043740177085743
cycle= 5 E= -10.7105031262691  delta_E= 1.78e-11  |g|= 2.18e-05  |ddm|= 3.63e-05
    CPU time for cycle= 5     31.28 sec, wall time      3.51 sec
HOMO = 0.575158109837  LUMO = 0.779851032011
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350543  0.56288338  0.57084128  0.57515811] [0.77985103 0.78421174 0.78980543 1.12763481 1.71163864 1.71181684
 2.38011356 2.38208434 2.38270133 2.45545652 2.45855529 2.45917778
 3.54243842 3.54543146 3.72496696 3.72637447 3.72673659 4.61180732
 4.61344221 4.61503887 8.69813492 9.02875073]
   1 ( 0.000  0.000  0.500)   [-0.04881992  0.04506371  0.45214381  0.45936754] [0.91056374 0.91460008 0.93566221 1.29947532 1.67852964 1.86919804
 1.87083543 2.02140827 2.0229053  2.63460134 2.87107053 2.91117809
 2.91185078 2.95683589 2.9577406  3.25515714 3.59776993 3.59876468
 4.49641548 4.49742535 9.04181585 9.08663686]
   2 ( 0.000  0.500  0.000)   [-0.04882026  0.04506375  0.45214102  0.45936839] [0.91056405 0.91460063 0.93566428 1.29947364 1.67853092 1.86920095
 1.87083679 2.02140837 2.02290584 2.63460503 2.87107431 2.91117989
 2.91184858 2.95683712 2.95774393 3.25515332 3.59776967 3.59876314
 4.49641918 4.4974268  9.04181571 9.08663521]
   3 ( 0.000  0.500  0.500)   [0.06128912 0.063273   0.31614803 0.32365839] [0.80982183 0.82290308 1.23502128 1.23549356 1.68249637 1.68584951
 2.00022891 2.00088063 2.31106388 2.31285425 2.77194179 2.77286679
 2.96164423 2.96186087 3.00289524 3.00610961 3.40822044 3.40904342
 4.71673924 4.7183487  9.04134488 9.04181285]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc     14.82 sec, wall time      1.60 sec
    CPU time for vj and vk     10.50 sec, wall time      1.11 sec
E1 = (4.170517066802194+4.815096074382841e-18j)  Ecoul = (1.2322269323619506+2.530665783949006e-26j)  Exc = -3.3043740273773334
Extra cycle  E= -10.7105031261993  delta_E= 6.98e-11  |g|= 3.99e-05  |ddm|= 6.5e-05
    CPU time for scf_cycle    207.79 sec, wall time     24.98 sec
    CPU time for SCF    209.55 sec, wall time     25.23 sec
converged SCF energy = -10.7105031261993
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-80.0/47995842/scf.h5
