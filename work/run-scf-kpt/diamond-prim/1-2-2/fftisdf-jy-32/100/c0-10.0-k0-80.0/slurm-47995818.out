SLURMD_NODENAME = hpc-19-21
Start time = Thu Mar 13 04:24:28 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-80.0/47995818/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-80.0/47995818/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.00e+01
k0 =  8.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.22657159]
 [ 0.          0.          0.45314317]
 ...
 [-0.26162237 -0.18499492 -0.90628634]
 [-0.26162237 -0.18499492 -0.67971476]
 [-0.26162237 -0.18499492 -0.45314317]], m0 = [21 21 21]
Pivoted Cholesky rank = 374, estimated error = 2.92e-03
Parent grid size = 9261, selected grid size = 260
    CPU time for interpolating functions     24.98 sec, wall time      3.42 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 260, nao = 26, cisdf =  10.00
    CPU time for get interpolating vectors      0.34 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 2.02e-01 GB
    CPU time for aoR_loop: [      0,   12167]      9.15 sec, wall time      0.65 sec
eta_kpt.shape = (4, 12167, 260)
Memory used for eta_kpt = 2.02e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     21.40 sec, wall time      1.26 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     17.26 sec, wall time      1.03 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     19.44 sec, wall time      1.16 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel     20.57 sec, wall time      1.21 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 259 / 260
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-80.0/47995818/tmpnocis9xc
    CPU time for building ISDF     91.23 sec, wall time      5.50 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-80.0/47995818/tmptxp92bt3
max_memory 81920 MB (current use 234 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f1854e08be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.69 sec, wall time      0.49 sec
    CPU time for vj and vk      8.31 sec, wall time      0.47 sec
E1 = (4.673183787659304+5.868490673311982e-18j)  Ecoul = (1.4764640721357722+2.331033469502186e-33j)  Exc = -3.3914322280981692
init E= -10.0506574662892
    CPU time for initialize scf     26.36 sec, wall time      1.53 sec
HOMO = 0.617044333206  LUMO = 0.803863326695
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24652406  0.61115446  0.61140684  0.61704433] [0.80386333 0.80808445 0.81091061 1.13011431 1.73330678 1.73555236
 2.40664329 2.40720267 2.40800392 2.50105522 2.50167073 2.50205068
 3.56782567 3.56833194 3.76712842 3.76719399 3.76795291 4.64474794
 4.64493729 4.64498818 8.84194244 9.17011871]
   1 ( 0.000  0.000  0.500)   [-0.03767962  0.06171511  0.49455998  0.50130847] [0.93241889 0.93676446 0.9444437  1.33411685 1.72141985 1.90370064
 1.90505114 2.04477106 2.04669287 2.65777742 2.90261601 2.95421565
 2.95471853 2.98943648 2.99040531 3.28771571 3.62661552 3.62704647
 4.52699397 4.52720099 9.18283236 9.2270983 ]
   2 ( 0.000  0.500  0.000)   [-0.03769162  0.06169267  0.49461317  0.50129703] [0.93251651 0.93680987 0.94439762 1.33410046 1.72142655 1.90368533
 1.90505162 2.04477279 2.04670054 2.65772989 2.90263808 2.95420561
 2.95471991 2.98948007 2.99039612 3.28773419 3.62664677 3.6270243
 4.52705963 4.52719572 9.18283076 9.22710269]
   3 ( 0.000  0.500  0.500)   [0.07641179 0.07940126 0.3492458  0.36057272] [0.82052984 0.82905887 1.27130404 1.27176175 1.72863973 1.72940637
 2.03061671 2.03251604 2.33430457 2.33446377 2.81523273 2.81661632
 2.98770287 2.98880725 3.03483003 3.0357424  3.43438263 3.4350414
 4.75293935 4.75326619 9.18254908 9.18256205]
nelec by numeric integration = 7.999999999848209
    CPU time for vxc     12.59 sec, wall time      0.71 sec
    CPU time for vj and vk      9.31 sec, wall time      0.52 sec
E1 = (4.205088757199231+1.8241994353709643e-18j)  Ecoul = (1.1845321416090684+3.8527966610994217e-26j)  Exc = -3.2881533037124293
cycle= 1 E= -10.7074055028902  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     22.09 sec, wall time      1.24 sec
HOMO = 0.569694645709  LUMO = 0.774488625822
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2681953   0.55650956  0.56496544  0.56969465] [0.77448863 0.77909919 0.78464049 1.11987878 1.70811627 1.70833139
 2.37424241 2.3765218  2.37736972 2.44835333 2.45162564 2.45225356
 3.53690437 3.54004336 3.71840248 3.71997381 3.72043479 4.60533868
 4.60716909 4.6087122  8.68225549 9.01322981]
   1 ( 0.000  0.000  0.500)   [-0.05412989  0.04175609  0.44624129  0.45409647] [0.90544554 0.90915335 0.92948005 1.29166551 1.67224229 1.86341404
 1.86546405 2.01770095 2.01913186 2.63030161 2.86489282 2.90391332
 2.90479317 2.95105032 2.95199926 3.2488171  3.59220942 3.59326349
 4.49055939 4.49144675 9.0263228  9.07131828]
   2 ( 0.000  0.500  0.000)   [-0.05414438  0.0417245   0.44622727  0.4541398 ] [0.9055134  0.90923419 0.92943333 1.29163867 1.67225574 1.86341044
 1.86545033 2.01767674 2.01913498 2.63028662 2.86490684 2.90390838
 2.90479565 2.95104806 2.95204518 3.24883585 3.59222946 3.59322796
 4.49056408 4.49145949 9.0263206  9.07132096]
   3 ( 0.000  0.500  0.500)   [0.05607604 0.05914055 0.3108951  0.31916071] [0.80612761 0.81837875 1.22739717 1.22770827 1.67538117 1.67854969
 1.99601373 1.99674525 2.30684399 2.30904044 2.76486268 2.76596314
 2.95646858 2.95656612 2.99695551 3.00060438 3.40207671 3.40323093
 4.71034931 4.71233877 9.02590232 9.02633466]
nelec by numeric integration = 7.999999999846843
    CPU time for vxc     12.32 sec, wall time      0.69 sec
    CPU time for vj and vk      7.81 sec, wall time      0.45 sec
E1 = (4.1655413433837305+1.9256017184991835e-18j)  Ecoul = (1.2397020230837192+4.137417675703163e-26j)  Exc = -3.3067819706869734
cycle= 2 E= -10.7104117022056  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     23.61 sec, wall time      1.34 sec
HOMO = 0.575308504335  LUMO = 0.779872179802
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26339642  0.56310226  0.57103885  0.5753085 ] [0.77987218 0.78428692 0.78984896 1.12775321 1.71173136 1.71189886
 2.38017444 2.38216628 2.38281445 2.45567791 2.4586904  2.45933927
 3.54255516 3.54558661 3.72519123 3.7265778  3.72690918 4.61193405
 4.61362383 4.61520206 8.69867276 9.0292792 ]
   1 ( 0.000  0.000  0.500)   [-0.04874878  0.04519442  0.45232154  0.45950414] [0.91059739 0.9146116  0.935806   1.29964246 1.67874803 1.86932684
 1.87097225 2.0214696  2.0229942  2.63474806 2.87122739 2.91134285
 2.91205954 2.95702979 2.95783703 3.25528423 3.5979073  3.59894447
 4.49659998 4.49756488 9.04234435 9.0871639 ]
   2 ( 0.000  0.500  0.000)   [-0.04876436  0.04516577  0.45230783  0.45954534] [0.91066315 0.91469019 0.9357589  1.29961774 1.67876216 1.86932443
 1.87095885 2.0214479  2.02299844 2.63473216 2.87124226 2.91133776
 2.91206078 2.95702623 2.9578804  3.25530204 3.59792623 3.59890868
 4.49660335 4.49757667 9.04234217 9.08716693]
   3 ( 0.000  0.500  0.500)   [0.06141036 0.0633313  0.31628364 0.32376096] [0.80991089 0.82304608 1.23519295 1.23561968 1.68272799 1.68609982
 2.00030394 2.00102769 2.31117495 2.31296049 2.77211412 2.77307016
 2.96181799 2.96201215 3.00308731 3.00625076 3.40835424 3.4091437
 4.71685875 4.71854044 9.04187296 9.04234236]
nelec by numeric integration = 7.999999999847137
    CPU time for vxc     12.93 sec, wall time      0.78 sec
    CPU time for vj and vk      7.58 sec, wall time      0.44 sec
E1 = (4.170654284107685+1.872668912020869e-18j)  Ecoul = (1.232021284159213-3.324575398963432e-26j)  Exc = -3.3042728813248647
cycle= 3 E= -10.710470411044  delta_E= -5.87e-05  |g|= 0.000976  |ddm|= 0.0247
    CPU time for cycle= 3     24.41 sec, wall time      1.44 sec
HOMO = 0.575167374714  LUMO = 0.779797608552
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26346944  0.56290797  0.57085838  0.57516737] [0.77979761 0.78418309 0.78975298 1.12767131 1.71164986 1.71181978
 2.38007775 2.38205233 2.38267776 2.45544659 2.45849937 2.45912854
 3.54244241 3.54545842 3.72498592 3.72639116 3.72675716 4.61180174
 4.61345696 4.61504415 8.69812754 9.02874418]
   1 ( 0.000  0.000  0.500)   [-0.048818    0.04509945  0.45215523  0.45935362] [0.91048556 0.91451774 0.93572179 1.29949323 1.67855279 1.86916138
 1.87081185 2.02140973 2.02289635 2.63463681 2.87108705 2.91116565
 2.91184442 2.9568718  2.95771807 3.2551379  3.59776    3.59879717
 4.49643877 4.4974134  9.0418102  9.0866316 ]
   2 ( 0.000  0.500  0.000)   [-0.04883319  0.04507021  0.4521414   0.45939512] [0.91055167 0.91459659 0.93567456 1.29946815 1.67856672 1.8691588
 1.87079854 2.02138797 2.02290029 2.6346208  2.87110157 2.91116069
 2.91184565 2.95686832 2.95776174 3.2551559  3.59777902 3.5987614
 4.49644213 4.49742521 9.04180804 9.08663457]
   3 ( 0.000  0.500  0.500)   [0.0612911  0.06326713 0.31614485 0.32363976] [0.80986503 0.82295399 1.23499792 1.2355005  1.68251141 1.6858712
 2.00019939 2.00089488 2.3110812  2.31286831 2.77194751 2.77285347
 2.96166639 2.96188157 3.00293261 3.00612984 3.40822545 3.40903883
 4.71673269 4.71836175 9.04133887 9.04180758]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc     13.27 sec, wall time      0.77 sec
    CPU time for vj and vk      8.36 sec, wall time      0.52 sec
E1 = (4.170526848612202+1.873046372081168e-18j)  Ecoul = (1.232210728746291-1.8270018564918633e-26j)  Exc = -3.304334934322122
cycle= 4 E= -10.7104704549497  delta_E= -4.39e-08  |g|= 0.000108  |ddm|= 0.000651
    CPU time for cycle= 4     25.92 sec, wall time      1.53 sec
HOMO = 0.575167235664  LUMO = 0.779796907815
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347013  0.56290763  0.57085725  0.57516724] [0.77979691 0.78418315 0.78975207 1.12767052 1.71164947 1.71181926
 2.38007631 2.38205176 2.38267802 2.45544598 2.45849854 2.45912749
 3.54244189 3.54545771 3.72498568 3.7263903  3.72675635 4.61180058
 4.6134567  4.61504334 8.69812637 9.02874304]
   1 ( 0.000  0.000  0.500)   [-0.04881872  0.04509876  0.45215497  0.45935309] [0.91048561 0.91451694 0.93572085 1.29949249 1.67855177 1.86916061
 1.87081153 2.02140846 2.02289629 2.63463564 2.87108617 2.91116468
 2.91184409 2.95687146 2.95771674 3.2551368  3.59775984 3.59879672
 4.49643856 4.49741275 9.04180911 9.08663039]
   2 ( 0.000  0.500  0.000)   [-0.04883396  0.04506961  0.45214116  0.45939455] [0.91055166 0.91459576 0.93567361 1.29946746 1.67856573 1.86915807
 1.87079821 2.02138671 2.02290027 2.63461964 2.87110073 2.91115972
 2.91184529 2.95686796 2.95776035 3.25515477 3.59777885 3.59876096
 4.49644191 4.49742456 9.04180695 9.08663337]
   3 ( 0.000  0.500  0.500)   [0.06129042 0.06326638 0.31614463 0.3236394 ] [0.80986414 0.82295328 1.23499786 1.23549989 1.68250965 1.68587019
 2.00019827 2.00089465 2.3110804  2.31286797 2.77194652 2.77285303
 2.96166609 2.96188027 3.00293252 3.00612892 3.40822536 3.40903783
 4.71673143 4.71836191 9.04133681 9.04180732]
nelec by numeric integration = 7.999999999847134
    CPU time for vxc     12.82 sec, wall time      0.75 sec
    CPU time for vj and vk      8.27 sec, wall time      0.47 sec
E1 = (4.170526598007689+1.8734511655028786e-18j)  Ecoul = (1.2322110947358882+4.695300107875462e-27j)  Exc = -3.304335049393192
cycle= 5 E= -10.7104704546357  delta_E= 3.14e-10  |g|= 0.000129  |ddm|= 0.000249
    CPU time for cycle= 5     24.52 sec, wall time      1.42 sec
HOMO = 0.575167202241  LUMO = 0.779796718805
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347032  0.56290754  0.57085693  0.5751672 ] [0.77979672 0.78418315 0.78975182 1.1276703  1.71164936 1.71181911
 2.38007591 2.3820516  2.38267809 2.4554458  2.45849832 2.4591272
 3.54244174 3.54545751 3.72498562 3.72639006 3.72675613 4.61180026
 4.61345662 4.61504311 8.69812606 9.02874273]
   1 ( 0.000  0.000  0.500)   [-0.04881893  0.04509857  0.4521549   0.45935295] [0.91048561 0.91451672 0.93572059 1.29949229 1.6785515  1.8691604
 1.87081144 2.02140811 2.02289627 2.63463532 2.87108592 2.91116442
 2.91184399 2.95687136 2.95771637 3.2551365  3.59775979 3.5987966
 4.49643849 4.49741256 9.04180882 9.08663006]
   2 ( 0.000  0.500  0.000)   [-0.04883417  0.04506943  0.45214108  0.45939439] [0.91055166 0.91459553 0.93567335 1.29946727 1.67856546 1.86915786
 1.87079812 2.02138637 2.02290026 2.63461931 2.87110049 2.91115945
 2.91184519 2.95686786 2.95775997 3.25515446 3.5977788  3.59876083
 4.49644185 4.49742438 9.04180667 9.08663304]
   3 ( 0.000  0.500  0.500)   [0.06129023 0.06326617 0.31614456 0.3236393 ] [0.80986389 0.82295308 1.23499783 1.23549973 1.68250915 1.68586991
 2.00019796 2.00089458 2.31108026 2.31286779 2.77194626 2.7728529
 2.961666   2.9618799  3.00293249 3.00612866 3.40822532 3.40903756
 4.71673108 4.71836195 9.04133715 9.04180635]
nelec by numeric integration = 7.9999999998471365
    CPU time for vxc     13.36 sec, wall time      0.69 sec
    CPU time for vj and vk      8.10 sec, wall time      0.42 sec
E1 = (4.170526530121081+1.8732225921720666e-18j)  Ecoul = (1.232211193190497+7.964339699111335e-27j)  Exc = -3.3043350809989462
cycle= 6 E= -10.7104704556735  delta_E= -1.04e-09  |g|= 1.92e-06  |ddm|= 0.000136
    CPU time for cycle= 6     24.71 sec, wall time      1.29 sec
HOMO = 0.575167198857  LUMO = 0.779796715748
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347034  0.56290751  0.57085691  0.5751672 ] [0.77979672 0.78418313 0.7897518  1.12767028 1.71164935 1.7118191
 2.3800759  2.38205158 2.38267806 2.45544577 2.45849832 2.45912717
 3.54244172 3.54545749 3.72498559 3.72639004 3.72675613 4.61180025
 4.6134566  4.61504309 8.69812603 9.0287427 ]
   1 ( 0.000  0.000  0.500)   [-0.04881894  0.04509856  0.45215487  0.45935293] [0.91048559 0.9145167  0.93572058 1.29949228 1.67855149 1.86916038
 1.87081142 2.0214081  2.02289626 2.6346353  2.8710859  2.91116441
 2.91184395 2.95687134 2.95771636 3.25513649 3.59775977 3.59879658
 4.49643846 4.49741254 9.04180879 9.08663003]
   2 ( 0.000  0.500  0.000)   [-0.04883418  0.04506941  0.45214106  0.45939438] [0.91055164 0.91459552 0.93567334 1.29946725 1.67856545 1.86915783
 1.8707981  2.02138636 2.02290024 2.6346193  2.87110047 2.91115944
 2.91184516 2.95686785 2.95775997 3.25515446 3.59777878 3.59876081
 4.49644182 4.49742436 9.04180664 9.08663301]
   3 ( 0.000  0.500  0.500)   [0.06129022 0.06326615 0.31614454 0.32363929] [0.80986387 0.82295307 1.2349978  1.23549973 1.68250912 1.68586988
 2.00019795 2.00089456 2.31108025 2.31286777 2.77194625 2.77285287
 2.96166598 2.96187989 3.00293247 3.00612865 3.4082253  3.40903754
 4.71673108 4.71836192 9.04133712 9.04180632]
nelec by numeric integration = 7.999999999847135
    CPU time for vxc     13.86 sec, wall time      0.68 sec
    CPU time for vj and vk      7.86 sec, wall time      0.39 sec
E1 = (4.17052651849032+1.8732262448883586e-18j)  Ecoul = (1.2322112104615428+5.371827220193002e-26j)  Exc = -3.304335086639407
Extra cycle  E= -10.7104704556736  delta_E= -1.76e-13  |g|= 1.21e-06  |ddm|= 3.38e-06
    CPU time for scf_cycle    193.42 sec, wall time     10.86 sec
    CPU time for SCF    195.85 sec, wall time     11.01 sec
converged SCF energy = -10.7104704556736
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-80.0/47995818/scf.h5
