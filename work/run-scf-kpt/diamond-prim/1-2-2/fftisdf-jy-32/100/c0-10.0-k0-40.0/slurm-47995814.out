SLURMD_NODENAME = hpc-19-16
Start time = Thu Mar 13 04:24:26 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-40.0/47995814/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-40.0/47995814/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.00e+01
k0 =  4.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.31720022]
 [ 0.          0.          0.63440044]
 ...
 [-0.36627131 -0.25899289 -1.26880088]
 [-0.36627131 -0.25899289 -0.95160066]
 [-0.36627131 -0.25899289 -0.63440044]], m0 = [15 15 15]
Pivoted Cholesky rank = 369, estimated error = 3.03e-03
Parent grid size = 3375, selected grid size = 260
    CPU time for interpolating functions     10.12 sec, wall time      0.61 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 260, nao = 26, cisdf =  10.00
    CPU time for get interpolating vectors      0.18 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 2.02e-01 GB
    CPU time for aoR_loop: [      0,   12167]     13.97 sec, wall time      0.57 sec
eta_kpt.shape = (4, 12167, 260)
Memory used for eta_kpt = 2.02e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      9.12 sec, wall time      0.34 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      8.19 sec, wall time      0.31 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      7.98 sec, wall time      0.29 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 260, nip = 260, max_memory = 8.17e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      7.52 sec, wall time      0.27 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 259 / 260
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-40.0/47995814/tmpih0guvzj
    CPU time for building ISDF     51.34 sec, wall time      1.93 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-40.0/47995814/tmppdfcvoc9
max_memory 81920 MB (current use 272 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f9155d74cd0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.26 sec, wall time      0.26 sec
    CPU time for vj and vk      6.61 sec, wall time      0.21 sec
E1 = (4.673183787659303+1.1857981154321286e-17j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.3914436638856387
init E= -10.0506689020766
    CPU time for initialize scf     22.71 sec, wall time      0.77 sec
HOMO = 0.617061936659  LUMO = 0.803902714371
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24652725  0.61115676  0.61138249  0.61706194] [0.80390271 0.80808702 0.81091762 1.13011035 1.73328837 1.73554638
 2.40666919 2.40719539 2.40801083 2.50108776 2.50166355 2.50204769
 3.56784189 3.56833065 3.76716152 3.76717063 3.76796572 4.64470808
 4.64488187 4.64497496 8.84194484 9.17011562]
   1 ( 0.000  0.000  0.500)   [-0.03769194  0.06169449  0.49460224  0.50132355] [0.9324136  0.93678188 0.94440919 1.33411628 1.72142293 1.90367488
 1.90505432 2.04478612 2.04668509 2.65776224 2.90262592 2.95423151
 2.95471773 2.98947678 2.99040896 3.28771859 3.62662948 3.62707078
 4.52696714 4.52714623 9.18282867 9.22710107]
   2 ( 0.000  0.500  0.000)   [-0.0377141   0.0617259   0.49456315  0.5013099 ] [0.93249237 0.93680831 0.94445093 1.33411699 1.72141691 1.90369433
 1.90505218 2.04478312 2.04671378 2.6577798  2.90259361 2.95422076
 2.95472639 2.98946885 2.99041319 3.28769284 3.62663882 3.62703044
 4.52702874 4.52713931 9.18283    9.22709839]
   3 ( 0.000  0.500  0.500)   [0.0763842  0.07941966 0.34922196 0.3605771 ] [0.82053451 0.82907806 1.27131141 1.27178904 1.72863764 1.72938697
 2.03064099 2.03251299 2.334301   2.33446587 2.81521977 2.81662257
 2.98771426 2.98880087 3.03485527 3.03573419 3.43438327 3.4350439
 4.75289576 4.75324089 9.18254725 9.18256365]
nelec by numeric integration = 7.999999999848205
    CPU time for vxc      9.12 sec, wall time      0.30 sec
    CPU time for vj and vk      6.79 sec, wall time      0.22 sec
E1 = (4.205071684383765+1.8423747478646844e-18j)  Ecoul = (1.1845558072698146-1.3820843059472127e-26j)  Exc = -3.2881654077855336
cycle= 1 E= -10.707411014118  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     16.13 sec, wall time      0.53 sec
HOMO = 0.569676902538  LUMO = 0.77454039177
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2681965   0.55654822  0.56495146  0.5696769 ] [0.77454039 0.7791242  0.78466423 1.11985954 1.7080895  1.70831461
 2.37425098 2.37651492 2.37737877 2.4483518  2.45165955 2.45225538
 3.53690764 3.54002442 3.7184385  3.71998569 3.72044297 4.60530548
 4.60713202 4.60868413 8.68226316 9.01323049]
   1 ( 0.000  0.000  0.500)   [-0.05414257  0.04172209  0.44627888  0.4541239 ] [0.90549067 0.9091645  0.92944237 1.29166086 1.67224999 1.8634217
 1.86542708 2.01770022 2.01912626 2.6303142  2.86487963 2.90392398
 2.90479963 2.95106268 2.95205905 3.24883426 3.59222953 3.59326761
 4.4905044  4.49137734 9.02632485 9.07132299]
   2 ( 0.000  0.500  0.000)   [-0.05416296  0.04176055  0.44625577  0.45409159] [0.90552294 0.90921195 0.92948779 1.29166449 1.67225298 1.86342436
 1.86543217 2.01770363 2.01915483 2.63034333 2.86486207 2.90392143
 2.90479978 2.9510837  2.9520271  3.24879358 3.59223007 3.59323604
 4.49050127 4.49143642 9.02632644 9.07132103]
   3 ( 0.000  0.500  0.500)   [0.05605226 0.05915713 0.31091334 0.31914932] [0.80613506 0.8183965  1.22746349 1.22771692 1.67537551 1.6785349
 1.99604667 1.99675204 2.30683797 2.30903145 2.76485097 2.76597101
 2.9564843  2.95654743 2.99695859 3.00061416 3.40207421 3.40322806
 4.71032643 4.71230954 9.02590503 9.02634214]
nelec by numeric integration = 7.999999999846841
    CPU time for vxc      8.25 sec, wall time      0.26 sec
    CPU time for vj and vk      6.20 sec, wall time      0.20 sec
E1 = (4.165523720414605+1.7320946740534695e-18j)  Ecoul = (1.2397305346660679-1.9607295571449293e-25j)  Exc = -3.3067982879129842
cycle= 2 E= -10.7104171308184  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     17.28 sec, wall time      0.55 sec
HOMO = 0.575291676828  LUMO = 0.779924389369
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2633975   0.56314085  0.57102511  0.57529168] [0.77992439 0.78431234 0.7898725  1.12773361 1.71170585 1.71188231
 2.38018315 2.38216033 2.38282354 2.45567764 2.45872393 2.45934162
 3.54255908 3.54556861 3.72522399 3.72659127 3.72691734 4.61189967
 4.61358576 4.61517354 8.69868256 9.02928198]
   1 ( 0.000  0.000  0.500)   [-0.04876247  0.04516235  0.45235898  0.45953088] [0.91064079 0.91462214 0.93576844 1.29963987 1.67875679 1.86933615
 1.87093697 2.02146945 2.02298865 2.6347606  2.87121606 2.91135425
 2.9120657  2.95704189 2.95789649 3.25529923 3.59792735 3.5989469
 4.49654446 4.49749579 9.04234851 9.08717103]
   2 ( 0.000  0.500  0.000)   [-0.04878216  0.04520024  0.45233572  0.45949864] [0.91067354 0.91466926 0.93581403 1.29964281 1.67875883 1.86933815
 1.8709417  2.02147299 2.02301768 2.63478874 2.87119805 2.91135158
 2.91206671 2.957061   2.95786498 3.25526029 3.59792743 3.59891721
 4.49654097 4.4975546  9.04234998 9.08716873]
   3 ( 0.000  0.500  0.500)   [0.06138663 0.06334721 0.31630171 0.32374976] [0.80991757 0.82306379 1.23525905 1.23562835 1.68272375 1.68608531
 2.00033577 2.0010341  2.31117067 2.31295162 2.77210406 2.77307895
 2.96179873 2.96202859 3.00308852 3.00626059 3.40835231 3.40914206
 4.71683721 4.71850855 9.04187818 9.04235143]
nelec by numeric integration = 7.999999999847135
    CPU time for vxc      9.03 sec, wall time      0.29 sec
    CPU time for vj and vk      6.42 sec, wall time      0.21 sec
E1 = (4.17063688569012+1.700363726064522e-18j)  Ecoul = (1.232048838146005+1.3836620277576547e-25j)  Exc = -3.3042884807406185
cycle= 3 E= -10.7104758548906  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3     18.31 sec, wall time      0.60 sec
HOMO = 0.575150742825  LUMO = 0.779849831443
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347049  0.56294662  0.57084463  0.57515074] [0.77984983 0.78420861 0.78977653 1.12765177 1.71162447 1.71180327
 2.38008651 2.38204654 2.3826869  2.45544643 2.45853303 2.45913099
 3.54244641 3.54544045 3.72501881 3.72640456 3.72676563 4.61176755
 4.61341901 4.61501576 8.69813769 9.0287473 ]
   1 ( 0.000  0.000  0.500)   [-0.04883148  0.04506717  0.45219267  0.45938061] [0.91052921 0.91452848 0.93568418 1.29949057 1.6785616  1.86917064
 1.87077677 2.02140968 2.02289064 2.6346494  2.87107564 2.91117725
 2.91185072 2.95688401 2.95777784 3.25515306 3.59778019 3.59879962
 4.49638335 4.49734446 9.0418147  9.08663904]
   2 ( 0.000  0.500  0.000)   [-0.04885119  0.0451051   0.45216943  0.45934833] [0.9105619  0.91457544 0.9357297  1.2994936  1.67856367 1.86917266
 1.87078137 2.02141326 2.02291974 2.63467748 2.87105768 2.9111745
 2.91185176 2.95690313 2.95774629 3.25511412 3.59778018 3.59876996
 4.49637988 4.49740325 9.04181616 9.08663671]
   3 ( 0.000  0.500  0.500)   [0.06126739 0.06328305 0.31616299 0.32362877] [0.8098718  0.82297172 1.23506438 1.23550898 1.68250725 1.68585688
 2.00023127 2.00090132 2.31107684 2.31285958 2.77193762 2.77286236
 2.96164719 2.96189812 3.00293387 3.00613972 3.4082236  3.40903725
 4.71671133 4.7183299  9.04134381 9.04181756]
nelec by numeric integration = 7.999999999847134
    CPU time for vxc      8.49 sec, wall time      0.27 sec
    CPU time for vj and vk      6.86 sec, wall time      0.22 sec
E1 = (4.170509542319183+1.7006759204814448e-18j)  Ecoul = (1.2322381572079177+7.488498801082021e-26j)  Exc = -3.3043505003958797
cycle= 4 E= -10.7104758988549  delta_E= -4.4e-08  |g|= 9.24e-05  |ddm|= 0.000644
    CPU time for cycle= 4     18.25 sec, wall time      0.59 sec
HOMO = 0.575150589704  LUMO = 0.779849098916
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347121  0.56294628  0.57084344  0.57515059] [0.7798491  0.78420867 0.78977558 1.12765094 1.71162407 1.71180272
 2.380085   2.38204594 2.38268718 2.45544579 2.45853215 2.45912989
 3.54244586 3.54543971 3.72501856 3.72640366 3.72676478 4.61176633
 4.61341874 4.61501491 8.69813647 9.02874611]
   1 ( 0.000  0.000  0.500)   [-0.04883225  0.04506649  0.45219241  0.45938004] [0.91052924 0.91452763 0.9356832  1.29948981 1.67856054 1.86916986
 1.87077643 2.02140835 2.02289061 2.63464818 2.87107473 2.91117623
 2.91185036 2.95688364 2.95777641 3.2551519  3.59778002 3.59879916
 4.49638313 4.49734378 9.04181357 9.08663778]
   2 ( 0.000  0.500  0.000)   [-0.04885197  0.04510441  0.45216917  0.45934775] [0.91056193 0.91457459 0.93572871 1.29949285 1.67856262 1.86917188
 1.87078103 2.02141193 2.02291971 2.63467625 2.87105678 2.9111735
 2.91185139 2.95690277 2.95774486 3.25511295 3.59778    3.5987695
 4.49637965 4.49740256 9.04181503 9.08663545]
   3 ( 0.000  0.500  0.500)   [0.06126666 0.06328227 0.31616276 0.32362839] [0.80987086 0.82297098 1.23506432 1.23550834 1.68250545 1.68585578
 2.00023009 2.00090108 2.31107617 2.31285905 2.77193658 2.7728619
 2.96164689 2.96189674 3.00293378 3.00613874 3.40822349 3.40903622
 4.71671001 4.71833007 9.0413426  9.04181635]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      9.13 sec, wall time      0.29 sec
    CPU time for vj and vk      7.53 sec, wall time      0.26 sec
E1 = (4.170509282620648+1.7004574677059322e-18j)  Ecoul = (1.232238539369173+6.962170805118562e-26j)  Exc = -3.304350622468673
cycle= 5 E= -10.7104758984649  delta_E= 3.9e-10  |g|= 0.000122  |ddm|= 0.000225
    CPU time for cycle= 5     18.26 sec, wall time      0.60 sec
HOMO = 0.575150561854  LUMO = 0.77984894406
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347137  0.5629462   0.57084318  0.57515056] [0.77984894 0.78420867 0.78977537 1.12765075 1.71162398 1.7118026
 2.38008468 2.38204581 2.38268723 2.45544565 2.45853198 2.45912965
 3.54244574 3.54543955 3.72501851 3.72640347 3.72676461 4.61176607
 4.61341868 4.61501473 8.69813621 9.02874586]
   1 ( 0.000  0.000  0.500)   [-0.04883242  0.04506633  0.45219235  0.45937991] [0.91052924 0.91452744 0.93568298 1.29948965 1.67856032 1.86916968
 1.87077635 2.02140806 2.02289059 2.63464791 2.87107453 2.91117602
 2.91185027 2.95688357 2.95777611 3.25515165 3.59777997 3.59879905
 4.49638307 4.49734363 9.04181334 9.08663751]
   2 ( 0.000  0.500  0.000)   [-0.04885214  0.04510426  0.45216911  0.45934762] [0.91056192 0.9145744  0.9357285  1.29949269 1.67856239 1.86917171
 1.87078096 2.02141164 2.0229197  2.63467599 2.87105658 2.91117328
 2.91185131 2.95690269 2.95774456 3.25511271 3.59777996 3.5987694
 4.4963796  4.49740241 9.04181479 9.08663518]
   3 ( 0.000  0.500  0.500)   [0.06126652 0.06328209 0.31616271 0.32362831] [0.80987065 0.82297082 1.23506429 1.23550821 1.68250502 1.68585558
 2.00022983 2.00090102 2.31107597 2.31285898 2.77193636 2.7728618
 2.96164681 2.96189645 3.00293375 3.00613853 3.40822346 3.40903599
 4.71670973 4.7183301  9.04134245 9.04181599]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      8.70 sec, wall time      0.29 sec
    CPU time for vj and vk      9.24 sec, wall time      0.30 sec
E1 = (4.170509225318817+1.7005700771583904e-18j)  Ecoul = (1.2322386210180152-4.911763540268108e-26j)  Exc = -3.304350647738845
cycle= 6 E= -10.7104758993881  delta_E= -9.23e-10  |g|= 1.08e-06  |ddm|= 0.000128
    CPU time for cycle= 6     20.73 sec, wall time      0.67 sec
HOMO = 0.575150559787  LUMO = 0.779848941838
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347138  0.56294617  0.57084316  0.57515056] [0.77984894 0.78420865 0.78977536 1.12765073 1.71162397 1.71180259
 2.38008467 2.38204579 2.38268721 2.45544562 2.45853198 2.45912963
 3.54244573 3.54543953 3.72501848 3.72640345 3.72676461 4.61176606
 4.61341865 4.61501471 8.69813618 9.02874583]
   1 ( 0.000  0.000  0.500)   [-0.04883243  0.04506632  0.45219232  0.4593799 ] [0.91052922 0.91452743 0.93568297 1.29948964 1.67856031 1.86916966
 1.87077633 2.02140806 2.02289057 2.6346479  2.87107451 2.911176
 2.91185024 2.95688355 2.9577761  3.25515164 3.59777995 3.59879903
 4.49638304 4.49734361 9.04181331 9.08663748]
   2 ( 0.000  0.500  0.000)   [-0.04885215  0.04510425  0.45216909  0.45934761] [0.9105619  0.91457439 0.93572849 1.29949268 1.67856238 1.86917169
 1.87078094 2.02141164 2.02291968 2.63467598 2.87105656 2.91117327
 2.91185128 2.95690267 2.95774455 3.2551127  3.59777993 3.59876938
 4.49637957 4.49740239 9.04181476 9.08663515]
   3 ( 0.000  0.500  0.500)   [0.06126651 0.06328207 0.31616269 0.3236283 ] [0.80987063 0.82297081 1.23506426 1.23550822 1.68250499 1.68585555
 2.00022983 2.000901   2.31107596 2.31285897 2.77193636 2.77286177
 2.96164679 2.96189644 3.00293374 3.00613852 3.40822344 3.40903597
 4.71670972 4.71833007 9.04134242 9.04181596]
nelec by numeric integration = 7.999999999847136
    CPU time for vxc      9.19 sec, wall time      0.29 sec
    CPU time for vj and vk      5.86 sec, wall time      0.19 sec
E1 = (4.170509214231537+1.7005688060952128e-18j)  Ecoul = (1.2322386375052254-4.3507256644749243e-26j)  Exc = -3.3043506531388336
Extra cycle  E= -10.7104758993882  delta_E= -5.68e-14  |g|= 6.93e-07  |ddm|= 1.87e-06
    CPU time for scf_cycle    146.92 sec, wall time      4.80 sec
    CPU time for SCF    150.76 sec, wall time      4.92 sec
converged SCF energy = -10.7104758993882
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-10.0-k0-40.0/47995814/scf.h5
