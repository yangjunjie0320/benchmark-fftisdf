SLURMD_NODENAME = hpc-34-24
Start time = Thu Mar 13 04:24:36 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-40.0/47995826/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-40.0/47995826/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  4.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.31720022]
 [ 0.          0.          0.63440044]
 ...
 [-0.36627131 -0.25899289 -1.26880088]
 [-0.36627131 -0.25899289 -0.95160066]
 [-0.36627131 -0.25899289 -0.63440044]], m0 = [15 15 15]
Pivoted Cholesky rank = 369, estimated error = 0.00e+00
Parent grid size = 3375, selected grid size = 390
    CPU time for interpolating functions     10.62 sec, wall time      0.52 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.30 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]     12.40 sec, wall time      0.76 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     29.15 sec, wall time      1.29 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 334 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     29.44 sec, wall time      1.27 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     31.26 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     30.86 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 333 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-40.0/47995826/tmp9qa_wd1g
    CPU time for building ISDF    138.85 sec, wall time      6.25 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-40.0/47995826/tmpfrztmq_1
max_memory 81920 MB (current use 302 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f2b03048cd0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc     10.94 sec, wall time      0.45 sec
    CPU time for vj and vk      9.30 sec, wall time      0.40 sec
E1 = (4.673183787659305+6.170990192554953e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.391483441818104
init E= -10.0507086800091
    CPU time for initialize scf     31.18 sec, wall time      1.32 sec
HOMO = 0.61703113123  LUMO = 0.803942616122
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655459  0.61115271  0.61138646  0.61703113] [0.80394262 0.80814515 0.81093119 1.13006312 1.73332684 1.73556021
 2.40667305 2.40722438 2.40801467 2.50110814 2.50172789 2.50205544
 3.56784222 3.56831593 3.7671439  3.76716364 3.76793569 4.64475695
 4.64490735 4.6450206  8.84194629 9.17011934]
   1 ( 0.000  0.000  0.500)   [-0.03769131  0.06167082  0.49459245  0.50130822] [0.93252398 0.93680473 0.94438611 1.33409723 1.72140064 1.90372309
 1.90507023 2.04477654 2.04669518 2.65773378 2.90263099 2.9542389
 2.95472609 2.98948783 2.99038331 3.28770726 3.62664768 3.62702915
 4.52706295 4.52717218 9.18283395 9.22709812]
   2 ( 0.000  0.500  0.000)   [-0.03769319  0.06167061  0.4945956   0.50130891] [0.93252459 0.93681026 0.94438062 1.33410252 1.72139561 1.90372604
 1.9050664  2.04477185 2.04669203 2.65773851 2.90262044 2.95424052
 2.954727   2.98948928 2.99038628 3.28771448 3.62664087 3.6270316
 4.52706198 4.52716728 9.18283214 9.22709989]
   3 ( 0.000  0.500  0.500)   [0.07640282 0.07937705 0.34926123 0.36058705] [0.82049522 0.82899965 1.27130085 1.27175863 1.72863828 1.72939226
 2.03063211 2.03250511 2.33430228 2.33445488 2.81522128 2.81661649
 2.98769466 2.98877816 3.03483353 3.03571265 3.43441226 3.43506178
 4.75294729 4.75325162 9.18254918 9.1825617 ]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc     15.96 sec, wall time      0.65 sec
    CPU time for vj and vk      9.64 sec, wall time      0.40 sec
E1 = (4.20508289072925+7.086430762279975e-19j)  Ecoul = (1.184538700160074-7.3101531276296545e-25j)  Exc = -3.2881808468409344
cycle= 1 E= -10.7074323539377  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     25.77 sec, wall time      1.06 sec
HOMO = 0.569683585393  LUMO = 0.774550808514
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823045  0.55648547  0.56495215  0.56968359] [0.77455081 0.77913934 0.78469243 1.11984099 1.70810096 1.70833102
 2.37427619 2.37655551 2.37739492 2.44836527 2.45168617 2.45230344
 3.53690259 3.5400159  3.71838362 3.71996178 3.72041935 4.60534154
 4.60715155 4.60870642 8.68226375 9.01323651]
   1 ( 0.000  0.000  0.500)   [-0.0541303   0.04172066  0.4462303   0.45410855] [0.90553015 0.90924061 0.92942433 1.29165014 1.67222134 1.86345646
 1.86548193 2.01770412 2.01914436 2.63026714 2.86487853 2.90393063
 2.90479947 2.95101817 2.95201934 3.24883281 3.59222102 3.59323051
 4.49054295 4.49145617 9.02632868 9.07132291]
   2 ( 0.000  0.500  0.000)   [-0.05413144  0.04171693  0.44623132  0.45411794] [0.90554077 0.90924243 0.92942082 1.29165142 1.67221553 1.86345176
 1.86548571 2.0176954  2.01914001 2.63026973 2.86487389 2.90393082
 2.90480191 2.95101698 2.95201998 3.24883424 3.5922214  3.5932319
 4.49053766 4.49146019 9.02632827 9.07132278]
   3 ( 0.000  0.500  0.500)   [0.05607533 0.05914912 0.31090305 0.31917996] [0.80608782 0.81833097 1.22742864 1.22770302 1.67536919 1.67852093
 1.99604155 1.99673254 2.30681771 2.30902938 2.76485099 2.76597785
 2.95644546 2.95653562 2.99691901 3.00058551 3.40207079 3.40323081
 4.71035001 4.71232988 9.02590795 9.02633895]
nelec by numeric integration = 7.999999999846839
    CPU time for vxc     16.08 sec, wall time      0.66 sec
    CPU time for vj and vk      9.09 sec, wall time      0.39 sec
E1 = (4.165531239559044+4.977060921853457e-19j)  Ecoul = (1.2397192772535253+1.493976336743761e-25j)  Exc = -3.306816675603162
cycle= 2 E= -10.7104392567767  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     29.28 sec, wall time      1.22 sec
HOMO = 0.575297432213  LUMO = 0.779934104847
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26342954  0.56307916  0.57102618  0.57529743] [0.7799341  0.78432798 0.78990027 1.12771575 1.71171899 1.71190029
 2.38020783 2.38220026 2.38283963 2.45569109 2.45875037 2.45938884
 3.54255396 3.54556036 3.72517415 3.72656868 3.72689456 4.61193656
 4.61360733 4.61519703 8.69868245 9.02928728]
   1 ( 0.000  0.000  0.500)   [-0.04874887  0.04516059  0.45231161  0.45951603] [0.91068181 0.91469806 0.93575103 1.29962931 1.67872933 1.86936961
 1.87099139 2.02147316 2.02300762 2.63471508 2.87121523 2.91136086
 2.91206657 2.95699865 2.95785813 3.2552991  3.59791873 3.59891209
 4.49658302 4.49757421 9.04235164 9.08717036]
   2 ( 0.000  0.500  0.000)   [-0.0487507   0.04515759  0.45231273  0.45952505] [0.91069184 0.91469967 0.93574738 1.29963086 1.67872364 1.86936503
 1.87099507 2.0214648  2.02300373 2.63471771 2.87121126 2.91136089
 2.91206898 2.95699727 2.95785816 3.25530007 3.59791901 3.59891336
 4.49657762 4.49757835 9.04235121 9.08717033]
   3 ( 0.000  0.500  0.500)   [0.06141108 0.06333872 0.31629209 0.32378049] [0.80987248 0.82300093 1.2352256  1.23561623 1.68271806 1.68607369
 2.00033125 2.00101587 2.31115103 2.31295076 2.77210427 2.7730857
 2.96178846 2.96199079 3.00305365 3.00623257 3.40835071 3.4091448
 4.71686242 4.7185317  9.04188037 9.04234798]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc     16.10 sec, wall time      0.63 sec
    CPU time for vj and vk      9.82 sec, wall time      0.39 sec
E1 = (4.170644773651918+5.200465384841139e-19j)  Ecoul = (1.2320373726230276+2.5180440094654697e-27j)  Exc = -3.304307032095301
cycle= 3 E= -10.7104979838064  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3     30.32 sec, wall time      1.21 sec
HOMO = 0.575156271822  LUMO = 0.779859562668
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350253  0.56288497  0.57084567  0.57515627] [0.77985956 0.78422425 0.78980426 1.12763388 1.71163735 1.71182123
 2.3801113  2.3820865  2.38270298 2.45545985 2.4585595  2.45917808
 3.54244125 3.54543218 3.72496902 3.72638191 3.7267427  4.61180425
 4.6134405  4.61503916 8.69813719 9.02875223]
   1 ( 0.000  0.000  0.500)   [-0.04881783  0.04506539  0.45214533  0.4593656 ] [0.91057019 0.91460436 0.93566677 1.29947995 1.67853402 1.86920411
 1.87083102 2.0214134  2.02290971 2.63460372 2.87107481 2.91118373
 2.91185148 2.95684088 2.95773923 3.25515294 3.59777147 3.59876483
 4.49642188 4.49742276 9.04181747 9.08663801]
   2 ( 0.000  0.500  0.000)   [-0.0488196   0.04506229  0.45214644  0.45937468] [0.91058027 0.914606   0.93566314 1.29948142 1.67852829 1.8691995
 1.87083472 2.021405   2.02290577 2.63460633 2.8710708  2.91118374
 2.91185394 2.95683951 2.95773932 3.25515394 3.59777175 3.5987661
 4.49641649 4.4974269  9.04181704 9.08663797]
   3 ( 0.000  0.500  0.500)   [0.06129198 0.06327461 0.31615338 0.3236594 ] [0.80982668 0.82290902 1.23503058 1.23549723 1.6825015  1.68584517
 2.00022683 2.00088313 2.31105727 2.31285864 2.77193781 2.77286906
 2.96163683 2.96186023 3.0028991  3.00611158 3.40822196 3.40903995
 4.71673643 4.71835306 9.04134594 9.04181349]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     15.97 sec, wall time      0.63 sec
    CPU time for vj and vk      9.21 sec, wall time      0.37 sec
E1 = (4.170517314485414+5.194432089169112e-19j)  Ecoul = (1.2322268677125856+3.4589972972130926e-26j)  Exc = -3.3043691120109213
cycle= 4 E= -10.710498027799  delta_E= -4.4e-08  |g|= 9.62e-05  |ddm|= 0.000646
    CPU time for cycle= 4     29.79 sec, wall time      1.19 sec
HOMO = 0.575156135471  LUMO = 0.779858835664
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350324  0.56288462  0.5708445   0.57515614] [0.77985884 0.78422431 0.78980333 1.12763306 1.71163695 1.7118207
 2.38010981 2.38208591 2.38270326 2.45545921 2.45855864 2.459177
 3.54244071 3.54543145 3.72496878 3.72638102 3.72674187 4.61180305
 4.61344023 4.61503832 8.69813599 9.02875105]
   1 ( 0.000  0.000  0.500)   [-0.0488186   0.04506471  0.45214507  0.45936504] [0.91057022 0.91460352 0.93566579 1.29947921 1.67853298 1.86920333
 1.87083069 2.02141208 2.02290967 2.63460251 2.87107392 2.91118272
 2.91185113 2.95684052 2.95773783 3.25515179 3.59777129 3.59876437
 4.49642166 4.49742208 9.04181635 9.08663677]
   2 ( 0.000  0.500  0.000)   [-0.04882038  0.04506163  0.45214618  0.45937411] [0.91058029 0.91460516 0.93566216 1.29948069 1.67852725 1.86919872
 1.87083438 2.02140369 2.02290574 2.63460512 2.87106991 2.91118274
 2.91185358 2.95683914 2.95773791 3.25515278 3.59777157 3.59876563
 4.49641627 4.49742622 9.04181593 9.08663673]
   3 ( 0.000  0.500  0.500)   [0.06129126 0.06327384 0.31615315 0.32365903] [0.80982576 0.82290827 1.23503051 1.2354966  1.68249966 1.68584414
 2.00022566 2.00088289 2.31105652 2.31285821 2.77193678 2.7728686
 2.96163652 2.96185887 3.00289901 3.00611063 3.40822184 3.40903893
 4.71673512 4.71835324 9.0413443  9.04181273]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc     16.05 sec, wall time      0.63 sec
    CPU time for vj and vk      9.87 sec, wall time      0.40 sec
E1 = (4.1705170584513205+5.194533177213386e-19j)  Ecoul = (1.2322272419526419+3.63948867232766e-26j)  Exc = -3.3043692298346334
cycle= 5 E= -10.7104980274168  delta_E= 3.82e-10  |g|= 0.000124  |ddm|= 0.000232
    CPU time for cycle= 5     30.33 sec, wall time      1.21 sec
HOMO = 0.57515610722  LUMO = 0.779858671823
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350341  0.56288454  0.57084422  0.57515611] [0.77985867 0.78422432 0.78980311 1.12763286 1.71163686 1.71182057
 2.38010947 2.38208577 2.38270331 2.45545906 2.45855845 2.45917674
 3.54244058 3.54543128 3.72496872 3.72638082 3.72674168 4.61180277
 4.61344016 4.61503813 8.69813572 9.02875079]
   1 ( 0.000  0.000  0.500)   [-0.04881877  0.04506455  0.452145    0.45936491] [0.91057022 0.91460333 0.93566557 1.29947904 1.67853274 1.86920315
 1.87083061 2.02141178 2.02290966 2.63460223 2.87107371 2.91118249
 2.91185104 2.95684043 2.95773751 3.25515152 3.59777125 3.59876426
 4.4964216  4.49742192 9.04181611 9.08663648]
   2 ( 0.000  0.500  0.000)   [-0.04882056  0.04506147  0.45214611  0.45937397] [0.91058029 0.91460496 0.93566193 1.29948052 1.67852702 1.86919854
 1.8708343  2.02140339 2.02290572 2.63460484 2.8710697  2.91118251
 2.91185349 2.95683905 2.95773759 3.25515252 3.59777153 3.59876553
 4.49641621 4.49742606 9.04181568 9.08663645]
   3 ( 0.000  0.500  0.500)   [0.0612911  0.06327366 0.31615309 0.32365895] [0.80982554 0.8229081  1.23503049 1.23549646 1.68249924 1.68584389
 2.00022539 2.00088283 2.31105636 2.31285809 2.77193655 2.77286849
 2.96163644 2.96185856 3.00289898 3.00611041 3.40822181 3.40903869
 4.71673482 4.71835327 9.0413444  9.04181208]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc     16.50 sec, wall time      0.64 sec
    CPU time for vj and vk      9.41 sec, wall time      0.36 sec
E1 = (4.170516998723357+5.194442660157677e-19j)  Ecoul = (1.2322273282353746-1.6288399971003452e-26j)  Exc = -3.3043692573494576
cycle= 6 E= -10.7104980283768  delta_E= -9.6e-10  |g|= 3.55e-07  |ddm|= 0.000131
    CPU time for cycle= 6     30.62 sec, wall time      1.20 sec
HOMO = 0.575156102649  LUMO = 0.779858670165
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350342  0.56288451  0.57084421  0.5751561 ] [0.77985867 0.78422429 0.78980309 1.12763284 1.71163685 1.71182056
 2.38010946 2.38208575 2.38270329 2.45545903 2.45855845 2.45917672
 3.54244056 3.54543126 3.7249687  3.7263808  3.72674168 4.61180276
 4.61344014 4.61503811 8.69813569 9.02875076]
   1 ( 0.000  0.000  0.500)   [-0.04881878  0.04506454  0.45214498  0.4593649 ] [0.9105702  0.91460331 0.93566556 1.29947903 1.67853273 1.86920313
 1.87083059 2.02141178 2.02290964 2.63460222 2.87107369 2.91118248
 2.91185101 2.95684041 2.9577375  3.25515151 3.59777123 3.59876424
 4.49642158 4.4974219  9.04181608 9.08663645]
   2 ( 0.000  0.500  0.000)   [-0.04882057  0.04506145  0.45214609  0.45937396] [0.91058026 0.91460495 0.93566193 1.29948051 1.67852701 1.86919852
 1.87083429 2.02140338 2.0229057  2.63460483 2.87106968 2.91118249
 2.91185346 2.95683904 2.95773758 3.25515251 3.5977715  3.59876551
 4.49641618 4.49742604 9.04181565 9.08663641]
   3 ( 0.000  0.500  0.500)   [0.06129109 0.06327364 0.31615307 0.32365894] [0.80982552 0.82290809 1.23503045 1.23549646 1.68249921 1.68584386
 2.00022539 2.00088281 2.31105635 2.31285807 2.77193655 2.77286846
 2.96163642 2.96185855 3.00289896 3.0061104  3.40822179 3.40903867
 4.71673482 4.71835324 9.04134437 9.04181206]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     16.81 sec, wall time      0.65 sec
    CPU time for vj and vk      9.63 sec, wall time      0.36 sec
E1 = (4.170516987175339+5.194444620319254e-19j)  Ecoul = (1.2322273454447226+9.76925345025701e-27j)  Exc = -3.3043692630107895
Extra cycle  E= -10.7104980283768  delta_E= -1.78e-15  |g|= 3.43e-07  |ddm|= 6.95e-07
    CPU time for scf_cycle    234.01 sec, wall time      9.42 sec
    CPU time for SCF    237.22 sec, wall time      9.58 sec
converged SCF energy = -10.7104980283768
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-40.0/47995826/scf.h5
