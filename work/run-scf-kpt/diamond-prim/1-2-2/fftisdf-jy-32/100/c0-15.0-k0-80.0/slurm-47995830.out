SLURMD_NODENAME = hpc-19-16
Start time = Thu Mar 13 04:24:37 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-80.0/47995830/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-80.0/47995830/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  8.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.22657159]
 [ 0.          0.          0.45314317]
 ...
 [-0.26162237 -0.18499492 -0.90628634]
 [-0.26162237 -0.18499492 -0.67971476]
 [-0.26162237 -0.18499492 -0.45314317]], m0 = [21 21 21]
Pivoted Cholesky rank = 374, estimated error = 0.00e+00
Parent grid size = 9261, selected grid size = 390
    CPU time for interpolating functions     19.47 sec, wall time      2.00 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.18 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]     16.71 sec, wall time      0.76 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     11.99 sec, wall time      0.46 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 331 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     10.77 sec, wall time      0.41 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 331 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     12.47 sec, wall time      0.49 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 331 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.17e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     10.78 sec, wall time      0.42 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 331 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-80.0/47995830/tmp6fsae129
    CPU time for building ISDF     68.15 sec, wall time      2.73 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-80.0/47995830/tmpn0lxvr9l
max_memory 81920 MB (current use 282 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7fc848173be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      7.87 sec, wall time      0.26 sec
    CPU time for vj and vk      7.42 sec, wall time      0.24 sec
E1 = (4.673183787659304-7.653237836844948e-18j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.3914901827939032
init E= -10.0507154209849
    CPU time for initialize scf     23.79 sec, wall time      0.80 sec
HOMO = 0.617031570135  LUMO = 0.803929955424
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655452  0.6111482   0.61138558  0.61703157] [0.80392996 0.80814506 0.81092733 1.13006498 1.73333044 1.73556117
 2.40667496 2.4072205  2.40801139 2.5011027  2.50172305 2.50205507
 3.56783974 3.56831894 3.76714164 3.76715922 3.76793599 4.64476691
 4.64491158 4.64503047 8.84194601 9.17011853]
   1 ( 0.000  0.000  0.500)   [-0.03769206  0.0616667   0.49459168  0.50130677] [0.93251557 0.93680297 0.94438379 1.33409322 1.7214014  1.90372366
 1.9050682  2.04477566 2.0466926  2.65773362 2.90263151 2.95423732
 2.9547244  2.989489   2.990386   3.2877104  3.62664571 3.62703042
 4.52706552 4.5271687  9.18283288 9.22709787]
   2 ( 0.000  0.500  0.000)   [-0.03769476  0.06166872  0.49458888  0.50130385] [0.93251927 0.93680523 0.9443881  1.33409092 1.72140004 1.90372458
 1.90506644 2.04477228 2.04669484 2.65773154 2.90262719 2.95423948
 2.95472517 2.98948428 2.99038301 3.28771078 3.62664349 3.62703119
 4.5270822  4.52717076 9.1828323  9.22709837]
   3 ( 0.000  0.500  0.500)   [0.07640132 0.079376   0.34925395 0.36058304] [0.82049623 0.82900112 1.27129553 1.27175826 1.72863508 1.72939707
 2.03063211 2.03250564 2.33430296 2.33445994 2.81522173 2.81661414
 2.98769731 2.98878084 3.03483459 3.03570919 3.43441556 3.43506263
 4.75294924 4.75324575 9.18254908 9.18256104]
nelec by numeric integration = 7.999999999848202
    CPU time for vxc      8.98 sec, wall time      0.29 sec
    CPU time for vj and vk      7.23 sec, wall time      0.23 sec
E1 = (4.205083388184675-5.98636652468885e-18j)  Ecoul = (1.1845377750066959+1.500097897368276e-26j)  Exc = -3.2881890510420755
cycle= 1 E= -10.7074409858368  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     16.41 sec, wall time      0.53 sec
HOMO = 0.569683424964  LUMO = 0.774540470927
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823106  0.55648693  0.56494719  0.56968342] [0.77454047 0.77913017 0.78468829 1.11984212 1.70810805 1.70833024
 2.37427787 2.3765505  2.37739316 2.44836517 2.45168037 2.45230211
 3.53689795 3.54001662 3.71838357 3.7199563  3.72041638 4.60534544
 4.60715595 4.60871255 8.68226347 9.01323589]
   1 ( 0.000  0.000  0.500)   [-0.05413178  0.04171482  0.44622966  0.45411098] [0.90552356 0.90922963 0.92941694 1.29164485 1.67221959 1.86345172
 1.86548796 2.01770344 2.01914215 2.63026794 2.86488172 2.90392594
 2.90479801 2.95101881 2.95202092 3.24883283 3.59221781 3.59323046
 4.49054269 4.49145979 9.02632797 9.07132206]
   2 ( 0.000  0.500  0.000)   [-0.05413453  0.04171889  0.44622628  0.45411184] [0.90552798 0.90923626 0.92942131 1.29163671 1.67221959 1.86344769
 1.86548884 2.01769974 2.01914018 2.63026126 2.86488103 2.90392964
 2.90479826 2.95101395 2.9520222  3.24883424 3.59221914 3.59323011
 4.49054367 4.49146783 9.02632768 9.07132183]
   3 ( 0.000  0.500  0.500)   [0.0560733  0.05914892 0.31089735 0.31917377] [0.80608962 0.81832606 1.22741904 1.22770051 1.67536381 1.67852599
 1.99604359 1.99673176 2.30682542 2.30902745 2.76485586 2.76597407
 2.95644689 2.95654413 2.99691513 3.00058423 3.40206804 3.40323758
 4.71035172 4.71232779 9.02590752 9.026339  ]
nelec by numeric integration = 7.999999999846835
    CPU time for vxc      8.42 sec, wall time      0.27 sec
    CPU time for vj and vk      7.34 sec, wall time      0.24 sec
E1 = (4.165530689198381-6.167009567412745e-18j)  Ecoul = (1.2397199476830352-7.376796096902726e-26j)  Exc = -3.3068256138668186
cycle= 2 E= -10.7104480749715  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     18.62 sec, wall time      0.60 sec
HOMO = 0.575296976069  LUMO = 0.77992405673
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343003  0.56308112  0.57102122  0.57529698] [0.77992406 0.78431894 0.78989633 1.12771699 1.71172599 1.71189957
 2.38020982 2.38219545 2.38283783 2.45569117 2.45874485 2.45938775
 3.54254949 3.54556123 3.72517454 3.72656345 3.7268916  4.6119409
 4.61361197 4.61520365 8.69868256 9.02928699]
   1 ( 0.000  0.000  0.500)   [-0.04875029  0.04515501  0.45231138  0.4595183 ] [0.91067502 0.91468713 0.93574407 1.29962404 1.67872759 1.8693653
 1.87099723 2.02147258 2.02300566 2.6347159  2.8712187  2.91135635
 2.91206524 2.95699967 2.9578596  3.25529936 3.59791566 3.59891228
 4.49658316 4.49757813 9.04235126 9.08716989]
   2 ( 0.000  0.500  0.000)   [-0.04875314  0.0451591   0.4523081   0.45951896] [0.91067935 0.91469375 0.93574833 1.299616   1.67872757 1.86936134
 1.87099838 2.02146884 2.02300392 2.63470947 2.87121808 2.91136001
 2.91206554 2.9569947  2.95786056 3.25530083 3.59791701 3.59891175
 4.49658403 4.4975861  9.04235099 9.08716972]
   3 ( 0.000  0.500  0.500)   [0.06140936 0.06333833 0.31628681 0.32377416] [0.80987382 0.82299647 1.23521633 1.23561392 1.68271275 1.68607901
 2.00033331 2.00101537 2.31115883 2.31294877 2.77210924 2.77308217
 2.96179664 2.96199256 3.00305041 3.00623137 3.40834833 3.40915148
 4.71686419 4.71853014 9.04188037 9.04234828]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      8.50 sec, wall time      0.27 sec
    CPU time for vj and vk      6.74 sec, wall time      0.22 sec
E1 = (4.170644343805491-6.1208916992198265e-18j)  Ecoul = (1.2320378318061145+9.2252549700166e-26j)  Exc = -3.304315884584957
cycle= 3 E= -10.7105068069594  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     17.84 sec, wall time      0.57 sec
HOMO = 0.575155837709  LUMO = 0.779849523797
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350301  0.56288692  0.5708407   0.57515584] [0.77984952 0.78421523 0.78980033 1.12763514 1.71164436 1.71182052
 2.3801133  2.38208169 2.38270118 2.45545991 2.45855396 2.459177
 3.54243678 3.54543306 3.72496941 3.72637667 3.72673974 4.61180859
 4.61344515 4.61504575 8.69813729 9.02875193]
   1 ( 0.000  0.000  0.500)   [-0.04881922  0.04505978  0.45214509  0.45936791] [0.91056343 0.91459345 0.93565981 1.29947467 1.67853227 1.86919979
 1.87083688 2.02141281 2.02290773 2.63460456 2.87107829 2.91117921
 2.91185016 2.9568419  2.95774072 3.25515323 3.59776841 3.59876502
 4.49642203 4.49742668 9.04181708 9.08663752]
   2 ( 0.000  0.500  0.000)   [-0.04882206  0.04506385  0.45214181  0.45936857] [0.91056779 0.91460007 0.93566408 1.29946662 1.67853224 1.86919582
 1.87083804 2.02140909 2.02290598 2.63459809 2.87107765 2.91118287
 2.91185046 2.95683693 2.95774171 3.25515468 3.59776974 3.59876449
 4.49642291 4.49743464 9.0418168  9.08663735]
   3 ( 0.000  0.500  0.500)   [0.06129023 0.06327425 0.3161481  0.32365307] [0.80982804 0.82290453 1.23502132 1.23549492 1.6824962  1.6858505
 2.00022889 2.00088263 2.31106506 2.31285667 2.77194279 2.77286552
 2.96164506 2.96186197 3.00289586 3.00611038 3.40821958 3.40904665
 4.71673818 4.71835156 9.04134597 9.04181373]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      8.24 sec, wall time      0.27 sec
    CPU time for vj and vk      7.54 sec, wall time      0.25 sec
E1 = (4.17051688268384-6.121585489978764e-18j)  Ecoul = (1.2322273293333557+2.847472323485764e-26j)  Exc = -3.304377965361658
cycle= 4 E= -10.7105068513305  delta_E= -4.44e-08  |g|= 2.42e-05  |ddm|= 0.000627
    CPU time for cycle= 4     19.44 sec, wall time      0.64 sec
HOMO = 0.575155674616  LUMO = 0.779848649105
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350388  0.56288651  0.57083928  0.57515567] [0.77984865 0.78421531 0.7897992  1.12763415 1.71164388 1.71181987
 2.3801115  2.38208098 2.38270152 2.45545916 2.45855293 2.4591757
 3.54243613 3.54543218 3.72496913 3.72637561 3.72673874 4.61180715
 4.61344483 4.61504475 8.69813586 9.02875053]
   1 ( 0.000  0.000  0.500)   [-0.04882016  0.04505897  0.45214478  0.45936723] [0.91056347 0.91459244 0.93565863 1.29947378 1.67853102 1.86919886
 1.87083648 2.02141123 2.02290769 2.6346031  2.87107722 2.91117801
 2.91184975 2.95684147 2.95773902 3.25515184 3.59776821 3.59876447
 4.49642177 4.49742586 9.04181575 9.08663604]
   2 ( 0.000  0.500  0.000)   [-0.048823    0.04506304  0.45214151  0.45936789] [0.91056783 0.91459905 0.9356629  1.29946573 1.67853099 1.86919489
 1.87083764 2.0214075  2.02290594 2.63459663 2.87107658 2.91118167
 2.91185004 2.9568365  2.95774001 3.25515328 3.59776954 3.59876394
 4.49642265 4.49743383 9.04181548 9.08663587]
   3 ( 0.000  0.500  0.500)   [0.06128937 0.06327332 0.31614783 0.32365262] [0.80982692 0.82290364 1.23502125 1.23549416 1.68249398 1.68584926
 2.00022748 2.00088235 2.31106416 2.31285614 2.77194156 2.77286498
 2.96164466 2.96186036 3.00289575 3.00610923 3.40821945 3.40904542
 4.7167366  4.71835178 9.04134428 9.04181256]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      9.37 sec, wall time      0.30 sec
    CPU time for vj and vk      6.34 sec, wall time      0.20 sec
E1 = (4.170516578585517-6.1215839647004266e-18j)  Ecoul = (1.2322277736299632-1.1422705907600251e-26j)  Exc = -3.3043781054914176
cycle= 5 E= -10.710506851262  delta_E= 6.85e-11  |g|= 4.09e-05  |ddm|= 6.77e-05
    CPU time for cycle= 5     18.45 sec, wall time      0.59 sec
HOMO = 0.575155663567  LUMO = 0.779848631949
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350391  0.56288646  0.57083923  0.57515566] [0.77984863 0.78421527 0.78979916 1.1276341  1.71164386 1.71181984
 2.38011146 2.38208094 2.38270148 2.4554591  2.45855291 2.45917564
 3.5424361  3.54543214 3.72496909 3.72637556 3.72673872 4.6118071
 4.61344478 4.6150447  8.69813579 9.02875046]
   1 ( 0.000  0.000  0.500)   [-0.04882018  0.04505894  0.45214474  0.4593672 ] [0.91056344 0.9145924  0.93565859 1.29947375 1.67853098 1.86919881
 1.87083645 2.02141119 2.02290766 2.63460306 2.87107717 2.91117797
 2.91184969 2.95684144 2.95773898 3.2551518  3.59776817 3.59876443
 4.49642173 4.49742582 9.04181569 9.08663596]
   2 ( 0.000  0.500  0.000)   [-0.04882303  0.045063    0.45214146  0.45936786] [0.91056779 0.91459901 0.93566287 1.2994657  1.67853096 1.86919484
 1.87083761 2.02140746 2.02290591 2.63459659 2.87107653 2.91118163
 2.91184999 2.95683647 2.95773997 3.25515325 3.5977695  3.5987639
 4.49642261 4.49743379 9.04181541 9.0866358 ]
   3 ( 0.000  0.500  0.500)   [0.06128935 0.06327327 0.31614779 0.3236526 ] [0.80982687 0.82290361 1.2350212  1.23549415 1.68249391 1.68584919
 2.00022744 2.00088231 2.31106414 2.3128561  2.77194153 2.77286492
 2.96164466 2.96186028 3.00289572 3.00610919 3.40821942 3.40904537
 4.71673657 4.71835174 9.04134422 9.04181248]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc      9.50 sec, wall time      0.31 sec
    CPU time for vj and vk      9.94 sec, wall time      0.33 sec
E1 = (4.170516555594939-6.121588734090351e-18j)  Ecoul = (1.2322278083605989-4.80258519098552e-26j)  Exc = -3.3043781169861433
Extra cycle  E= -10.7105068510167  delta_E= 2.45e-10  |g|= 7.48e-05  |ddm|= 0.000122
    CPU time for scf_cycle    134.19 sec, wall time      4.39 sec
    CPU time for SCF    138.16 sec, wall time      4.52 sec
converged SCF energy = -10.7105068510167
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-80.0/47995830/scf.h5
