SLURMD_NODENAME = hpc-34-20
Start time = Thu Mar 13 04:24:33 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-20.0/47995824/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-20.0/47995824/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  2.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.43254576]
 [ 0.          0.          0.86509151]
 ...
 [-0.49946088 -0.35317212 -1.73018302]
 [-0.49946088 -0.35317212 -1.29763727]
 [-0.49946088 -0.35317212 -0.86509151]], m0 = [11 11 11]
Pivoted Cholesky rank = 359, estimated error = 0.00e+00
Parent grid size = 1331, selected grid size = 390
    CPU time for interpolating functions      4.78 sec, wall time      0.16 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      2.54 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]     13.91 sec, wall time      0.59 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     12.29 sec, wall time      0.48 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 334 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     11.95 sec, wall time      0.45 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     11.57 sec, wall time      0.44 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel     11.80 sec, wall time      0.44 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 333 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-20.0/47995824/tmpy8m9nhs1
    CPU time for building ISDF     70.74 sec, wall time      2.70 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-20.0/47995824/tmpgccase_8
max_memory 81920 MB (current use 274 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f06a3529cd0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      8.47 sec, wall time      0.27 sec
    CPU time for vj and vk      8.06 sec, wall time      0.26 sec
E1 = (4.673183787659304+4.2349932694017022e-19j)  Ecoul = (1.4764640721357722+2.331033469502186e-33j)  Exc = -3.39148882653027
init E= -10.0507140647213
    CPU time for initialize scf     24.48 sec, wall time      0.81 sec
HOMO = 0.617030117925  LUMO = 0.803936557077
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655719  0.61115347  0.61139387  0.61703012] [0.80393656 0.80814897 0.81092207 1.13006114 1.73332527 1.73556036
 2.40667384 2.40722633 2.40801415 2.50110589 2.50172733 2.50205583
 3.56784155 3.56831594 3.76714671 3.76716688 3.76793525 4.64474795
 4.64490353 4.64501019 8.84194501 9.17011674]
   1 ( 0.000  0.000  0.500)   [-0.03769598  0.06167075  0.4945934   0.5013049 ] [0.93252575 0.93680151 0.94438105 1.33410739 1.72140334 1.90372729
 1.90507078 2.04477339 2.04668993 2.65773916 2.90262749 2.95423663
 2.95472601 2.98949    2.99038583 3.28771474 3.6266476  3.62702843
 4.5270588  4.52715898 9.18283056 9.22709679]
   2 ( 0.000  0.500  0.000)   [-0.03769568  0.0616702   0.49459506  0.50130513] [0.93252926 0.93680013 0.9443815  1.33410046 1.72140249 1.90372273
 1.90506899 2.04477477 2.04668524 2.65773646 2.90262655 2.95423704
 2.95472668 2.98948623 2.99038766 3.28770937 3.62664413 3.6270335
 4.52705803 4.52715796 9.18283083 9.227096  ]
   3 ( 0.000  0.500  0.500)   [0.07639743 0.07937663 0.34926569 0.36058298] [0.82049596 0.82899647 1.27130061 1.27175743 1.72864136 1.72939771
 2.03063503 2.03250177 2.33429829 2.334459   2.8152224  2.81661403
 2.98769377 2.98877736 3.03482968 3.03570984 3.4344158  3.4350564
 4.75292793 4.75323331 9.18254704 9.18255907]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc      9.46 sec, wall time      0.30 sec
    CPU time for vj and vk      6.63 sec, wall time      0.22 sec
E1 = (4.20508040753842-1.1999906982934626e-19j)  Ecoul = (1.184541620806716-2.2409960595518503e-26j)  Exc = -3.2881809281224674
cycle= 1 E= -10.7074319977634  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     16.29 sec, wall time      0.53 sec
HOMO = 0.56969008416  LUMO = 0.774547791561
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823453  0.55648497  0.56495379  0.56969008] [0.77454779 0.77912545 0.78469748 1.1198412  1.70809737 1.7083277
 2.37427862 2.37655551 2.37739473 2.44836514 2.45168439 2.45230562
 3.53690214 3.54001698 3.7183839  3.71996112 3.72041811 4.60533805
 4.60715354 4.6087027  8.68226471 9.01323566]
   1 ( 0.000  0.000  0.500)   [-0.05413183  0.04172204  0.44622955  0.45411499] [0.90552698 0.90924545 0.92942302 1.29165211 1.67222265 1.86345348
 1.86548862 2.01770028 2.01913883 2.63026998 2.86487659 2.90392747
 2.9047999  2.95101514 2.9520224  3.24884103 3.59222341 3.59323117
 4.49053893 4.49145788 9.02632727 9.07132208]
   2 ( 0.000  0.500  0.000)   [-0.05413327  0.04172423  0.44622862  0.45411438] [0.90552359 0.90924523 0.92942403 1.29165075 1.67222143 1.8634525
 1.86548385 2.01770213 2.01913495 2.63026987 2.86487657 2.90392781
 2.90480112 2.9510175  2.95202016 3.24883575 3.5922191  3.59323323
 4.49053521 4.49145727 9.02632746 9.07132201]
   3 ( 0.000  0.500  0.500)   [0.05607063 0.05915213 0.31089867 0.31918553] [0.80608322 0.81832926 1.2274227  1.22770455 1.67536947 1.67852621
 1.99604614 1.99672629 2.30681816 2.30902247 2.76485479 2.76597904
 2.95644763 2.95653563 2.99691691 3.00058362 3.4020673  3.40323653
 4.71033436 4.71231748 9.02590759 9.02633813]
nelec by numeric integration = 7.999999999846835
    CPU time for vxc     10.98 sec, wall time      0.36 sec
    CPU time for vj and vk      9.74 sec, wall time      0.33 sec
E1 = (4.165529440096677-6.255855440428325e-20j)  Ecoul = (1.2397215019335623+4.922492048579114e-27j)  Exc = -3.306816530171557
cycle= 2 E= -10.7104386861274  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     22.33 sec, wall time      0.74 sec
HOMO = 0.575303623265  LUMO = 0.779931162399
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343381  0.56307888  0.5710278   0.57530362] [0.77993116 0.78431409 0.78990513 1.12771571 1.71171522 1.71189702
 2.38021029 2.38220019 2.38283915 2.45569103 2.4587486  2.45939094
 3.54255335 3.54556137 3.72517482 3.72656794 3.72689303 4.61193307
 4.61360916 4.61519343 8.69868335 9.02928632]
   1 ( 0.000  0.000  0.500)   [-0.04875082  0.04516215  0.45231091  0.45952193] [0.91067798 0.9147026  0.93574974 1.29963114 1.67873051 1.86936669
 1.87099768 2.0214693  2.02300237 2.63471793 2.87121352 2.91135765
 2.9120669  2.95699561 2.95786047 3.2553067  3.59792086 3.59891258
 4.49657905 4.49757595 9.04235013 9.08716953]
   2 ( 0.000  0.500  0.000)   [-0.04875214  0.04516399  0.45231004  0.45952166] [0.91067488 0.91470234 0.93575065 1.29962948 1.67872923 1.86936561
 1.87099294 2.02147105 2.02299827 2.6347178  2.87121317 2.91135793
 2.91206822 2.95699793 2.95785857 3.2553019  3.59791666 3.59891468
 4.49657536 4.49757536 9.04235032 9.08716941]
   3 ( 0.000  0.500  0.500)   [0.06140655 0.06334122 0.31628776 0.32378584] [0.80986724 0.82299949 1.2352196  1.23561765 1.68271819 1.686079
 2.00033562 2.00100955 2.31115166 2.31294375 2.77210787 2.77308674
 2.96178821 2.96199302 3.00305168 3.00623051 3.40834712 3.40915011
 4.71684658 4.71851964 9.04188003 9.04234696]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      8.95 sec, wall time      0.29 sec
    CPU time for vj and vk      6.06 sec, wall time      0.19 sec
E1 = (4.170642864021111-8.792923070436914e-20j)  Ecoul = (1.232039695945+3.9859563819007285e-26j)  Exc = -3.3043068760908443
cycle= 3 E= -10.7104974141108  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     17.22 sec, wall time      0.55 sec
HOMO = 0.575162543651  LUMO = 0.779856676953
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350678  0.56288473  0.57084736  0.57516254] [0.77985668 0.78421042 0.78980918 1.12763391 1.71163361 1.71181799
 2.38011382 2.38208647 2.38270255 2.45545984 2.45855784 2.45918028
 3.54244069 3.54543324 3.72496976 3.72638124 3.72674124 4.61180085
 4.6134424  4.61503563 8.69813827 9.02875145]
   1 ( 0.000  0.000  0.500)   [-0.0488197   0.04506692  0.45214467  0.4593716 ] [0.91056645 0.91460899 0.93566553 1.29948181 1.67853525 1.86920121
 1.8708374  2.02140956 2.02290446 2.6346066  2.87107313 2.91118058
 2.9118519  2.9568379  2.95774165 3.25516063 3.59777366 3.59876538
 4.49641798 4.49742457 9.04181613 9.08663734]
   2 ( 0.000  0.500  0.000)   [-0.04882105  0.0450688   0.4521438   0.45937132] [0.91056333 0.91460868 0.93566642 1.29948018 1.67853399 1.86920014
 1.87083266 2.02141133 2.02290038 2.63460647 2.87107281 2.91118084
 2.91185322 2.9568402  2.95773974 3.25515582 3.59776944 3.59876746
 4.4964143  4.49742399 9.04181633 9.08663723]
   3 ( 0.000  0.500  0.500)   [0.06128746 0.06327718 0.3161491  0.32366482] [0.80982147 0.82290757 1.23502464 1.23549872 1.68250171 1.68585055
 2.00023127 2.00087683 2.31105791 2.31285168 2.77194148 2.77287016
 2.96163662 2.96186249 3.00289719 3.00610959 3.40821841 3.40904531
 4.71672065 4.71834109 9.04134577 9.04181264]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      9.87 sec, wall time      0.32 sec
    CPU time for vj and vk      6.93 sec, wall time      0.22 sec
E1 = (4.170515447665691-8.753754037589014e-20j)  Ecoul = (1.2322291269771524-3.1869980570928877e-27j)  Exc = -3.304368935113774
cycle= 4 E= -10.710497458457  delta_E= -4.43e-08  |g|= 2.18e-05  |ddm|= 0.000627
    CPU time for cycle= 4     19.69 sec, wall time      0.64 sec
HOMO = 0.575162380087  LUMO = 0.779855800496
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350764  0.56288432  0.57084594  0.57516238] [0.7798558  0.7842105  0.78980805 1.12763292 1.71163313 1.71181734
 2.38011202 2.38208576 2.38270289 2.45545908 2.4585568  2.45917897
 3.54244004 3.54543235 3.72496948 3.72638017 3.72674024 4.6117994
 4.61344208 4.61503462 8.69813684 9.02875005]
   1 ( 0.000  0.000  0.500)   [-0.04882064  0.04506611  0.45214436  0.45937091] [0.91056649 0.91460797 0.93566435 1.29948092 1.67853399 1.86920028
 1.870837   2.02140798 2.02290443 2.63460513 2.87107206 2.91117938
 2.91185148 2.95683746 2.95773995 3.25515923 3.59777345 3.59876483
 4.49641772 4.49742375 9.0418148  9.08663586]
   2 ( 0.000  0.500  0.000)   [-0.04882198  0.04506799  0.45214349  0.45937064] [0.91056337 0.91460766 0.93566524 1.29947929 1.67853273 1.86919921
 1.87083226 2.02140973 2.02290034 2.63460501 2.87107173 2.91117963
 2.9118528  2.95683977 2.95773805 3.25515443 3.59776924 3.59876691
 4.49641404 4.49742318 9.041815   9.08663575]
   3 ( 0.000  0.500  0.500)   [0.0612866  0.06327624 0.31614883 0.32366437] [0.80982035 0.82290667 1.23502458 1.23549796 1.68249949 1.6858493
 2.00022985 2.00087655 2.31105702 2.31285115 2.77194025 2.77286962
 2.96163625 2.96186085 3.00289708 3.00610844 3.40821828 3.40904407
 4.71671906 4.71834131 9.04134417 9.04181139]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      8.66 sec, wall time      0.28 sec
    CPU time for vj and vk      7.36 sec, wall time      0.24 sec
E1 = (4.170515143036199-8.754687384995458e-20j)  Ecoul = (1.2322295722652286-1.623160198582754e-26j)  Exc = -3.304369075717538
cycle= 5 E= -10.7104974584022  delta_E= 5.48e-11  |g|= 3.67e-05  |ddm|= 6.06e-05
    CPU time for cycle= 5     19.25 sec, wall time      0.62 sec
HOMO = 0.575162369687  LUMO = 0.779855786186
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350767  0.56288428  0.5708459   0.57516237] [0.77985579 0.78421047 0.78980801 1.12763288 1.71163311 1.71181732
 2.38011198 2.38208572 2.38270286 2.45545902 2.45855679 2.45917892
 3.54244    3.54543232 3.72496944 3.72638013 3.72674022 4.61179936
 4.61344203 4.61503457 8.69813677 9.02874998]
   1 ( 0.000  0.000  0.500)   [-0.04882066  0.04506607  0.45214432  0.45937088] [0.91056645 0.91460794 0.93566432 1.29948089 1.67853396 1.86920023
 1.87083697 2.02140794 2.02290439 2.6346051  2.87107202 2.91117934
 2.91185142 2.95683743 2.95773992 3.2551592  3.59777342 3.59876479
 4.49641768 4.49742371 9.04181474 9.08663579]
   2 ( 0.000  0.500  0.000)   [-0.04882201  0.04506795  0.45214345  0.45937061] [0.91056333 0.91460763 0.93566521 1.29947926 1.6785327  1.86919917
 1.87083223 2.0214097  2.02290031 2.63460497 2.87107169 2.9111796
 2.91185274 2.95683974 2.95773801 3.25515439 3.5977692  3.59876688
 4.496414   4.49742314 9.04181494 9.08663568]
   3 ( 0.000  0.500  0.500)   [0.06128657 0.0632762  0.31614879 0.32366436] [0.8098203  0.82290665 1.23502452 1.23549796 1.68249941 1.68584925
 2.00022982 2.00087651 2.31105699 2.31285112 2.77194023 2.77286956
 2.9616362  2.96186083 3.00289705 3.00610841 3.40821825 3.40904403
 4.71671904 4.71834127 9.04134398 9.04181144]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      9.52 sec, wall time      0.30 sec
    CPU time for vj and vk      7.66 sec, wall time      0.26 sec
E1 = (4.170515120886357-8.754384008023971e-20j)  Ecoul = (1.2322296053263686+9.756631675773474e-27j)  Exc = -3.3043690864315662
Extra cycle  E= -10.7104974582049  delta_E= 1.97e-10  |g|= 6.71e-05  |ddm|= 0.000109
    CPU time for scf_cycle    136.64 sec, wall time      4.46 sec
    CPU time for SCF    139.98 sec, wall time      4.59 sec
converged SCF energy = -10.7104974582049
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-15.0-k0-20.0/47995824/scf.h5
