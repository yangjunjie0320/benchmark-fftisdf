SLURMD_NODENAME = hpc-34-18
Start time = Thu Mar 13 04:24:44 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-60.0/47995840/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-60.0/47995840/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  6.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.25042123]
 [ 0.          0.          0.50084245]
 ...
 [-0.28916156 -0.20446807 -1.00168491]
 [-0.28916156 -0.20446807 -0.75126368]
 [-0.28916156 -0.20446807 -0.50084245]], m0 = [19 19 19]
Pivoted Cholesky rank = 371, estimated error = 0.00e+00
Parent grid size = 6859, selected grid size = 520
    CPU time for interpolating functions      9.89 sec, wall time      1.17 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.59 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]     10.43 sec, wall time      0.99 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     40.71 sec, wall time      2.27 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 305 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     36.99 sec, wall time      2.07 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 305 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     36.86 sec, wall time      1.99 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 305 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.17e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     38.08 sec, wall time      1.95 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 304 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-60.0/47995840/tmpn8fdpwac
    CPU time for building ISDF    170.26 sec, wall time      9.64 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-60.0/47995840/tmpwye5rofd
max_memory 81920 MB (current use 251 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f594ec61be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      9.64 sec, wall time      0.47 sec
    CPU time for vj and vk      8.69 sec, wall time      0.43 sec
E1 = (4.673183787659305+1.7242472596844533e-17j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.3914849625515595
init E= -10.0507102007426
    CPU time for initialize scf     28.55 sec, wall time      1.44 sec
HOMO = 0.617031226369  LUMO = 0.803937277713
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655503  0.61115057  0.61138839  0.61703123] [0.80393728 0.80814136 0.81092407 1.13006714 1.73332945 1.73555807
 2.40667624 2.40722589 2.4080149  2.50110652 2.50172597 2.50205502
 3.56784237 3.56831862 3.76714513 3.76716374 3.76793716 4.64476478
 4.6449095  4.64502335 8.84194725 9.17011879]
   1 ( 0.000  0.000  0.500)   [-0.03769288  0.06166973  0.49459288  0.50130615] [0.93252149 0.93680316 0.94438243 1.33410013 1.72140036 1.90372671
 1.90506941 2.04477302 2.04669167 2.65773672 2.90262974 2.95423736
 2.9547271  2.98948818 2.9903835  3.28771398 3.6266455  3.62702916
 4.52706629 4.52716548 9.18283286 9.22710009]
   2 ( 0.000  0.500  0.000)   [-0.03769256  0.06166949  0.49459251  0.50130554] [0.93252314 0.9368025  0.94438573 1.33410056 1.72140076 1.9037241
 1.90506862 2.04477375 2.04669024 2.65774175 2.90262829 2.95423776
 2.95472608 2.98948892 2.99038468 3.28771189 3.62664511 3.62702998
 4.52706706 4.52717077 9.18283315 9.22710068]
   3 ( 0.000  0.500  0.500)   [0.07640268 0.0793749  0.34926209 0.36058334] [0.82049526 0.82899675 1.27129955 1.27175849 1.72863827 1.72939568
 2.03063358 2.03250224 2.33429914 2.33445782 2.81522163 2.8166155
 2.98769601 2.98877933 3.03483265 3.03570815 3.43441639 3.4350614
 4.75295105 4.75324446 9.18254968 9.18256316]
nelec by numeric integration = 7.999999999848205
    CPU time for vxc     14.18 sec, wall time      0.68 sec
    CPU time for vj and vk      8.19 sec, wall time      0.40 sec
E1 = (4.2050838917791475+5.4297746529025946e-18j)  Ecoul = (1.1845368668355138+1.7239387569465486e-24j)  Exc = -3.2881832078834012
cycle= 1 E= -10.7074355472548  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     22.53 sec, wall time      1.09 sec
HOMO = 0.569683907791  LUMO = 0.774547591894
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823256  0.55648611  0.5649491   0.56968391] [0.77454759 0.77912517 0.78468867 1.11984175 1.70810359 1.70832593
 2.37427929 2.37655495 2.37739452 2.44836518 2.45168473 2.45230397
 3.53689943 3.54001681 3.71838449 3.71995944 3.72041823 4.60534352
 4.60715618 4.60870805 8.68226374 9.01323523]
   1 ( 0.000  0.000  0.500)   [-0.05413089  0.04171863  0.44623037  0.45411063] [0.90552609 0.9092399  0.92942109 1.29164751 1.67221972 1.86345341
 1.86548781 2.01770073 2.01914038 2.63026814 2.86487675 2.90392762
 2.90479871 2.95101525 2.95202208 3.24883887 3.59222131 3.59322752
 4.4905381  4.49146038 9.02632747 9.07132326]
   2 ( 0.000  0.500  0.000)   [-0.05413116  0.04172074  0.44622872  0.45411073] [0.9055256  0.90923886 0.92942257 1.29164885 1.67222017 1.86345274
 1.86548389 2.01769946 2.01913892 2.63027431 2.86487803 2.90392878
 2.90479914 2.95101481 2.95202077 3.24883008 3.59221901 3.59323035
 4.4905429  4.49145946 9.02632718 9.07132314]
   3 ( 0.000  0.500  0.500)   [0.05607396 0.05914722 0.31089943 0.31918178] [0.80608482 0.81832523 1.22742227 1.22770342 1.67536843 1.6785244
 1.99604627 1.99672834 2.30682031 2.30902371 2.76485287 2.76597726
 2.95644624 2.95653356 2.99691604 3.00058359 3.40206849 3.40323307
 4.71034398 4.71231885 9.02590856 9.02633832]
nelec by numeric integration = 7.999999999846839
    CPU time for vxc     14.00 sec, wall time      0.68 sec
    CPU time for vj and vk      8.21 sec, wall time      0.41 sec
E1 = (4.165531897307965+5.22505364153142e-18j)  Ecoul = (1.2397178048544697+2.7730038540329007e-26j)  Exc = -3.306818981567963
cycle= 2 E= -10.7104423773916  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     25.90 sec, wall time      1.27 sec
HOMO = 0.575297542876  LUMO = 0.779930938102
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343171  0.56308014  0.57102318  0.57529754] [0.77993094 0.78431394 0.78989649 1.12771639 1.71172151 1.71189522
 2.380211   2.3821997  2.38283904 2.45569117 2.45874894 2.45938947
 3.5425508  3.54556135 3.72517535 3.72656656 3.72689325 4.61193856
 4.61361196 4.61519896 8.69868257 9.02928613]
   1 ( 0.000  0.000  0.500)   [-0.04874979  0.04515884  0.45231194  0.45951785] [0.91067744 0.91469721 0.93574779 1.29962668 1.67872765 1.8693667
 1.87099702 2.02146986 2.02300391 2.63471615 2.87121375 2.9113579
 2.91206587 2.95699568 2.95786046 3.25530483 3.59791894 3.5989092
 4.49657828 4.49757853 9.04235057 9.08717094]
   2 ( 0.000  0.500  0.000)   [-0.04874991  0.04516077  0.45231022  0.45951803] [0.91067701 0.91469624 0.93574934 1.29962799 1.67872804 1.86936593
 1.87099315 2.02146852 2.02300243 2.63472219 2.87121482 2.911359
 2.91206632 2.95699543 2.95785926 3.25529632 3.5979167  3.59891187
 4.49658304 4.49757767 9.0423503  9.08717077]
   3 ( 0.000  0.500  0.500)   [0.06140994 0.06333656 0.31628863 0.32378211] [0.80986906 0.8229955  1.23521936 1.23561662 1.68271731 1.68607733
 2.00033573 2.00101179 2.31115378 2.31294504 2.77210611 2.77308509
 2.96178642 2.96199164 3.00305091 3.00623047 3.40834843 3.40914686
 4.71685633 4.71852106 9.0418812  9.04234739]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc     14.38 sec, wall time      0.70 sec
    CPU time for vj and vk      8.94 sec, wall time      0.42 sec
E1 = (4.170645480608016+5.221840764494745e-18j)  Ecoul = (1.2320358469868575-1.040223544060635e-25j)  Exc = -3.3043093367233665
cycle= 3 E= -10.7105011071146  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3     26.94 sec, wall time      1.30 sec
HOMO = 0.575156432647  LUMO = 0.779856439074
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350468  0.56288599  0.57084273  0.57515643] [0.77985644 0.78421027 0.78980054 1.12763458 1.7116399  1.71181619
 2.38011452 2.38208598 2.38270242 2.45545998 2.45855814 2.45917879
 3.54243813 3.54543321 3.72497028 3.72637984 3.72674143 4.61180629
 4.61344517 4.61504113 8.69813743 9.02875121]
   1 ( 0.000  0.000  0.500)   [-0.04881867  0.04506359  0.45214569  0.45936751] [0.9105659  0.91460359 0.93566357 1.29947733 1.67853237 1.86920122
 1.87083672 2.02141012 2.02290599 2.6346048  2.87107336 2.91118082
 2.91185084 2.95683796 2.95774164 3.25515874 3.59777172 3.59876198
 4.4964172  4.49742713 9.04181652 9.0866387 ]
   2 ( 0.000  0.500  0.000)   [-0.04881882  0.04506557  0.45214398  0.45936766] [0.91056545 0.91460258 0.93566511 1.29947867 1.67853277 1.86920046
 1.87083284 2.02140878 2.02290453 2.63461083 2.87107444 2.9111819
 2.9118513  2.9568377  2.95774042 3.25515021 3.59776947 3.59876465
 4.49642194 4.49742625 9.04181625 9.08663854]
   3 ( 0.000  0.500  0.500)   [0.06129086 0.0632725  0.31614996 0.32366106] [0.80982329 0.8229036  1.23502439 1.23549767 1.68250081 1.68584887
 2.00023134 2.00087908 2.31106004 2.31285296 2.7719397  2.77286849
 2.96163482 2.96186111 3.00289641 3.00610953 3.4082197  3.40904204
 4.71673036 4.71834248 9.04134685 9.04181305]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     14.50 sec, wall time      0.67 sec
    CPU time for vj and vk      9.15 sec, wall time      0.42 sec
E1 = (4.170518051683331+5.221471623748931e-18j)  Ecoul = (1.2322252958155053+5.679798517591285e-28j)  Exc = -3.3043714008149037
cycle= 4 E= -10.7105011513022  delta_E= -4.42e-08  |g|= 6.54e-05  |ddm|= 0.000635
    CPU time for cycle= 4     27.34 sec, wall time      1.26 sec
HOMO = 0.575156283406  LUMO = 0.779855639686
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350547  0.56288561  0.57084144  0.57515628] [0.77985564 0.78421034 0.78979951 1.12763367 1.71163946 1.7118156
 2.38011288 2.38208533 2.38270273 2.45545928 2.4585572  2.45917759
 3.54243753 3.54543241 3.72497001 3.72637886 3.72674052 4.61180497
 4.61344488 4.61504021 8.69813612 9.02874992]
   1 ( 0.000  0.000  0.500)   [-0.04881953  0.04506286  0.4521454   0.45936689] [0.91056593 0.91460266 0.93566249 1.29947652 1.67853122 1.86920037
 1.87083635 2.02140867 2.02290596 2.63460346 2.87107238 2.91117972
 2.91185045 2.95683756 2.95774009 3.25515747 3.59777154 3.59876148
 4.49641695 4.49742638 9.0418153  9.08663734]
   2 ( 0.000  0.500  0.000)   [-0.04881967  0.04506483  0.4521437   0.45936704] [0.91056549 0.91460165 0.93566403 1.29947786 1.67853162 1.86919961
 1.87083248 2.02140733 2.02290449 2.63460949 2.87107346 2.9111808
 2.91185092 2.9568373  2.95773888 3.25514894 3.59776928 3.59876415
 4.4964217  4.49742551 9.04181503 9.08663718]
   3 ( 0.000  0.500  0.500)   [0.06129007 0.06327166 0.31614971 0.32366065] [0.80982227 0.82290278 1.23502433 1.23549697 1.68249879 1.68584774
 2.00023006 2.00087882 2.31105922 2.31285248 2.77193857 2.77286799
 2.96163448 2.96185961 3.0028963  3.00610847 3.40821958 3.40904092
 4.71672892 4.71834268 9.04134525 9.04181204]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc     14.77 sec, wall time      0.66 sec
    CPU time for vj and vk     10.71 sec, wall time      0.49 sec
E1 = (4.170517772301831+5.221328574817335e-18j)  Ecoul = (1.2322257044816316+3.539776653907724e-26j)  Exc = -3.30437152974706
cycle= 5 E= -10.7105011509497  delta_E= 3.52e-10  |g|= 9.96e-05  |ddm|= 0.000173
    CPU time for cycle= 5     29.19 sec, wall time      1.33 sec
HOMO = 0.57515625391  LUMO = 0.779855540622
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350558  0.56288553  0.57084126  0.57515625] [0.77985554 0.78421031 0.78979937 1.12763353 1.71163939 1.71181551
 2.38011268 2.38208522 2.38270272 2.45545915 2.45855708 2.45917742
 3.54243744 3.54543229 3.72496995 3.72637872 3.72674041 4.61180479
 4.6134448  4.61504007 8.69813592 9.02874973]
   1 ( 0.000  0.000  0.500)   [-0.04881964  0.04506275  0.45214533  0.45936679] [0.9105659  0.91460253 0.93566235 1.2994764  1.67853107 1.86920024
 1.87083628 2.02140849 2.02290592 2.63460329 2.87107224 2.91117957
 2.91185036 2.95683749 2.9577399  3.2551573  3.59777148 3.59876139
 4.49641689 4.49742627 9.04181511 9.08663714]
   2 ( 0.000  0.500  0.000)   [-0.04881979  0.04506472  0.45214363  0.45936695] [0.91056545 0.91460152 0.93566389 1.29947774 1.67853147 1.86919948
 1.8708324  2.02140715 2.02290446 2.63460932 2.87107332 2.91118065
 2.91185082 2.95683723 2.95773869 3.25514878 3.59776923 3.59876406
 4.49642163 4.49742539 9.04181484 9.08663698]
   3 ( 0.000  0.500  0.500)   [0.06128997 0.06327153 0.31614965 0.32366059] [0.80982212 0.82290267 1.23502426 1.23549689 1.6824985  1.68584758
 2.0002299  2.00087876 2.3110591  2.31285241 2.77193843 2.77286789
 2.96163438 2.96185944 3.00289626 3.00610833 3.40821954 3.40904076
 4.71672874 4.71834266 9.04134456 9.04181232]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     15.34 sec, wall time      0.69 sec
    CPU time for vj and vk      9.32 sec, wall time      0.42 sec
E1 = (4.1705177203245665+5.2215670256206914e-18j)  Ecoul = (1.2322257831126464-1.2533422062151436e-26j)  Exc = -3.3043715549470765
Extra cycle  E= -10.7105011494959  delta_E= 1.45e-09  |g|= 0.000182  |ddm|= 0.000297
    CPU time for scf_cycle    185.41 sec, wall time      8.83 sec
    CPU time for SCF    188.35 sec, wall time      9.00 sec
converged SCF energy = -10.7105011494959
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0-k0-60.0/47995840/scf.h5
