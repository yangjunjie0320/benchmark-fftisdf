SLURMD_NODENAME = hpc-34-09
Start time = Thu Mar 13 04:24:39 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0/47995834/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0/47995834/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 = None

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
Pivoted Cholesky rank = 361, estimated error = 0.00e+00
Parent grid size = 1089, selected grid size = 520
    CPU time for interpolating functions     13.40 sec, wall time      1.18 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      1.03 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      8.23 sec, wall time      1.33 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel    163.01 sec, wall time     12.16 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 327 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     73.08 sec, wall time      5.54 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     72.41 sec, wall time      5.05 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel     70.81 sec, wall time      4.72 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 326 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0/47995834/tmppl2rohor
    CPU time for building ISDF    395.24 sec, wall time     29.43 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0/47995834/tmp8bv5j8ob
max_memory 81920 MB (current use 267 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f7535b24be0>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc     11.68 sec, wall time      0.79 sec
    CPU time for vj and vk     11.89 sec, wall time      0.81 sec
E1 = (4.673183787659303+1.6153474327570208e-17j)  Ecoul = (1.476464072135772+2.331033469502186e-33j)  Exc = -3.391478696244522
init E= -10.0507039344355
    CPU time for initialize scf     37.63 sec, wall time      2.62 sec
HOMO = 0.617030886385  LUMO = 0.803935095462
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655503  0.61115235  0.6113933   0.61703089] [0.8039351  0.80814583 0.81092469 1.13007621 1.733324   1.73555786
 2.40667568 2.40722624 2.40801267 2.50110575 2.50172888 2.50205506
 3.567843   3.56831878 3.76713916 3.76715715 3.76793143 4.64475147
 4.64490382 4.64501595 8.8419399  9.17010907]
   1 ( 0.000  0.000  0.500)   [-0.03769176  0.06166658  0.49459534  0.5013058 ] [0.93252808 0.93680386 0.94439121 1.33410264 1.72140327 1.90372698
 1.90506789 2.04477295 2.04669099 2.65774092 2.90263002 2.95423659
 2.95472539 2.98948725 2.99038275 3.28772159 3.62664398 3.62703125
 4.52705979 4.52715917 9.18282277 9.22708975]
   2 ( 0.000  0.500  0.000)   [-0.03769166  0.06166806  0.49459351  0.50130668] [0.93252267 0.93680185 0.94438846 1.33411413 1.72140135 1.90372491
 1.90506778 2.04477415 2.04668986 2.6577384  2.90263007 2.95423684
 2.95472506 2.98948627 2.99038405 3.28771819 3.626647   3.62703028
 4.52706008 4.52716012 9.18282449 9.22709068]
   3 ( 0.000  0.500  0.500)   [0.07640264 0.07937465 0.34926349 0.36058513] [0.82049697 0.82899945 1.27130552 1.27175717 1.72864231 1.72939643
 2.03063282 2.03250459 2.33430228 2.33445487 2.81522269 2.81661386
 2.9876965  2.98878157 3.03482996 3.03570902 3.43441813 3.4350635
 4.75293078 4.75323534 9.18254066 9.18255252]
nelec by numeric integration = 7.999999999848202
    CPU time for vxc     17.10 sec, wall time      1.17 sec
    CPU time for vj and vk     10.27 sec, wall time      0.71 sec
E1 = (4.20508269499762+3.17325262312799e-18j)  Ecoul = (1.18453818779738-5.695045621167397e-24j)  Exc = -3.288182062118618
cycle= 1 E= -10.7074342773097  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1     27.50 sec, wall time      1.89 sec
HOMO = 0.569687740024  LUMO = 0.774540319029
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823446  0.55648654  0.56495023  0.56968774] [0.77454032 0.77912601 0.78469353 1.11984806 1.70809843 1.70832456
 2.37427659 2.37655461 2.37739369 2.44836536 2.45168566 2.45230775
 3.53690104 3.5400177  3.71837734 3.71995297 3.72040972 4.60533824
 4.60715173 4.60870479 8.68226123 9.01322986]
   1 ( 0.000  0.000  0.500)   [-0.05412977  0.04171803  0.44622988  0.45411266] [0.90552708 0.90924236 0.92942691 1.29164615 1.67222139 1.8634523
 1.86548831 2.01770047 2.01914048 2.6302705  2.86487881 2.90392655
 2.90479722 2.95101194 2.95202091 3.24884359 3.59221869 3.59323059
 4.49053605 4.49145489 9.02632138 9.07131641]
   2 ( 0.000  0.500  0.000)   [-0.05413085  0.04171856  0.44623087  0.4541121 ] [0.90552458 0.90924057 0.92942564 1.29165247 1.67221894 1.8634517
 1.86548596 2.01770195 2.0191393  2.63027022 2.8648776  2.90392738
 2.90479887 2.95101177 2.95201815 3.24883986 3.59222143 3.59322886
 4.4905371  4.49145663 9.02632249 9.07131778]
   3 ( 0.000  0.500  0.500)   [0.05607278 0.05914882 0.31090021 0.31918148] [0.80608193 0.81832757 1.22742163 1.2277037  1.67536918 1.6785234
 1.99604464 1.99673063 2.30681411 2.30902445 2.76485476 2.76597864
 2.95644603 2.95653683 2.99691575 3.00058289 3.40207197 3.40323453
 4.71033145 4.71231504 9.02590297 9.02633354]
nelec by numeric integration = 7.999999999846839
    CPU time for vxc     16.33 sec, wall time      1.19 sec
    CPU time for vj and vk     10.54 sec, wall time      0.68 sec
E1 = (4.165531848116695+3.1257702698382404e-18j)  Ecoul = (1.2397178498217607+1.234283326745004e-25j)  Exc = -3.306817594245657
cycle= 2 E= -10.7104409942933  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2     32.03 sec, wall time      2.22 sec
HOMO = 0.575301117674  LUMO = 0.779923639996
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343371  0.5630805   0.57102424  0.57530112] [0.77992364 0.78431459 0.78990111 1.1277226  1.71171631 1.71189392
 2.3802083  2.38219919 2.38283802 2.45569129 2.4587499  2.45939305
 3.54255229 3.54556211 3.72516838 3.72655983 3.72688465 4.61193316
 4.61360737 4.61519543 8.6986798  9.02928038]
   1 ( 0.000  0.000  0.500)   [-0.04874891  0.04515828  0.45231138  0.45951955] [0.910678   0.91469933 0.93575358 1.29962521 1.67872928 1.86936555
 1.87099733 2.02146957 2.02300401 2.63471836 2.87121573 2.91135664
 2.91206411 2.95699244 2.95785908 3.25530945 3.59791612 3.59891207
 4.49657619 4.49757285 9.04234408 9.08716373]
   2 ( 0.000  0.500  0.000)   [-0.04874956  0.04515818  0.45231224  0.4595193 ] [0.91067591 0.91469787 0.93575246 1.29963108 1.6787266  1.8693647
 1.87099497 2.02147087 2.02300255 2.63471811 2.8712142  2.91135755
 2.91206589 2.95699251 2.95785661 3.2553059  3.59791892 3.59891031
 4.49657714 4.4975746  9.04234532 9.08716504]
   3 ( 0.000  0.500  0.500)   [0.06140874 0.0633379  0.31628929 0.32378169] [0.80986595 0.82299789 1.23521848 1.23561669 1.68271793 1.68607618
 2.00033407 2.00101392 2.31114765 2.31294572 2.77210782 2.77308622
 2.96178947 2.96199163 3.00305073 3.00622984 3.40835172 3.40914807
 4.71684372 4.71851725 9.04187526 9.04234233]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc     12.75 sec, wall time      0.82 sec
    CPU time for vj and vk     14.64 sec, wall time      0.91 sec
E1 = (4.170645260169644+3.0830749949933772e-18j)  Ecoul = (1.2320361503516895-3.216028138405021e-26j)  Exc = -3.304308033455822
cycle= 3 E= -10.7104997209206  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3     30.59 sec, wall time      1.94 sec
HOMO = 0.575160035282  LUMO = 0.77984913807
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350668  0.56288635  0.57084381  0.57516004] [0.77984914 0.78421092 0.78980516 1.1276408  1.71163472 1.7118149
 2.38011182 2.38208548 2.38270141 2.45546011 2.45855913 2.4591824
 3.54243962 3.54543398 3.72496333 3.72637312 3.72673287 4.61180092
 4.61344061 4.61503761 8.69813473 9.02874552]
   1 ( 0.000  0.000  0.500)   [-0.04881778  0.04506302  0.45214513  0.45936924] [0.91056649 0.91460569 0.93566936 1.29947588 1.67853402 1.86920007
 1.87083706 2.02140985 2.02290609 2.63460703 2.87107535 2.91117957
 2.91184911 2.95683473 2.95774031 3.2551634  3.59776891 3.59876486
 4.49641512 4.49742146 9.04181009 9.08663155]
   2 ( 0.000  0.500  0.000)   [-0.04881849  0.04506301  0.452146    0.45936893] [0.91056435 0.91460422 0.93566823 1.29948178 1.67853137 1.86919925
 1.87083469 2.02141117 2.02290468 2.63460678 2.87107385 2.91118047
 2.91185088 2.95683477 2.95773778 3.2551598  3.59777171 3.5987631
 4.49641608 4.49742323 9.04181134 9.08663288]
   3 ( 0.000  0.500  0.500)   [0.06128964 0.06327387 0.31615061 0.32366066] [0.80982019 0.82290597 1.23502353 1.23549776 1.68250145 1.68584774
 2.00022971 2.00088122 2.3110539  2.31285366 2.77194144 2.77286963
 2.9616379  2.9618611  3.00289624 3.00610892 3.40822301 3.40904329
 4.71671778 4.71833871 9.04134086 9.04180817]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc     12.39 sec, wall time      0.80 sec
    CPU time for vj and vk      9.48 sec, wall time      0.63 sec
E1 = (4.170517848995+3.0833838654281244e-18j)  Ecoul = (1.2322255727487466+3.6319156076375384e-26j)  Exc = -3.3043700887138288
cycle= 4 E= -10.7104997649562  delta_E= -4.4e-08  |g|= 8.73e-05  |ddm|= 0.000642
    CPU time for cycle= 4     25.15 sec, wall time      1.63 sec
HOMO = 0.57515988995  LUMO = 0.779848391554
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350741  0.562886    0.57084259  0.57515989] [0.77984839 0.78421099 0.7898042  1.12763995 1.7116343  1.71181434
 2.38011029 2.38208487 2.3827017  2.45545945 2.45855825 2.45918128
 3.54243907 3.54543323 3.72496308 3.72637221 3.72673201 4.61179968
 4.61344034 4.61503675 8.69813349 9.02874431]
   1 ( 0.000  0.000  0.500)   [-0.04881858  0.04506233  0.45214487  0.45936865] [0.91056651 0.91460482 0.93566835 1.29947513 1.67853295 1.86919927
 1.87083671 2.0214085  2.02290606 2.63460578 2.87107444 2.91117854
 2.91184875 2.95683436 2.95773886 3.2551622  3.59776873 3.59876439
 4.4964149  4.49742076 9.04180894 9.08663027]
   2 ( 0.000  0.500  0.000)   [-0.04881928  0.04506231  0.45214573  0.45936835] [0.91056439 0.91460336 0.93566723 1.29948101 1.67853029 1.86919845
 1.87083435 2.02140981 2.02290464 2.63460553 2.87107293 2.91117944
 2.91185051 2.9568344  2.95773634 3.25515862 3.59777153 3.59876262
 4.49641585 4.49742253 9.04181019 9.0866316 ]
   3 ( 0.000  0.500  0.500)   [0.06128891 0.06327308 0.31615038 0.32366028] [0.80981924 0.82290521 1.23502347 1.23549711 1.68249956 1.68584667
 2.00022851 2.00088097 2.31105314 2.3128532  2.77194039 2.77286917
 2.96163755 2.96185972 3.00289614 3.00610793 3.40822289 3.40904223
 4.71671643 4.71833889 9.04133944 9.04180713]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     11.68 sec, wall time      0.75 sec
    CPU time for vj and vk     12.68 sec, wall time      0.81 sec
E1 = (4.170517585506963+3.0834244060755163e-18j)  Ecoul = (1.2322259585021347+1.563206769785957e-26j)  Exc = -3.304370210577452
cycle= 5 E= -10.7104997645544  delta_E= 4.02e-10  |g|= 0.000118  |ddm|= 0.000216
    CPU time for cycle= 5     27.48 sec, wall time      1.77 sec
HOMO = 0.575159864686  LUMO = 0.779848249439
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350756  0.56288593  0.57084236  0.57515986] [0.77984825 0.78421099 0.789804   1.12763978 1.71163422 1.71181423
 2.38010999 2.38208475 2.38270175 2.45545932 2.45855808 2.45918106
 3.54243896 3.54543308 3.72496302 3.72637203 3.72673185 4.61179944
 4.61344028 4.61503658 8.69813325 9.02874408]
   1 ( 0.000  0.000  0.500)   [-0.04881874  0.0450622   0.45214481  0.45936853] [0.91056651 0.91460465 0.93566816 1.29947498 1.67853274 1.86919911
 1.87083664 2.02140823 2.02290605 2.63460554 2.87107425 2.91117834
 2.91184867 2.95683428 2.95773858 3.25516198 3.59776869 3.59876429
 4.49641484 4.49742062 9.04180873 9.08663002]
   2 ( 0.000  0.500  0.000)   [-0.04881943  0.04506217  0.45214567  0.45936824] [0.91056439 0.91460319 0.93566703 1.29948086 1.67853009 1.86919829
 1.87083428 2.02140955 2.02290463 2.63460529 2.87107275 2.91117924
 2.91185043 2.95683433 2.95773606 3.25515839 3.59777149 3.59876253
 4.4964158  4.49742239 9.04180997 9.08663136]
   3 ( 0.000  0.500  0.500)   [0.06128877 0.06327291 0.31615032 0.3236602 ] [0.80981904 0.82290506 1.23502344 1.23549699 1.68249919 1.68584645
 2.00022828 2.00088092 2.31105299 2.3128531  2.77194019 2.77286907
 2.9616375  2.96185944 3.00289612 3.00610774 3.40822287 3.40904203
 4.71671617 4.71833892 9.0413394  9.04180669]
nelec by numeric integration = 7.999999999847134
    CPU time for vxc     12.41 sec, wall time      0.74 sec
    CPU time for vj and vk      9.31 sec, wall time      0.56 sec
E1 = (4.170517532793598+3.0833952203172377e-18j)  Ecoul = (1.2322260344062441-4.531217039589492e-26j)  Exc = -3.304370234645729
cycle= 6 E= -10.710499765432  delta_E= -8.78e-10  |g|= 2.28e-07  |ddm|= 0.000125
    CPU time for cycle= 6     25.17 sec, wall time      1.52 sec
HOMO = 0.575159861083  LUMO = 0.779848247698
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350758  0.5628859   0.57084234  0.57515986] [0.77984825 0.78421097 0.78980399 1.12763976 1.71163421 1.71181422
 2.38010999 2.38208473 2.38270172 2.45545929 2.45855808 2.45918104
 3.54243894 3.54543306 3.724963   3.72637201 3.72673185 4.61179943
 4.61344025 4.61503656 8.69813322 9.02874405]
   1 ( 0.000  0.000  0.500)   [-0.04881875  0.04506218  0.45214478  0.45936852] [0.91056649 0.91460464 0.93566815 1.29947496 1.67853273 1.86919909
 1.87083662 2.02140823 2.02290603 2.63460553 2.87107423 2.91117832
 2.91184864 2.95683426 2.95773857 3.25516197 3.59776867 3.59876428
 4.49641482 4.4974206  9.0418087  9.08662999]
   2 ( 0.000  0.500  0.000)   [-0.04881944  0.04506216  0.45214565  0.45936823] [0.91056436 0.91460317 0.93566702 1.29948085 1.67853008 1.86919827
 1.87083426 2.02140954 2.02290461 2.63460527 2.87107273 2.91117923
 2.9118504  2.95683431 2.95773605 3.25515838 3.59777147 3.59876251
 4.49641577 4.49742237 9.04180994 9.08663132]
   3 ( 0.000  0.500  0.500)   [0.06128876 0.06327289 0.3161503  0.3236602 ] [0.80981903 0.82290505 1.23502341 1.23549699 1.68249916 1.68584642
 2.00022827 2.00088089 2.31105299 2.31285308 2.77194019 2.77286904
 2.96163747 2.96185943 3.0028961  3.00610773 3.40822285 3.40904201
 4.71671617 4.71833889 9.04133937 9.04180666]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc     12.10 sec, wall time      0.72 sec
    CPU time for vj and vk     10.21 sec, wall time      0.61 sec
E1 = (4.170517521445459+3.083395509936475e-18j)  Ecoul = (1.2322260513025067-4.2213524760186784e-26j)  Exc = -3.30437024019385
Extra cycle  E= -10.710499765432  delta_E= 1.78e-15  |g|= 3.29e-07  |ddm|= 5.5e-07
    CPU time for scf_cycle    228.21 sec, wall time     14.96 sec
    CPU time for SCF    231.27 sec, wall time     15.28 sec
converged SCF energy = -10.710499765432
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-32-100-c0-20.0/47995834/scf.h5
