SLURMD_NODENAME = hpc-34-25
Start time = Thu Mar 13 04:24:44 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-80.0/47995841/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-80.0/47995841/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  8.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.22657159]
 [ 0.          0.          0.45314317]
 ...
 [-0.26162237 -0.18499492 -0.90628634]
 [-0.26162237 -0.18499492 -0.67971476]
 [-0.26162237 -0.18499492 -0.45314317]], m0 = [21 21 21]
Pivoted Cholesky rank = 370, estimated error = 0.00e+00
Parent grid size = 9261, selected grid size = 520
    CPU time for interpolating functions      2.14 sec, wall time      2.15 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      1.06 sec, wall time      1.06 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.49 sec, wall time      1.49 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 306 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.49 sec, wall time      1.49 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 306 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.46 sec, wall time      1.46 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 306 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.46 sec, wall time      1.46 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 305 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-80.0/47995841/tmpmcwoj54i
    CPU time for building ISDF      7.20 sec, wall time      7.25 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-80.0/47995841/tmp8p7hlhb7
max_memory 81920 MB (current use 111 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f3184c83d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.38 sec, wall time      0.38 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.391484111985135
init E= -10.0507093501761
    CPU time for initialize scf      1.09 sec, wall time      1.10 sec
HOMO = 0.61702990367  LUMO = 0.803934903797
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655464  0.61115104  0.61139028  0.6170299 ] [0.8039349  0.80814631 0.81092478 1.13006938 1.7333292  1.73555998
 2.40667696 2.40722459 2.40800907 2.50110768 2.50172456 2.50205431
 3.56784174 3.56831884 3.76714349 3.767155   3.76793574 4.64476411
 4.64490643 4.64502201 8.84194551 9.17012025]
   1 ( 0.000  0.000  0.500)   [-0.03769192  0.06166817  0.49459361  0.50130566] [0.93252357 0.93680103 0.94438316 1.33410018 1.72140059 1.90372389
 1.90506748 2.04477099 2.04669095 2.65773649 2.90262765 2.95423676
 2.95472407 2.98949207 2.99038328 3.28771906 3.62664651 3.62703077
 4.52706861 4.52716195 9.1828332  9.22709926]
   2 ( 0.000  0.500  0.000)   [-0.03769387  0.06167084  0.49459437  0.5013048 ] [0.93252057 0.9368012  0.94438553 1.3341006  1.72140064 1.90372684
 1.90506813 2.04477295 2.04669258 2.6577383  2.90262937 2.95423819
 2.95472366 2.98949052 2.99038383 3.28771237 3.62664462 3.62703103
 4.527068   4.52716422 9.18283393 9.22709828]
   3 ( 0.000  0.500  0.500)   [0.07640162 0.07937458 0.34926206 0.36058374] [0.82049861 0.8289969  1.27130123 1.27175452 1.72863707 1.72939717
 2.03063419 2.03250444 2.33430256 2.33445945 2.81522197 2.81661306
 2.98770098 2.98878173 3.03483445 3.03570857 3.43441687 3.43506137
 4.7529538  4.75324217 9.18254943 9.18256244]
nelec by numeric integration = 7.9999999998482
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.205084666329723+2.3402603737606276e-18j)  Ecoul = (1.1845356969393617+9.513075604451918e-24j)  Exc = -3.288182189434012
cycle= 1 E= -10.707434924151  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.80 sec, wall time      0.81 sec
HOMO = 0.569686434204  LUMO = 0.774542873414
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823237  0.55648367  0.56495006  0.56968643] [0.77454287 0.7791272  0.7846949  1.11984267 1.70810327 1.70832735
 2.37427917 2.37655426 2.3773916  2.44836282 2.45168293 2.45230399
 3.53690005 3.54001602 3.71838028 3.71995542 3.7204123  4.60534395
 4.60715035 4.60870543 8.68226213 9.0132355 ]
   1 ( 0.000  0.000  0.500)   [-0.05413032  0.04171966  0.44622887  0.45411143] [0.90552335 0.90923774 0.92942047 1.29164624 1.67221906 1.86345145
 1.86548622 2.01769896 2.01914001 2.63026655 2.86487479 2.90392623
 2.90479764 2.95101404 2.9520234  3.24883955 3.59221969 3.59322995
 4.49053512 4.49145808 9.02632764 9.07132245]
   2 ( 0.000  0.500  0.000)   [-0.05413132  0.04172021  0.44622641  0.45411312] [0.90552427 0.90923714 0.92942241 1.29164458 1.67221949 1.86345278
 1.86548833 2.01770008 2.01914011 2.63026817 2.86487894 2.90392824
 2.90479582 2.95101272 2.95202445 3.24883475 3.59221896 3.59323001
 4.4905371  4.49146007 9.02632689 9.07132055]
   3 ( 0.000  0.500  0.500)   [0.05607443 0.05914855 0.31089783 0.31918022] [0.80608425 0.81832524 1.22741837 1.22770017 1.67536566 1.67852606
 1.99604565 1.99673118 2.30682486 2.30902528 2.76485526 2.76597532
 2.95644629 2.95654397 2.99691414 3.00058494 3.4020693  3.40323475
 4.71035212 4.71232327 9.02590703 9.02633895]
nelec by numeric integration = 7.999999999846835
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.165531425917506+2.273331667897415e-18j)  Ecoul = (1.2397186805102223+1.348005514841665e-26j)  Exc = -3.3068188994964998
cycle= 2 E= -10.7104418910549  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.80 sec, wall time      0.80 sec
HOMO = 0.575300241185  LUMO = 0.77992636801
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343132  0.56307773  0.57102433  0.57530024] [0.77992637 0.78431608 0.78990288 1.12771752 1.7117213  1.71189681
 2.38021109 2.38219923 2.38283636 2.45568896 2.45874748 2.45938961
 3.5425516  3.54556071 3.7251715  3.72656283 3.72688759 4.61193941
 4.61360663 4.61519664 8.69868149 9.02928689]
   1 ( 0.000  0.000  0.500)   [-0.04874891  0.04515983  0.45231061  0.45951896] [0.91067492 0.91469514 0.93574744 1.29962559 1.67872726 1.86936496
 1.87099562 2.0214682  2.02300362 2.63471462 2.87121188 2.91135673
 2.912065   2.95699477 2.95786206 3.25530583 3.59791747 3.59891166
 4.49657565 4.49757646 9.04235121 9.08717057]
   2 ( 0.000  0.500  0.000)   [-0.04875     0.04516053  0.45230814  0.4595205 ] [0.9106758  0.91469464 0.93574938 1.299624   1.67872763 1.86936634
 1.87099785 2.02146931 2.02300388 2.63471637 2.87121605 2.91135874
 2.91206318 2.9569935  2.95786304 3.25530112 3.59791676 3.59891172
 4.49657772 4.49757838 9.04235045 9.08716868]
   3 ( 0.000  0.500  0.500)   [0.06141051 0.06333804 0.31628727 0.32378072] [0.80986861 0.82299567 1.23521576 1.23561375 1.68271478 1.68607921
 2.00033538 2.00101472 2.31115838 2.31294682 2.77210873 2.77308338
 2.96179665 2.96199205 3.00304949 3.00623207 3.40834952 3.40914866
 4.71686472 4.71852591 9.04188019 9.04234844]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.170645163742576+2.311377071139694e-18j)  Ecoul = (1.2320364694769699-8.180803131503981e-26j)  Exc = -3.3043091598814804
cycle= 3 E= -10.710500624648  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.77 sec, wall time      0.80 sec
HOMO = 0.57515912839  LUMO = 0.779851849547
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350429  0.56288359  0.57084387  0.57515913] [0.77985185 0.78421241 0.78980692 1.1276357  1.71163969 1.71181778
 2.38011462 2.38208552 2.38269975 2.45545777 2.45855666 2.45917892
 3.54243892 3.54543258 3.72496643 3.72637611 3.72673578 4.61180716
 4.61343986 4.6150388  8.69813636 9.02875195]
   1 ( 0.000  0.000  0.500)   [-0.04881782  0.04506461  0.45214437  0.4593686 ] [0.91056338 0.91460147 0.93566322 1.29947627 1.678532   1.86919949
 1.8708353  2.02140847 2.02290572 2.63460327 2.87107151 2.91117964
 2.91184998 2.95683705 2.95774323 3.25515974 3.59777025 3.59876444
 4.49641456 4.49742504 9.04181716 9.08663833]
   2 ( 0.000  0.500  0.000)   [-0.04881889  0.04506529  0.4521419   0.45937015] [0.91056427 0.91460101 0.93566518 1.29947465 1.67853235 1.86920087
 1.87083756 2.02140957 2.02290597 2.63460502 2.87107566 2.91118165
 2.91184816 2.95683579 2.95774421 3.25515502 3.59776954 3.5987645
 4.49641664 4.49742699 9.04181639 9.08663644]
   3 ( 0.000  0.500  0.500)   [0.06129143 0.06327398 0.3161486  0.32365966] [0.80982282 0.82290377 1.23502081 1.23549481 1.68249829 1.68585076
 2.000231   2.00088202 2.31106464 2.31285474 2.77194234 2.77286678
 2.96164507 2.96186151 3.002895   3.00611112 3.40822081 3.40904385
 4.71673875 4.71834735 9.0413459  9.04181404]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.170517733315166+2.311014101229912e-18j)  Ecoul = (1.232225921256952-1.7178235072092753e-26j)  Exc = -3.304371225604708
cycle= 4 E= -10.7105006690187  delta_E= -4.44e-08  |g|= 7.46e-06  |ddm|= 0.000626
    CPU time for cycle= 4      0.77 sec, wall time      0.77 sec
HOMO = 0.575158966511  LUMO = 0.779850961926
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350516  0.56288318  0.57084244  0.57515897] [0.77985096 0.7842125  0.78980578 1.12763469 1.71163921 1.71181713
 2.38011279 2.3820848  2.38270009 2.455457   2.45855562 2.4591776
 3.54243827 3.54543168 3.72496614 3.72637503 3.72673477 4.61180569
 4.61343954 4.61503778 8.69813491 9.02875054]
   1 ( 0.000  0.000  0.500)   [-0.04881876  0.04506379  0.45214405  0.45936791] [0.91056342 0.91460044 0.93566202 1.29947537 1.67853072 1.86919854
 1.87083491 2.02140686 2.02290568 2.63460179 2.87107042 2.91117842
 2.91184955 2.95683661 2.95774151 3.25515833 3.59777005 3.59876388
 4.4964143  4.49742421 9.04181582 9.08663683]
   2 ( 0.000  0.500  0.000)   [-0.04881984  0.04506447  0.45214159  0.45936946] [0.91056431 0.91459998 0.93566398 1.29947376 1.67853108 1.86919993
 1.87083716 2.02140796 2.02290593 2.63460354 2.87107457 2.91118043
 2.91184773 2.95683535 2.95774248 3.25515361 3.59776934 3.59876395
 4.49641638 4.49742617 9.04181505 9.08663494]
   3 ( 0.000  0.500  0.500)   [0.06129056 0.06327304 0.31614832 0.32365921] [0.80982169 0.82290286 1.23502075 1.23549404 1.68249604 1.6858495
 2.00022957 2.00088173 2.31106374 2.3128542  2.77194109 2.77286623
 2.96164469 2.96185986 3.00289489 3.00610996 3.40822068 3.4090426
 4.71673715 4.71834758 9.04134427 9.04181279]
nelec by numeric integration = 7.999999999847125
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.170517425991052+2.3110164449293505e-18j)  Ecoul = (1.2322263702385379+2.8064515564142716e-26j)  Exc = -3.30437136726464
cycle= 5 E= -10.7105006690211  delta_E= -2.46e-12  |g|= 2.85e-06  |ddm|= 8.14e-06
    CPU time for cycle= 5      0.78 sec, wall time      0.78 sec
HOMO = 0.575158957761  LUMO = 0.779850958866
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350518  0.56288314  0.57084241  0.57515896] [0.77985096 0.78421246 0.78980575 1.12763466 1.71163919 1.71181711
 2.38011278 2.38208477 2.38270005 2.45545696 2.45855562 2.45917757
 3.54243824 3.54543166 3.72496611 3.726375   3.72673476 4.61180567
 4.6134395  4.61503775 8.69813486 9.02875049]
   1 ( 0.000  0.000  0.500)   [-0.04881878  0.04506376  0.45214402  0.45936789] [0.91056338 0.91460042 0.93566201 1.29947535 1.67853071 1.86919851
 1.87083488 2.02140685 2.02290565 2.63460177 2.87107039 2.9111784
 2.9118495  2.95683659 2.9577415  3.25515832 3.59777001 3.59876385
 4.49641426 4.49742418 9.04181577 9.08663678]
   2 ( 0.000  0.500  0.000)   [-0.04881985  0.04506445  0.45214155  0.45936944] [0.91056427 0.91459996 0.93566396 1.29947374 1.67853106 1.86919989
 1.87083713 2.02140795 2.0229059  2.63460352 2.87107454 2.91118041
 2.91184768 2.95683533 2.95774247 3.2551536  3.59776931 3.59876392
 4.49641634 4.49742614 9.04181501 9.08663489]
   3 ( 0.000  0.500  0.500)   [0.06129055 0.063273   0.31614829 0.3236592 ] [0.80982166 0.82290285 1.23502069 1.23549404 1.682496   1.68584945
 2.00022955 2.0008817  2.31106373 2.31285417 2.77194108 2.77286619
 2.96164465 2.96185984 3.00289487 3.00610994 3.40822065 3.40904257
 4.71673714 4.71834753 9.04134422 9.04181274]
nelec by numeric integration = 7.999999999847126
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.42 sec, wall time      0.43 sec
E1 = (4.170517407650924+2.3110158992774178e-18j)  Ecoul = (1.232226397594638-3.3062738259623047e-26j)  Exc = -3.3043713762794287
Extra cycle  E= -10.71050066902  delta_E= 1.18e-12  |g|= 5.2e-06  |ddm|= 8.47e-06
    CPU time for scf_cycle      5.80 sec, wall time      5.84 sec
    CPU time for SCF      5.87 sec, wall time      5.91 sec
converged SCF energy = -10.71050066902
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-80.0/47995841/scf.h5
