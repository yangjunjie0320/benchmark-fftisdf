SLURMD_NODENAME = hpc-34-06
Start time = Thu Mar 13 04:24:37 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0/47995833/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0/47995833/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 = None

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
Pivoted Cholesky rank = 360, estimated error = 0.00e+00
Parent grid size = 1089, selected grid size = 520
    CPU time for interpolating functions      0.04 sec, wall time      0.04 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.96 sec, wall time      0.96 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.36 sec, wall time      1.37 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 328 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.35 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 327 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.34 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 327 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.35 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 327 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0/47995833/tmpomaer3jh
    CPU time for building ISDF      6.58 sec, wall time      6.63 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0/47995833/tmpn_1yl3_b
max_memory 81920 MB (current use 113 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f9984a2fd00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914794883665733
init E= -10.0507047265576
    CPU time for initialize scf      1.01 sec, wall time      1.02 sec
HOMO = 0.617030767847  LUMO = 0.803934236727
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655544  0.61115194  0.6113932   0.61703077] [0.80393424 0.80814644 0.81092548 1.13007626 1.7333237  1.73555806
 2.40667569 2.40722584 2.4080127  2.50110546 2.50172863 2.502055
 3.56784338 3.56831863 3.76713897 3.76715735 3.76793169 4.64475268
 4.64490381 4.6450158  8.84194041 9.17010939]
   1 ( 0.000  0.000  0.500)   [-0.03769232  0.06166683  0.49459519  0.50130583] [0.93252745 0.93680415 0.94439062 1.33410292 1.72140323 1.90372688
 1.90506807 2.044773   2.04669086 2.65774064 2.90263016 2.95423639
 2.95472563 2.98948747 2.99038301 3.28772176 3.62664428 3.62703115
 4.52706117 4.52715972 9.18282317 9.22709023]
   2 ( 0.000  0.500  0.000)   [-0.03769211  0.06166815  0.4945934   0.50130671] [0.93252309 0.9368024  0.94438829 1.3341136  1.72140129 1.90372469
 1.90506794 2.04477439 2.0466898  2.65773854 2.90263008 2.95423688
 2.95472507 2.98948634 2.99038412 3.28771863 3.62664652 3.62703032
 4.52705986 4.52715939 9.18282466 9.2270912 ]
   3 ( 0.000  0.500  0.500)   [0.07640221 0.07937491 0.34926323 0.36058513] [0.82049699 0.8289992  1.27130518 1.27175736 1.72864215 1.72939642
 2.03063279 2.03250455 2.33430214 2.33445503 2.81522279 2.81661417
 2.98769685 2.98878169 3.03482986 3.03570903 3.43441765 3.43506342
 4.75293066 4.75323438 9.18254083 9.18255314]
nelec by numeric integration = 7.999999999848202
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.40 sec, wall time      0.41 sec
E1 = (4.2050827240325015+2.3402354754676797e-18j)  Ecoul = (1.184538208564845+7.987431235528965e-24j)  Exc = -3.288182258119505
cycle= 1 E= -10.7074344235082  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.74 sec, wall time      0.75 sec
HOMO = 0.569687759632  LUMO = 0.774539615476
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823489  0.55648663  0.56494997  0.56968776] [0.77453962 0.77912672 0.78469376 1.11984848 1.70809795 1.7083247
 2.37427666 2.37655468 2.37739372 2.44836523 2.45168532 2.4523073
 3.53690126 3.54001761 3.71837734 3.7199527  3.72040985 4.60533851
 4.6071517  4.60870501 8.68226168 9.01322997]
   1 ( 0.000  0.000  0.500)   [-0.05413017  0.04171811  0.44623041  0.45411243] [0.90552723 0.90924151 0.92942673 1.2916468  1.67222145 1.8634524
 1.86548815 2.0177007  2.01914026 2.63027009 2.86487944 2.90392631
 2.9047975  2.95101212 2.95202112 3.24884329 3.5922189  3.59323056
 4.49053665 4.49145583 9.02632158 9.07131683]
   2 ( 0.000  0.500  0.000)   [-0.05413139  0.04171871  0.4462312   0.45411225] [0.90552486 0.90924074 0.92942583 1.29165243 1.67221881 1.86345187
 1.86548572 2.01770212 2.01913922 2.63027038 2.86487743 2.90392755
 2.90479889 2.95101215 2.95201836 3.24884037 3.59222075 3.59322897
 4.49053642 4.4914562  9.02632258 9.0713185 ]
   3 ( 0.000  0.500  0.500)   [0.0560722  0.05914895 0.31090062 0.31918141] [0.8060823  0.81832755 1.22742138 1.22770376 1.67536886 1.67852353
 1.99604499 1.99673048 2.30681441 2.30902435 2.76485488 2.76597919
 2.95644642 2.956537   2.99691536 3.00058266 3.40207208 3.40323421
 4.71033158 4.71231414 9.02590369 9.0263337 ]
nelec by numeric integration = 7.999999999846837
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.40 sec, wall time      0.41 sec
E1 = (4.165531771594994+2.2733376292877213e-18j)  Ecoul = (1.2397179971113699-1.6111695128233945e-26j)  Exc = -3.3068178203571192
cycle= 2 E= -10.7104411496368  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.74 sec, wall time      0.75 sec
HOMO = 0.575301173386  LUMO = 0.779922954398
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343413  0.56308059  0.57102398  0.57530117] [0.77992295 0.78431532 0.78990136 1.12772303 1.71171583 1.71189406
 2.38020837 2.38219929 2.38283806 2.45569115 2.45874957 2.45939261
 3.54255253 3.54556204 3.72516838 3.7265596  3.72688479 4.61193346
 4.61360735 4.61519566 8.69868029 9.02928054]
   1 ( 0.000  0.000  0.500)   [-0.04874931  0.04515837  0.45231192  0.45951933] [0.91067817 0.91469849 0.93575341 1.29962589 1.67872936 1.86936566
 1.87099718 2.02146982 2.02300381 2.63471795 2.87121638 2.91135642
 2.91206441 2.95699263 2.95785932 3.25530917 3.59791633 3.59891203
 4.49657678 4.49757384 9.04234432 9.08716418]
   2 ( 0.000  0.500  0.000)   [-0.04875009  0.04515835  0.45231257  0.45951947] [0.91067622 0.91469804 0.93575266 1.29963105 1.67872649 1.86936488
 1.87099475 2.02147106 2.02300248 2.63471828 2.87121404 2.91135772
 2.91206593 2.95699287 2.95785685 3.2553064  3.59791825 3.59891043
 4.49657646 4.49757419 9.04234546 9.08716582]
   3 ( 0.000  0.500  0.500)   [0.06140816 0.06333804 0.31628971 0.32378165] [0.80986632 0.82299786 1.23521827 1.23561677 1.68271763 1.68607633
 2.00033443 2.00101378 2.31114795 2.31294564 2.77210795 2.77308679
 2.96178964 2.96199202 3.00305035 3.00622964 3.40835185 3.40914778
 4.71684379 4.71851638 9.04187605 9.04234249]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.17064519862678+2.311376299494889e-18j)  Ecoul = (1.2320362721608569+3.557447138184675e-26j)  Exc = -3.3043082494269544
cycle= 3 E= -10.7104998766254  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3      0.75 sec, wall time      0.75 sec
HOMO = 0.5751600911  LUMO = 0.77984845553
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2635071   0.56288645  0.57084354  0.57516009] [0.77984846 0.78421166 0.7898054  1.12764122 1.71163424 1.71181504
 2.38011189 2.38208558 2.38270145 2.45545997 2.45855881 2.45918196
 3.54243987 3.54543391 3.72496333 3.7263729  3.726733   4.61180121
 4.61344059 4.61503784 8.69813522 9.02874567]
   1 ( 0.000  0.000  0.500)   [-0.04881818  0.04506312  0.45214567  0.45936901] [0.91056666 0.91460485 0.93566919 1.29947656 1.6785341  1.86920018
 1.87083691 2.0214101  2.02290589 2.63460662 2.87107599 2.91117935
 2.91184941 2.95683492 2.95774054 3.25516312 3.59776913 3.59876482
 4.49641572 4.49742244 9.04181033 9.086632  ]
   2 ( 0.000  0.500  0.000)   [-0.04881901  0.04506317  0.45214633  0.45936911] [0.91056466 0.91460439 0.93566843 1.29948175 1.67853126 1.86919943
 1.87083447 2.02141136 2.02290461 2.63460695 2.8710737  2.91118065
 2.91185092 2.95683513 2.95773802 3.2551603  3.59777104 3.59876322
 4.4964154  4.49742281 9.04181147 9.08663366]
   3 ( 0.000  0.500  0.500)   [0.06128906 0.06327401 0.31615103 0.32366062] [0.80982056 0.82290594 1.23502332 1.23549784 1.68250116 1.68584789
 2.00023008 2.00088107 2.31105421 2.31285358 2.77194158 2.77287021
 2.96163806 2.96186149 3.00289586 3.00610872 3.40822314 3.40904299
 4.71671786 4.71833784 9.04134164 9.04180834]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.17051778704191+2.3110235822146548e-18j)  Ecoul = (1.2322256949994281-5.756160253216679e-26j)  Exc = -3.3043703047741855
cycle= 4 E= -10.7104999207189  delta_E= -4.41e-08  |g|= 7.92e-05  |ddm|= 0.000639
    CPU time for cycle= 4      0.75 sec, wall time      0.75 sec
HOMO = 0.575159943113  LUMO = 0.779847689548
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350786  0.56288609  0.5708423   0.57515994] [0.77984769 0.78421173 0.78980442 1.12764036 1.71163382 1.71181447
 2.38011032 2.38208495 2.38270175 2.4554593  2.4585579  2.45918081
 3.5424393  3.54543314 3.72496308 3.72637197 3.72673212 4.61179995
 4.61344031 4.61503696 8.69813395 9.02874444]
   1 ( 0.000  0.000  0.500)   [-0.048819    0.04506241  0.4521454   0.45936841] [0.91056669 0.91460396 0.93566816 1.29947578 1.678533   1.86919937
 1.87083656 2.02140871 2.02290586 2.63460533 2.87107506 2.91117829
 2.91184904 2.95683453 2.95773905 3.25516189 3.59776895 3.59876434
 4.49641549 4.49742173 9.04180916 9.08663069]
   2 ( 0.000  0.500  0.000)   [-0.04881982  0.04506245  0.45214606  0.45936852] [0.91056469 0.9146035  0.9356674  1.29948096 1.67853015 1.86919861
 1.87083412 2.02140997 2.02290457 2.63460567 2.87107275 2.91117959
 2.91185054 2.95683475 2.95773654 3.25515908 3.59777086 3.59876273
 4.49641517 4.4974221  9.0418103  9.08663235]
   3 ( 0.000  0.500  0.500)   [0.06128831 0.06327319 0.31615079 0.32366022] [0.80981959 0.82290516 1.23502326 1.23549717 1.68249921 1.6858468
 2.00022884 2.00088082 2.31105343 2.31285311 2.7719405  2.77286973
 2.96163771 2.96186008 3.00289576 3.00610771 3.40822302 3.40904191
 4.71671647 4.71833803 9.04134023 9.04180723]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.170517517494618+2.3110090775238538e-18j)  Ecoul = (1.232226089600707-5.1585192314212404e-26j)  Exc = -3.30437042942951
cycle= 5 E= -10.7104999203203  delta_E= 3.99e-10  |g|= 0.000112  |ddm|= 0.000202
    CPU time for cycle= 5      0.75 sec, wall time      0.75 sec
HOMO = 0.575159921106  LUMO = 0.779847567085
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350799  0.56288602  0.5708421   0.57515992] [0.77984757 0.78421173 0.78980425 1.12764021 1.71163375 1.71181438
 2.38011006 2.38208484 2.38270179 2.45545918 2.45855776 2.45918062
 3.5424392  3.54543301 3.72496303 3.72637181 3.72673199 4.61179974
 4.61344025 4.61503681 8.69813375 9.02874424]
   1 ( 0.000  0.000  0.500)   [-0.04881914  0.04506229  0.45214535  0.45936831] [0.91056668 0.91460381 0.93566799 1.29947565 1.67853282 1.86919923
 1.87083649 2.02140849 2.02290584 2.63460512 2.8710749  2.91117812
 2.91184897 2.95683447 2.95773881 3.25516169 3.59776891 3.59876426
 4.49641544 4.49742161 9.04180897 9.08663048]
   2 ( 0.000  0.500  0.000)   [-0.04881996  0.04506233  0.45214601  0.45936842] [0.91056469 0.91460335 0.93566723 1.29948083 1.67852997 1.86919847
 1.87083406 2.02140974 2.02290455 2.63460546 2.87107259 2.91117942
 2.91185047 2.95683469 2.9577363  3.25515889 3.59777082 3.59876265
 4.49641512 4.49742198 9.04181011 9.08663213]
   3 ( 0.000  0.500  0.500)   [0.06128819 0.06327305 0.31615075 0.32366016] [0.80981942 0.82290503 1.23502324 1.23549707 1.6824989  1.6858466
 2.00022864 2.00088077 2.3110533  2.31285302 2.77194032 2.77286964
 2.96163767 2.96185983 3.00289574 3.00610754 3.408223   3.40904173
 4.71671625 4.71833805 9.04134018 9.04180687]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.1705174712961695+2.311019158307942e-18j)  Ecoul = (1.2322261560978114-2.295269689831056e-26j)  Exc = -3.3043704505188587
cycle= 6 E= -10.710499921111  delta_E= -7.91e-10  |g|= 2.49e-07  |ddm|= 0.000119
    CPU time for cycle= 6      0.75 sec, wall time      0.75 sec
HOMO = 0.57515991747  LUMO = 0.779847565346
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.263508    0.56288599  0.57084208  0.57515992] [0.77984757 0.7842117  0.78980423 1.12764019 1.71163374 1.71181436
 2.38011006 2.38208483 2.38270176 2.45545915 2.45855776 2.4591806
 3.54243918 3.54543299 3.724963   3.72637179 3.72673198 4.61179973
 4.61344023 4.61503679 8.69813372 9.02874421]
   1 ( 0.000  0.000  0.500)   [-0.04881915  0.04506228  0.45214532  0.4593683 ] [0.91056666 0.9146038  0.93566798 1.29947564 1.67853281 1.86919921
 1.87083647 2.02140848 2.02290582 2.63460511 2.87107488 2.91117811
 2.91184894 2.95683445 2.9577388  3.25516169 3.59776889 3.59876424
 4.49641542 4.49742159 9.04180894 9.08663045]
   2 ( 0.000  0.500  0.000)   [-0.04881997  0.04506232  0.45214598  0.4593684 ] [0.91056466 0.91460334 0.93566723 1.29948082 1.67852997 1.86919845
 1.87083404 2.02140974 2.02290454 2.63460545 2.87107258 2.91117941
 2.91185044 2.95683467 2.95773629 3.25515888 3.5977708  3.59876263
 4.4964151  4.49742196 9.04181008 9.0866321 ]
   3 ( 0.000  0.500  0.500)   [0.06128818 0.06327303 0.31615072 0.32366015] [0.8098194  0.82290502 1.2350232  1.23549707 1.68249887 1.68584658
 2.00022863 2.00088075 2.31105329 2.312853   2.77194032 2.77286961
 2.96163764 2.96185982 3.00289572 3.00610753 3.40822298 3.40904171
 4.71671624 4.71833802 9.04134014 9.04180684]
nelec by numeric integration = 7.999999999847126
    CPU time for vxc      0.33 sec, wall time      0.34 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.170517459942869+2.311019045570252e-18j)  Ecoul = (1.2322261730023645+9.34200638398931e-26j)  Exc = -3.3043704560701053
Extra cycle  E= -10.710499921111  delta_E= 5.33e-15  |g|= 3.64e-07  |ddm|= 6.11e-07
    CPU time for scf_cycle      6.25 sec, wall time      6.27 sec
    CPU time for SCF      6.31 sec, wall time      6.33 sec
converged SCF energy = -10.710499921111
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0/47995833/scf.h5
