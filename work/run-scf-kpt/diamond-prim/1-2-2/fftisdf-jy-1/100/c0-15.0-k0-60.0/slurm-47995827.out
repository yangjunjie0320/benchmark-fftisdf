SLURMD_NODENAME = hpc-35-12
Start time = Thu Mar 13 04:24:29 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-60.0/47995827/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-60.0/47995827/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  6.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.25042123]
 [ 0.          0.          0.50084245]
 ...
 [-0.28916156 -0.20446807 -1.00168491]
 [-0.28916156 -0.20446807 -0.75126368]
 [-0.28916156 -0.20446807 -0.50084245]], m0 = [19 19 19]
Pivoted Cholesky rank = 369, estimated error = 0.00e+00
Parent grid size = 6859, selected grid size = 390
    CPU time for interpolating functions      1.20 sec, wall time      1.20 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.72 sec, wall time      0.72 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.89 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.89 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.88 sec, wall time      0.88 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 333 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-60.0/47995827/tmpiexchyb0
    CPU time for building ISDF      4.49 sec, wall time      4.59 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-60.0/47995827/tmpkcn7ektq
max_memory 81920 MB (current use 107 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f2078048c10>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.391481490091865
init E= -10.0507067282829
    CPU time for initialize scf      0.99 sec, wall time      0.99 sec
HOMO = 0.617033037366  LUMO = 0.803939647922
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655382  0.61114767  0.61138678  0.61703304] [0.80393965 0.80814217 0.81092679 1.13007027 1.73333537 1.73556188
 2.40667428 2.4072239  2.40801604 2.50110671 2.50172471 2.50205616
 3.56784194 3.56831653 3.76714284 3.76716158 3.76793821 4.64475968
 4.64490986 4.64502975 8.84194567 9.1701193 ]
   1 ( 0.000  0.000  0.500)   [-0.0376927   0.06166834  0.49459136  0.5013085 ] [0.93252704 0.93680632 0.94438336 1.33409936 1.72139832 1.90372555
 1.90506825 2.0447727  2.04669345 2.65773695 2.90263055 2.95423611
 2.9547259  2.98949021 2.99038735 3.28772122 3.62664245 3.62702783
 4.52706837 4.52716526 9.18283327 9.22709923]
   2 ( 0.000  0.500  0.000)   [-0.03769383  0.06167428  0.49459272  0.50130893] [0.9325211  0.93680639 0.94438176 1.33409978 1.72140137 1.90372454
 1.90506845 2.044775   2.04669022 2.65773416 2.90262981 2.95423557
 2.95472434 2.98948981 2.9903839  3.28771506 3.62664583 3.62703025
 4.5270739  4.52716954 9.18283304 9.22709939]
   3 ( 0.000  0.500  0.500)   [0.07640305 0.07937543 0.34926017 0.36058615] [0.82050549 0.82899523 1.27129846 1.27176077 1.72863552 1.72939625
 2.03063287 2.03250307 2.33429931 2.33445913 2.81522082 2.81661621
 2.98769709 2.98878619 3.03483434 3.03571285 3.43441251 3.43505888
 4.75294116 4.75324049 9.1825495  9.18256188]
nelec by numeric integration = 7.9999999998482
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.2050849636372245+2.3401621833728523e-18j)  Ecoul = (1.184535682217174+4.407334323033584e-25j)  Exc = -3.2881786338712606
cycle= 1 E= -10.7074310860029  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.72 sec, wall time      0.72 sec
HOMO = 0.569682152513  LUMO = 0.774553424306
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823155  0.55649183  0.56494746  0.56968215] [0.77455342 0.77912583 0.78469257 1.11984223 1.70811226 1.70833012
 2.37427868 2.37655318 2.37739578 2.44836532 2.45168512 2.45230244
 3.53689866 3.54001475 3.71838483 3.71995715 3.72041824 4.60533981
 4.6071546  4.60870963 8.68226247 9.0132352 ]
   1 ( 0.000  0.000  0.500)   [-0.05413208  0.04171803  0.44623507  0.45410949] [0.90552574 0.90924401 0.92942118 1.29164334 1.67221794 1.86345179
 1.865485   2.01770219 2.01914081 2.6302683  2.86487774 2.90392591
 2.90479832 2.9510193  2.95202275 3.24883864 3.59221626 3.59322678
 4.49053651 4.49146125 9.02632652 9.07132145]
   2 ( 0.000  0.500  0.000)   [-0.05413386  0.04172243  0.44623506  0.45411347] [0.90552763 0.90923568 0.92942162 1.29164952 1.67222027 1.86345137
 1.86548489 2.01770142 2.01913724 2.63027195 2.86487718 2.90392671
 2.90479883 2.95101234 2.95202087 3.24883027 3.59221907 3.59322907
 4.49054175 4.49146596 9.02632682 9.07132133]
   3 ( 0.000  0.500  0.500)   [0.05607551 0.05914654 0.3109047  0.31917749] [0.80609331 0.81832614 1.22742107 1.22770648 1.67536523 1.67852463
 1.99604768 1.99673061 2.30682104 2.30902308 2.76485042 2.76597808
 2.95644894 2.95653821 2.99691988 3.00058844 3.40206507 3.4032297
 4.71034346 4.71231882 9.02590679 9.0263376 ]
nelec by numeric integration = 7.999999999846836
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.165531026442662+2.2731777234714313e-18j)  Ecoul = (1.239719793850835+3.903914847757743e-26j)  Exc = -3.3068157414686716
cycle= 2 E= -10.7104380191613  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.72 sec, wall time      0.73 sec
HOMO = 0.575296269897  LUMO = 0.779936945442
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343047  0.56308594  0.57102177  0.57529627] [0.77993695 0.78431498 0.78990069 1.12771715 1.71173027 1.71189952
 2.38021065 2.38219827 2.38284063 2.45569158 2.45874972 2.45938826
 3.54255029 3.54555956 3.72517569 3.72656445 3.72689358 4.61193524
 4.61361063 4.61520081 8.69868215 9.02928691]
   1 ( 0.000  0.000  0.500)   [-0.04875076  0.04515854  0.4523168   0.45951706] [0.91067747 0.91470165 0.93574796 1.299623   1.67872623 1.86936525
 1.87099474 2.0214716  2.02300441 2.63471655 2.8712151  2.91135656
 2.9120659  2.95699992 2.95786138 3.25530505 3.5979143  3.59890881
 4.49657697 4.49757959 9.04235044 9.08716991]
   2 ( 0.000  0.500  0.000)   [-0.04875255  0.04516292  0.45231676  0.45952099] [0.91067934 0.91469325 0.93574847 1.29962924 1.67872859 1.86936481
 1.87099454 2.02147082 2.02300099 2.63471999 2.87121448 2.91135725
 2.9120663  2.95699314 2.95785945 3.25529672 3.59791702 3.59891094
 4.49658223 4.49758443 9.04235074 9.08716978]
   3 ( 0.000  0.500  0.500)   [0.06141148 0.06333635 0.31629412 0.32377823] [0.80987792 0.82299641 1.23521854 1.23562001 1.68271449 1.68607785
 2.0003375  2.00101427 2.31115453 2.31294472 2.77210407 2.77308633
 2.96179129 2.96199439 3.00305473 3.00623559 3.40834529 3.409144
 4.71685577 4.71852131 9.04188025 9.04234746]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.17064484847775+2.3112247156310347e-18j)  Ecoul = (1.2320374592182355+3.6009922601528747e-26j)  Exc = -3.3043059638650827
cycle= 3 E= -10.7104967541552  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.72 sec, wall time      0.72 sec
HOMO = 0.575155162839  LUMO = 0.779862468308
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350343  0.56289183  0.57084133  0.57515516] [0.77986247 0.78421132 0.78980474 1.12763534 1.71164869 1.71182051
 2.3801142  2.38208458 2.38270402 2.45546043 2.45855891 2.4591776
 3.54243764 3.54543145 3.72497064 3.72637776 3.72674178 4.61180301
 4.61344387 4.61504298 8.69813708 9.02875205]
   1 ( 0.000  0.000  0.500)   [-0.04881963  0.04506331  0.45215059  0.45936673] [0.91056593 0.91460804 0.93566377 1.29947368 1.67853097 1.86919981
 1.87083445 2.02141187 2.02290651 2.63460522 2.87107473 2.91117953
 2.9118509  2.95684223 2.95774258 3.25515899 3.5977671  3.59876163
 4.4964159  4.49742822 9.04181646 9.08663774]
   2 ( 0.000  0.500  0.000)   [-0.04882143  0.04506772  0.45215055  0.45937064] [0.9105678  0.91459962 0.9356643  1.29947992 1.67853333 1.86919936
 1.87083425 2.02141109 2.02290311 2.63460867 2.8710741  2.9111802
 2.91185132 2.95683544 2.95774065 3.25515063 3.59776983 3.59876374
 4.49642117 4.49743305 9.04181676 9.08663761]
   3 ( 0.000  0.500  0.500)   [0.06129244 0.06327227 0.31615548 0.32365719] [0.80983212 0.82290455 1.2350236  1.23550109 1.68249801 1.68584943
 2.00023312 2.00088159 2.31106081 2.31285265 2.77193768 2.77286976
 2.96163971 2.96186389 3.00290025 3.00611466 3.40821661 3.4090392
 4.71672984 4.71834276 9.04134598 9.04181318]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      0.33 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170517435584914+2.3108566920132366e-18j)  Ecoul = (1.2322268855584337+7.38373807286867e-27j)  Exc = -3.304368021598185
cycle= 4 E= -10.7104967984409  delta_E= -4.43e-08  |g|= 4.14e-05  |ddm|= 0.00063
    CPU time for cycle= 4      0.72 sec, wall time      0.72 sec
HOMO = 0.57515501068  LUMO = 0.779861618528
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350426  0.56289144  0.57083995  0.57515501] [0.77986162 0.7842114  0.78980365 1.12763438 1.71164822 1.71181988
 2.38011245 2.38208388 2.38270435 2.45545969 2.45855791 2.45917634
 3.54243701 3.54543059 3.72497036 3.72637673 3.72674081 4.61180161
 4.61344356 4.61504201 8.6981357  9.02875069]
   1 ( 0.000  0.000  0.500)   [-0.04882053  0.04506253  0.45215029  0.45936608] [0.91056597 0.91460705 0.93566262 1.29947282 1.67852975 1.8691989
 1.87083407 2.02141033 2.02290647 2.6346038  2.87107369 2.91117836
 2.91185049 2.95684181 2.95774093 3.25515764 3.59776691 3.59876109
 4.49641565 4.49742743 9.04181517 9.0866363 ]
   2 ( 0.000  0.500  0.000)   [-0.04882234  0.04506694  0.45215025  0.45936998] [0.91056784 0.91459863 0.93566315 1.29947907 1.67853211 1.86919846
 1.87083387 2.02140955 2.02290307 2.63460725 2.87107307 2.91117903
 2.91185091 2.95683502 2.957739   3.25514928 3.59776963 3.59876321
 4.49642091 4.49743226 9.04181547 9.08663618]
   3 ( 0.000  0.500  0.500)   [0.06129161 0.06327138 0.31615521 0.32365676] [0.80983104 0.82290368 1.23502353 1.23550036 1.68249587 1.68584822
 2.00023175 2.00088131 2.31105994 2.31285214 2.77193648 2.77286924
 2.96163935 2.96186229 3.00290014 3.00611354 3.40821649 3.40903801
 4.7167283  4.71834298 9.0413444  9.041812  ]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170517141318353+2.3108675688021542e-18j)  Ecoul = (1.232227315718171-1.6509281024465335e-26j)  Exc = -3.3043681573008246
cycle= 5 E= -10.7104967982504  delta_E= 1.91e-10  |g|= 6.89e-05  |ddm|= 0.000116
    CPU time for cycle= 5      0.72 sec, wall time      0.72 sec
HOMO = 0.575154992318  LUMO = 0.779861573893
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350432  0.56289138  0.57083986  0.57515499] [0.77986157 0.78421136 0.78980357 1.1276343  1.71164819 1.71181983
 2.38011236 2.38208382 2.38270433 2.45545961 2.45855786 2.45917624
 3.54243696 3.54543052 3.72497031 3.72637664 3.72674076 4.61180152
 4.61344351 4.61504193 8.69813558 9.02875058]
   1 ( 0.000  0.000  0.500)   [-0.04882059  0.04506247  0.45215024  0.45936602] [0.91056593 0.91460698 0.93566256 1.29947276 1.67852968 1.86919883
 1.87083402 2.02141025 2.02290644 2.63460372 2.87107361 2.91117828
 2.91185042 2.95684176 2.95774084 3.25515756 3.59776686 3.59876104
 4.49641559 4.49742736 9.04181506 9.08663619]
   2 ( 0.000  0.500  0.000)   [-0.0488224   0.04506687  0.4521502   0.45936993] [0.9105678  0.91459856 0.93566308 1.299479   1.67853204 1.86919838
 1.87083382 2.02140946 2.02290304 2.63460716 2.87107299 2.91117895
 2.91185084 2.95683498 2.95773891 3.2551492  3.59776959 3.59876315
 4.49642086 4.49743219 9.04181536 9.08663606]
   3 ( 0.000  0.500  0.500)   [0.06129155 0.0632713  0.31615516 0.32365673] [0.80983096 0.82290363 1.23502348 1.23550032 1.68249571 1.68584814
 2.00023167 2.00088127 2.31105989 2.31285208 2.77193642 2.77286916
 2.96163927 2.96186223 3.00290011 3.00611347 3.40821645 3.40903792
 4.71672822 4.71834294 9.04134397 9.0418122 ]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.39 sec, wall time      0.39 sec
E1 = (4.170517108197503+2.310851015685707e-18j)  Ecoul = (1.232227365538154-5.060700479173835e-26j)  Exc = -3.3043681733031423
Extra cycle  E= -10.7104967975536  delta_E= 6.97e-10  |g|= 0.000126  |ddm|= 0.000205
    CPU time for scf_cycle      5.32 sec, wall time      5.34 sec
    CPU time for SCF      5.39 sec, wall time      5.42 sec
converged SCF energy = -10.7104967975536
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-60.0/47995827/scf.h5
