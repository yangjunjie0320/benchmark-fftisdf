SLURMD_NODENAME = hpc-34-25
Start time = Thu Mar 13 04:24:26 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-60.0/47995815/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-60.0/47995815/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.00e+01
k0 =  6.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.25042123]
 [ 0.          0.          0.50084245]
 ...
 [-0.28916156 -0.20446807 -1.00168491]
 [-0.28916156 -0.20446807 -0.75126368]
 [-0.28916156 -0.20446807 -0.50084245]], m0 = [19 19 19]
Pivoted Cholesky rank = 369, estimated error = 2.97e-03
Parent grid size = 6859, selected grid size = 260
    CPU time for interpolating functions      1.19 sec, wall time      1.19 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 260, nao = 26, cisdf =  10.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 2.02e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.52 sec, wall time      0.52 sec
eta_kpt.shape = (4, 12167, 260)
Memory used for eta_kpt = 2.02e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.57 sec, wall time      0.57 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.57 sec, wall time      0.57 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.57 sec, wall time      0.57 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.59 sec, wall time      0.59 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 259 / 260
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-60.0/47995815/tmpm6n6f75n
    CPU time for building ISDF      3.02 sec, wall time      3.03 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-60.0/47995815/tmpxdaz4bq0
max_memory 81920 MB (current use 119 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f0550215d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.37 sec, wall time      0.37 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.391492155223351
init E= -10.0507173934144
    CPU time for initialize scf      1.04 sec, wall time      1.04 sec
HOMO = 0.617054848289  LUMO = 0.80391907786
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24654851  0.61113739  0.61139829  0.61705485] [0.80391908 0.80808188 0.81090595 1.13007431 1.73330142 1.73555311
 2.40667392 2.4072145  2.40799344 2.50107366 2.50166458 2.5020468
 3.56785986 3.56831673 3.76714699 3.76718757 3.76798405 4.64474751
 4.64490383 4.6450195  8.84193929 9.17011488]
   1 ( 0.000  0.000  0.500)   [-0.03772197  0.06169847  0.49458753  0.50131605] [0.93248232 0.93677369 0.94438792 1.33410319 1.72141866 1.90368749
 1.90504652 2.04476295 2.04670691 2.65773895 2.90260956 2.95422525
 2.95470691 2.98945237 2.99038975 3.28777074 3.62664361 3.62701588
 4.52704204 4.52716729 9.18282835 9.22710295]
   2 ( 0.000  0.500  0.000)   [-0.03769962  0.06169959  0.49453762  0.5013065 ] [0.93249223 0.93682086 0.94442398 1.33412338 1.72143304 1.90368999
 1.90505693 2.04476887 2.04667204 2.65776194 2.90264246 2.95422434
 2.95471161 2.98950921 2.99039125 3.28768423 3.62662724 3.62703736
 4.52707073 4.5271669  9.18282916 9.2270949 ]
   3 ( 0.000  0.500  0.500)   [0.07638698 0.07938603 0.34925015 0.36057695] [0.82051126 0.82903064 1.27131288 1.27177669 1.7286351  1.72939683
 2.03061115 2.03250301 2.33429573 2.33445672 2.81522236 2.81662152
 2.98772015 2.98879644 3.03485089 3.03571896 3.43440985 3.43506965
 4.75298185 4.7532596  9.18254575 9.18255926]
nelec by numeric integration = 7.9999999998481925
    CPU time for vxc      0.37 sec, wall time      0.37 sec
    CPU time for vj and vk      0.39 sec, wall time      0.39 sec
E1 = (4.205066704926263+2.3402881759199873e-18j)  Ecoul = (1.1845645977362576-8.945051576482097e-26j)  Exc = -3.288211251674219
cycle= 1 E= -10.7074530469978  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.76 sec, wall time      0.76 sec
HOMO = 0.569686242663  LUMO = 0.774557141224
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26820391  0.55651676  0.56493248  0.56968624] [0.77455714 0.77909942 0.78464221 1.11986291 1.70810648 1.70834466
 2.37428699 2.37653698 2.37736964 2.44833157 2.45165111 2.45223928
 3.53693297 3.54001706 3.71845081 3.71997449 3.72045562 4.60531789
 4.60717106 4.60869776 8.68226342 9.01323866]
   1 ( 0.000  0.000  0.500)   [-0.05415647  0.04173491  0.44624644  0.45412515] [0.90547051 0.90922735 0.92943243 1.29164738 1.67224165 1.86340403
 1.86544745 2.01767605 2.01914142 2.63028889 2.86487745 2.90392009
 2.90479347 2.95102506 2.95202692 3.24885708 3.59225106 3.59324021
 4.4905393  4.49142915 9.02633108 9.07133147]
   2 ( 0.000  0.500  0.000)   [-0.05414488  0.04174698  0.44622245  0.45406752] [0.90554376 0.90922099 0.92946849 1.29170001 1.67225831 1.86343903
 1.86544979 2.01770286 2.01911844 2.63031481 2.8649111  2.90390773
 2.90478598 2.95104519 2.95207703 3.24880878 3.59221878 3.59324223
 4.49056131 4.49147028 9.02633159 9.07132725]
   3 ( 0.000  0.500  0.500)   [0.05606058 0.05912695 0.31089179 0.31917275] [0.80612797 0.81835914 1.22743709 1.22774557 1.67538067 1.67853293
 1.99600683 1.99673731 2.30682786 2.30903931 2.76486646 2.7659816
 2.95648105 2.95657591 2.9969276  3.00062187 3.40208671 3.40324781
 4.7103848  4.71235502 9.02591231 9.02634272]
nelec by numeric integration = 7.999999999846825
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.165525497234609+2.2740243218762337e-18j)  Ecoul = (1.2397301679253838+1.0115090071105902e-25j)  Exc = -3.3068417706477287
cycle= 2 E= -10.7104592034738  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.75 sec, wall time      0.75 sec
HOMO = 0.575300297993  LUMO = 0.779940242066
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340571  0.56310823  0.5710042   0.5753003 ] [0.77994024 0.78428774 0.78985032 1.12773643 1.71172189 1.71191135
 2.38021719 2.38218095 2.3828141  2.4556584  2.45871521 2.45932468
 3.542583   3.54556002 3.72523445 3.72657926 3.72692896 4.61191212
 4.61362543 4.6151884  8.69867915 9.02928634]
   1 ( 0.000  0.000  0.500)   [-0.04877782  0.045177    0.45232547  0.45952919] [0.91062101 0.91468327 0.93575713 1.29962657 1.67874878 1.86931819
 1.87095571 2.02144684 2.02300536 2.63473478 2.87121485 2.91134921
 2.91205859 2.95700408 2.95786146 3.25532174 3.59794679 3.59891974
 4.49657992 4.49754738 9.04235095 9.08717587]
   2 ( 0.000  0.500  0.000)   [-0.04876315  0.04518413  0.45230188  0.45947489] [0.910694   0.91467832 0.93579396 1.2996754  1.67876262 1.86935116
 1.87095793 2.02147133 2.022981   2.63475948 2.8712453  2.91133812
 2.91205237 2.95702189 2.95791339 3.25527519 3.59791675 3.59892243
 4.4965984  4.49758741 9.04235149 9.08717133]
   3 ( 0.000  0.500  0.500)   [0.06139424 0.06331757 0.31627939 0.32377292] [0.80990846 0.82302644 1.23523115 1.23565623 1.68272706 1.68608213
 2.00029767 2.00102001 2.31115933 2.31295893 2.77211802 2.77308765
 2.96182585 2.96202479 3.00305799 3.00626665 3.40836446 3.40916099
 4.71689255 4.71855225 9.04188171 9.04234849]
nelec by numeric integration = 7.9999999998471205
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.38 sec, wall time      0.39 sec
E1 = (4.170637515954711+2.3120389861751533e-18j)  Ecoul = (1.2320503179269038-3.479823225110927e-26j)  Exc = -3.30433263003317
cycle= 3 E= -10.7105178941376  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3      0.75 sec, wall time      0.75 sec
HOMO = 0.575159090853  LUMO = 0.779865588205
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347873  0.5629139   0.57082351  0.57515909] [0.77986559 0.78418389 0.78975413 1.12765451 1.7116404  1.71183221
 2.38012045 2.382067   2.38267736 2.455427   2.45852404 2.45911361
 3.54247021 3.54543169 3.7250291  3.72639232 3.72677693 4.61177978
 4.61345852 4.6150303  8.69813368 9.02875109]
   1 ( 0.000  0.000  0.500)   [-0.04884658  0.04508139  0.45215899  0.45937884] [0.91050952 0.91458959 0.93567288 1.2994768  1.67855335 1.86915242
 1.87079518 2.02138684 2.02290714 2.6346234  2.87107406 2.91117183
 2.91184353 2.95684626 2.9577427  3.2551755  3.59779948 3.59877236
 4.49641864 4.49739578 9.04181658 9.08664326]
   2 ( 0.000  0.500  0.000)   [-0.04883238  0.04508907  0.45213552  0.45932423] [0.91058206 0.9145843  0.93570966 1.29952595 1.67856726 1.86918566
 1.87079737 2.02141148 2.02288311 2.63464802 2.87110487 2.91116079
 2.9118371  2.95686389 2.95779421 3.25512869 3.59776935 3.59877504
 4.49643722 4.49743586 9.04181709 9.08663879]
   3 ( 0.000  0.500  0.500)   [0.06127493 0.06325321 0.31614058 0.32365171] [0.80986246 0.82293441 1.23503594 1.23553694 1.68251044 1.68585338
 2.00019305 2.00088719 2.31106546 2.31286672 2.77195137 2.77287087
 2.96167419 2.96189397 3.00290326 3.0061455  3.40823561 3.40905598
 4.71676643 4.71837352 9.04134692 9.04181392]
nelec by numeric integration = 7.999999999847121
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170510023695353+2.3116865196517125e-18j)  Ecoul = (1.2322398617768182-1.0104992651519073e-25j)  Exc = -3.3043947258221364
cycle= 4 E= -10.710517938336  delta_E= -4.42e-08  |g|= 7.2e-05  |ddm|= 0.000638
    CPU time for cycle= 4      0.75 sec, wall time      0.75 sec
HOMO = 0.575158949524  LUMO = 0.779864800041
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634795   0.56291352  0.57082225  0.57515895] [0.7798648  0.78418397 0.78975312 1.12765362 1.71163997 1.71183163
 2.38011883 2.38206636 2.38267767 2.45542632 2.45852312 2.45911245
 3.54246963 3.5454309  3.72502884 3.72639136 3.72677603 4.61177848
 4.61345823 4.6150294  8.69813239 9.02874983]
   1 ( 0.000  0.000  0.500)   [-0.04884746  0.04508073  0.45215871  0.4593782 ] [0.91050953 0.91458866 0.9356718  1.29947605 1.67855225 1.86915161
 1.87079482 2.02138544 2.02290713 2.63462209 2.87107314 2.91117075
 2.91184314 2.95684585 2.95774114 3.25517422 3.59779929 3.59877187
 4.49641841 4.49739505 9.04181539 9.08664194]
   2 ( 0.000  0.500  0.000)   [-0.04883319  0.04508829  0.45213522  0.45932365] [0.91058213 0.9145834  0.93570861 1.29952513 1.67856612 1.8691848
 1.87079703 2.02141005 2.02288304 2.63464671 2.87110388 2.91115971
 2.91183673 2.95686351 2.95779272 3.25512746 3.59776918 3.59877454
 4.49643698 4.49743513 9.0418159  9.08663745]
   3 ( 0.000  0.500  0.500)   [0.06127414 0.06325239 0.31614033 0.32365131] [0.80986148 0.8229336  1.23503588 1.23553626 1.68250835 1.68585238
 2.00019179 2.00088693 2.31106468 2.31286623 2.77195027 2.77287038
 2.96167373 2.96189264 3.00290315 3.00614447 3.40823548 3.4090549
 4.71676501 4.71837371 9.04134549 9.04181279]
nelec by numeric integration = 7.999999999847117
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170509750089629+2.3116742653223278e-18j)  Ecoul = (1.2322402625494988+2.820966597070338e-26j)  Exc = -3.3043948526132594
cycle= 5 E= -10.7105179379602  delta_E= 3.76e-10  |g|= 0.000106  |ddm|= 0.000187
    CPU time for cycle= 5      0.75 sec, wall time      0.75 sec
HOMO = 0.575158930365  LUMO = 0.779864695479
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347961  0.56291346  0.57082207  0.57515893] [0.7798647  0.78418397 0.78975298 1.12765349 1.71163991 1.71183155
 2.38011861 2.38206627 2.3826777  2.45542622 2.458523   2.45911228
 3.54246954 3.54543078 3.7250288  3.72639123 3.72677591 4.6117783
 4.61345818 4.61502927 8.69813221 9.02874966]
   1 ( 0.000  0.000  0.500)   [-0.04884757  0.04508063  0.45215867  0.45937811] [0.91050952 0.91458853 0.93567166 1.29947594 1.6785521  1.86915149
 1.87079477 2.02138525 2.02290712 2.63462191 2.871073   2.9111706
 2.91184307 2.95684579 2.95774093 3.25517405 3.59779926 3.59877179
 4.49641837 4.49739495 9.04181522 9.08664175]
   2 ( 0.000  0.500  0.000)   [-0.0488333   0.04508818  0.45213518  0.45932356] [0.91058212 0.91458328 0.93570847 1.29952501 1.67856597 1.86918468
 1.87079697 2.02140985 2.02288303 2.63464653 2.87110374 2.91115956
 2.91183667 2.95686345 2.95779252 3.2551273  3.59776914 3.59877447
 4.49643694 4.49743502 9.04181574 9.08663726]
   3 ( 0.000  0.500  0.500)   [0.06127404 0.06325226 0.31614029 0.32365126] [0.80986133 0.82293349 1.23503585 1.23553617 1.68250814 1.68585215
 2.00019162 2.00088689 2.31106456 2.31286616 2.77195012 2.77287031
 2.96167375 2.96189236 3.00290313 3.00614433 3.40823546 3.40905474
 4.71676482 4.71837373 9.04134544 9.04181248]
nelec by numeric integration = 7.999999999847119
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170509709859485+2.3116831013848816e-18j)  Ecoul = (1.232240320231459-9.440456224960892e-26j)  Exc = -3.3043948707646824
cycle= 6 E= -10.7105179386598  delta_E= -7e-10  |g|= 1.18e-06  |ddm|= 0.000112
    CPU time for cycle= 6      0.75 sec, wall time      0.75 sec
HOMO = 0.575158925212  LUMO = 0.779864693518
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26347963  0.56291344  0.57082205  0.57515893] [0.77986469 0.78418394 0.78975296 1.12765347 1.7116399  1.71183154
 2.3801186  2.38206625 2.38267767 2.45542618 2.458523   2.45911226
 3.54246953 3.54543077 3.72502877 3.72639121 3.72677591 4.61177829
 4.61345816 4.61502925 8.69813218 9.02874962]
   1 ( 0.000  0.000  0.500)   [-0.04884758  0.0450806   0.45215864  0.4593781 ] [0.9105095  0.91458852 0.93567165 1.29947592 1.67855208 1.86915146
 1.87079475 2.02138523 2.0229071  2.6346219  2.87107297 2.91117058
 2.91184304 2.95684578 2.95774093 3.25517405 3.59779924 3.59877177
 4.49641834 4.49739493 9.04181519 9.08664172]
   2 ( 0.000  0.500  0.000)   [-0.04883332  0.04508818  0.45213516  0.45932354] [0.91058209 0.91458326 0.93570846 1.29952501 1.67856596 1.86918466
 1.87079695 2.02140985 2.02288302 2.63464652 2.87110373 2.91115955
 2.91183664 2.95686343 2.9577925  3.25512728 3.59776912 3.59877445
 4.49643691 4.497435   9.04181571 9.08663723]
   3 ( 0.000  0.500  0.500)   [0.06127403 0.06325224 0.31614027 0.32365125] [0.80986131 0.82293348 1.23503582 1.23553617 1.68250811 1.68585212
 2.00019161 2.00088686 2.31106455 2.31286614 2.77195011 2.77287027
 2.96167373 2.96189235 3.00290312 3.00614432 3.40823545 3.40905472
 4.71676482 4.7183737  9.0413454  9.04181245]
nelec by numeric integration = 7.999999999847118
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170509698105762+2.311683792957149e-18j)  Ecoul = (1.2322403377533864-1.0873658717566427e-26j)  Exc = -3.3043948765329456
Extra cycle  E= -10.7105179386599  delta_E= -6.04e-14  |g|= 8.34e-07  |ddm|= 2.08e-06
    CPU time for scf_cycle      6.27 sec, wall time      6.30 sec
    CPU time for SCF      6.34 sec, wall time      6.37 sec
converged SCF energy = -10.7105179386599
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-60.0/47995815/scf.h5
