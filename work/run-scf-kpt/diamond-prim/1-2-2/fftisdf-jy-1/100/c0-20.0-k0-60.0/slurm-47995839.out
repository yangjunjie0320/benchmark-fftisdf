SLURMD_NODENAME = hpc-34-02
Start time = Thu Mar 13 04:24:44 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-60.0/47995839/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-60.0/47995839/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  6.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.25042123]
 [ 0.          0.          0.50084245]
 ...
 [-0.28916156 -0.20446807 -1.00168491]
 [-0.28916156 -0.20446807 -0.75126368]
 [-0.28916156 -0.20446807 -0.50084245]], m0 = [19 19 19]
Pivoted Cholesky rank = 369, estimated error = 0.00e+00
Parent grid size = 6859, selected grid size = 520
    CPU time for interpolating functions      1.27 sec, wall time      1.27 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      1.09 sec, wall time      1.09 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.51 sec, wall time      1.52 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 304 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.46 sec, wall time      1.46 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 304 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.47 sec, wall time      1.48 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 304 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.51 sec, wall time      1.52 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 304 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-60.0/47995839/tmpa550c76x
    CPU time for building ISDF      7.32 sec, wall time      7.41 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-60.0/47995839/tmpoq5al6pb
max_memory 81920 MB (current use 114 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7fca29797c10>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914837799150197
init E= -10.050709018106
    CPU time for initialize scf      1.06 sec, wall time      1.07 sec
HOMO = 0.617031634522  LUMO = 0.803937084425
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655432  0.61115076  0.61138828  0.61703163] [0.80393708 0.80814036 0.81092409 1.13006799 1.73332851 1.73555817
 2.40667565 2.40722519 2.40801447 2.50110693 2.50172594 2.50205477
 3.56784293 3.56831754 3.76714515 3.76716415 3.76793616 4.64476432
 4.64490815 4.64502333 8.84194603 9.17011827]
   1 ( 0.000  0.000  0.500)   [-0.03769236  0.06166991  0.49459374  0.50130621] [0.93252193 0.9368039  0.94438288 1.33409929 1.72140007 1.90372569
 1.9050691  2.04477301 2.0466917  2.6577371  2.90262922 2.95423739
 2.9547267  2.98948717 2.99038421 3.28771837 3.62664549 3.62702944
 4.52706675 4.52716466 9.18283251 9.22709849]
   2 ( 0.000  0.500  0.000)   [-0.03769236  0.06166939  0.49459167  0.50130584] [0.93252363 0.93680286 0.94438577 1.33410098 1.72140123 1.90372356
 1.90506893 2.04477358 2.04668965 2.65774071 2.90262878 2.95423708
 2.95472529 2.9894892  2.99038494 3.28771352 3.62664522 3.62702942
 4.52706757 4.52717116 9.18283246 9.22709897]
   3 ( 0.000  0.500  0.500)   [0.07640251 0.0793758  0.34926176 0.36058346] [0.82049496 0.82899698 1.27129919 1.27175898 1.72863837 1.72939552
 2.03063334 2.03250203 2.3342988  2.33445708 2.81522125 2.81661472
 2.98769534 2.98878108 3.03483299 3.03570916 3.43441649 3.43506048
 4.75294798 4.75324501 9.18254913 9.18256115]
nelec by numeric integration = 7.9999999998482
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.45 sec, wall time      0.45 sec
E1 = (4.205084428854072+2.3401369159182443e-18j)  Ecoul = (1.1845359806417302+1.1163959530687759e-26j)  Exc = -3.288181520925135
cycle= 1 E= -10.7074342094154  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.81 sec, wall time      0.82 sec
HOMO = 0.569683452137  LUMO = 0.774546758474
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823248  0.55648711  0.56495018  0.56968345] [0.77454676 0.77912517 0.7846881  1.11984211 1.70810256 1.70832633
 2.37427961 2.37655419 2.37739429 2.44836424 2.45168501 2.4523041
 3.53689943 3.54001572 3.71838312 3.7199586  3.72041842 4.60534321
 4.60715496 4.60870733 8.68226337 9.0132355 ]
   1 ( 0.000  0.000  0.500)   [-0.05413099  0.04171841  0.44623056  0.45411207] [0.90552637 0.90923906 0.92942151 1.29164654 1.67221917 1.86345361
 1.8654867  2.01770061 2.01914083 2.6302678  2.86487648 2.90392802
 2.90479877 2.95101603 2.95202144 3.2488401  3.59222029 3.59322772
 4.49053642 4.49146085 9.02632772 9.07132241]
   2 ( 0.000  0.500  0.000)   [-0.05413102  0.04172049  0.44622953  0.45410983] [0.90552589 0.90924001 0.92942225 1.29164815 1.67222124 1.86345334
 1.86548311 2.01769948 2.01913795 2.63027437 2.86487736 2.9039283
 2.90479886 2.9510136  2.95202138 3.24883039 3.5922186  3.59322906
 4.49054376 4.49145978 9.02632727 9.07132276]
   3 ( 0.000  0.500  0.500)   [0.05607427 0.05914783 0.31089974 0.31918162] [0.80608332 0.81832583 1.22742248 1.22770231 1.67536829 1.67852385
 1.99604618 1.99672832 2.30681914 2.30902308 2.76485243 2.76597704
 2.95644721 2.9565331  2.99691753 3.00058354 3.40206791 3.40323283
 4.71034041 4.71232054 9.02590748 9.02633814]
nelec by numeric integration = 7.999999999846835
    CPU time for vxc      0.38 sec, wall time      0.38 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.165532227290495+2.2732175817478293e-18j)  Ecoul = (1.2397172921274686-4.6113653075599466e-26j)  Exc = -3.3068174482565063
cycle= 2 E= -10.7104410268246  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.81 sec, wall time      0.81 sec
HOMO = 0.575297144021  LUMO = 0.779930124864
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634316   0.56308114  0.57102432  0.57529714] [0.77993012 0.78431398 0.78989592 1.12771677 1.71172052 1.71189564
 2.38021135 2.38219898 2.38283884 2.45569025 2.45874927 2.45938962
 3.54255082 3.54556029 3.72517399 3.72656575 3.7268935  4.61193832
 4.61361075 4.61519825 8.69868226 9.02928648]
   1 ( 0.000  0.000  0.500)   [-0.04874989  0.04515868  0.45231212  0.45951934] [0.91067776 0.91469638 0.93574822 1.29962578 1.67872716 1.86936692
 1.87099595 2.02146979 2.02300439 2.63471587 2.8712135  2.91135832
 2.91206596 2.95699644 2.95785986 3.25530611 3.59791796 3.59890943
 4.49657668 4.49757902 9.0423509  9.08717016]
   2 ( 0.000  0.500  0.000)   [-0.04874974  0.04516056  0.45231107  0.45951718] [0.91067737 0.9146974  0.935749   1.29962731 1.67872917 1.86936653
 1.87099241 2.02146856 2.02300147 2.63472228 2.87121417 2.91135856
 2.91206607 2.95699425 2.95785989 3.25529663 3.59791632 3.59891062
 4.49658392 4.49757801 9.04235045 9.0871705 ]
   3 ( 0.000  0.500  0.500)   [0.06141025 0.06333721 0.31628895 0.32378199] [0.80986761 0.82299609 1.23521961 1.23561554 1.68271724 1.6860768
 2.0003357  2.00101179 2.31115263 2.31294446 2.77210573 2.7730849
 2.96178602 2.96199265 3.00305241 3.0062305  3.40834784 3.40914667
 4.71685286 4.71852287 9.04188018 9.04234728]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc      0.34 sec, wall time      0.35 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170645829083373+2.3112650483725574e-18j)  Ecoul = (1.23203531856329+2.335028279454195e-27j)  Exc = -3.3043078065341733
cycle= 3 E= -10.7104997568736  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.78 sec, wall time      0.78 sec
HOMO = 0.575156035534  LUMO = 0.779855632956
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350457  0.56288701  0.57084388  0.57515604] [0.77985563 0.78421031 0.78979998 1.12763495 1.71163892 1.71181662
 2.38011487 2.38208527 2.38270223 2.45545906 2.45855847 2.45917894
 3.54243815 3.54543216 3.72496892 3.72637903 3.72674169 4.61180606
 4.61344397 4.61504043 8.69813715 9.02875158]
   1 ( 0.000  0.000  0.500)   [-0.04881877  0.04506343  0.45214588  0.45936901] [0.91056623 0.91460275 0.93566401 1.29947644 1.67853187 1.86920145
 1.87083566 2.02141006 2.02290647 2.63460452 2.87107311 2.91118125
 2.91185095 2.95683873 2.95774105 3.25516003 3.59777075 3.59876222
 4.4964156  4.49742761 9.04181687 9.08663794]
   2 ( 0.000  0.500  0.000)   [-0.04881865  0.04506537  0.45214484  0.45936682] [0.91056581 0.91460375 0.93566478 1.299478   1.67853391 1.86920107
 1.8708321  2.02140883 2.02290359 2.63461093 2.8710738  2.91118147
 2.91185106 2.95683652 2.95774106 3.25515052 3.5977691  3.59876341
 4.49642283 4.4974266  9.04181642 9.08663828]
   3 ( 0.000  0.500  0.500)   [0.06129118 0.06327315 0.31615029 0.32366093] [0.80982184 0.82290419 1.23502464 1.2354966  1.68250075 1.68584835
 2.00023132 2.00087908 2.3110589  2.31285238 2.77193932 2.77286831
 2.96163443 2.96186212 3.00289791 3.00610956 3.40821913 3.40904186
 4.71672691 4.7183443  9.04134591 9.0418129 ]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.170518402135319+2.310898439138186e-18j)  Ecoul = (1.2322247642414725-2.4612460242895568e-26j)  Exc = -3.304369869604641
cycle= 4 E= -10.7104998012139  delta_E= -4.43e-08  |g|= 2.63e-05  |ddm|= 0.000628
    CPU time for cycle= 4      0.80 sec, wall time      0.80 sec
HOMO = 0.575155876106  LUMO = 0.779854760787
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350543  0.5628866   0.57084246  0.57515588] [0.77985476 0.78421039 0.78979886 1.12763396 1.71163844 1.71181597
 2.38011308 2.38208456 2.38270257 2.45545831 2.45855745 2.45917764
 3.54243751 3.54543129 3.72496864 3.72637797 3.7267407  4.61180462
 4.61344366 4.61503942 8.69813572 9.02875019]
   1 ( 0.000  0.000  0.500)   [-0.0488197   0.04506263  0.45214557  0.45936833] [0.91056626 0.91460174 0.93566283 1.29947556 1.67853062 1.86920052
 1.87083526 2.02140848 2.02290644 2.63460307 2.87107204 2.91118005
 2.91185053 2.9568383  2.95773936 3.25515864 3.59777055 3.59876167
 4.49641534 4.4974268  9.04181555 9.08663647]
   2 ( 0.000  0.500  0.000)   [-0.04881958  0.04506456  0.45214453  0.45936614] [0.91056585 0.91460274 0.9356636  1.29947712 1.67853266 1.86920014
 1.87083171 2.02140725 2.02290355 2.63460947 2.87107273 2.91118027
 2.91185065 2.95683609 2.95773937 3.25514914 3.5977689  3.59876286
 4.49642257 4.49742579 9.0418151  9.08663681]
   3 ( 0.000  0.500  0.500)   [0.06129032 0.06327223 0.31615002 0.32366049] [0.80982073 0.8229033  1.23502458 1.23549585 1.68249854 1.68584711
 2.00022992 2.0008788  2.311058   2.31285186 2.7719381  2.77286778
 2.96163405 2.96186049 3.0028978  3.00610841 3.408219   3.40904063
 4.71672533 4.71834451 9.04134427 9.0418117 ]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.170518099625204+2.3109064386673924e-18j)  Ecoul = (1.2322252062795653-5.678536340142931e-26j)  Exc = -3.304370009051076
cycle= 5 E= -10.7104998011324  delta_E= 8.15e-11  |g|= 4.46e-05  |ddm|= 7.38e-05
    CPU time for cycle= 5      0.77 sec, wall time      0.78 sec
HOMO = 0.575155863799  LUMO = 0.779854741099
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350547  0.56288655  0.57084241  0.57515586] [0.77985474 0.78421035 0.78979881 1.12763391 1.71163841 1.71181594
 2.38011304 2.38208451 2.38270253 2.45545824 2.45855742 2.45917758
 3.54243747 3.54543124 3.7249686  3.72637792 3.72674067 4.61180457
 4.61344361 4.61503937 8.69813565 9.02875011]
   1 ( 0.000  0.000  0.500)   [-0.04881973  0.04506259  0.45214553  0.4593683 ] [0.91056623 0.9146017  0.9356628  1.29947552 1.67853059 1.86920047
 1.87083523 2.02140844 2.02290641 2.63460302 2.87107199 2.91118001
 2.91185047 2.95683827 2.95773931 3.2551586  3.59777051 3.59876163
 4.49641529 4.49742676 9.04181548 9.08663639]
   2 ( 0.000  0.500  0.000)   [-0.04881961  0.04506452  0.45214449  0.45936611] [0.91056582 0.9146027  0.93566357 1.29947708 1.67853262 1.86920009
 1.87083167 2.0214072  2.02290352 2.63460943 2.87107268 2.91118023
 2.91185059 2.95683605 2.95773933 3.2551491  3.59776886 3.59876282
 4.49642253 4.49742574 9.04181503 9.08663673]
   3 ( 0.000  0.500  0.500)   [0.06129029 0.06327218 0.31614998 0.32366047] [0.80982068 0.82290327 1.23502453 1.23549583 1.68249845 1.68584704
 2.00022988 2.00087876 2.31105797 2.31285182 2.77193807 2.77286772
 2.96163401 2.96186045 3.00289777 3.00610837 3.40821897 3.40904058
 4.7167253  4.71834447 9.04134411 9.04181171]
nelec by numeric integration = 7.999999999847131
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.1705180754872035+2.3108959771853424e-18j)  Ecoul = (1.2322252425796876+7.38373807286867e-27j)  Exc = -3.3043700209218723
Extra cycle  E= -10.7104998008411  delta_E= 2.91e-10  |g|= 8.15e-05  |ddm|= 0.000133
    CPU time for scf_cycle      5.82 sec, wall time      5.84 sec
    CPU time for SCF      5.89 sec, wall time      5.92 sec
converged SCF energy = -10.7104998008411
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-60.0/47995839/scf.h5
