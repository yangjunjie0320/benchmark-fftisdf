SLURMD_NODENAME = hpc-21-33
Start time = Thu Mar 13 04:24:23 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-20.0/47995811/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-20.0/47995811/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.00e+01
k0 =  2.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.43254576]
 [ 0.          0.          0.86509151]
 ...
 [-0.49946088 -0.35317212 -1.73018302]
 [-0.49946088 -0.35317212 -1.29763727]
 [-0.49946088 -0.35317212 -0.86509151]], m0 = [11 11 11]
Pivoted Cholesky rank = 359, estimated error = 2.45e-03
Parent grid size = 1331, selected grid size = 260
    CPU time for interpolating functions      0.06 sec, wall time      0.06 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 260, nao = 26, cisdf =  10.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 2.02e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.59 sec, wall time      0.59 sec
eta_kpt.shape = (4, 12167, 260)
Memory used for eta_kpt = 2.02e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.71 sec, wall time      0.72 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.72 sec, wall time      0.72 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.66 sec, wall time      0.66 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 259 / 260

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.72 sec, wall time      0.72 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 259 / 260
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-20.0/47995811/tmpyzrlrfia
    CPU time for building ISDF      3.63 sec, wall time      3.64 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-20.0/47995811/tmpv8hzh53d
max_memory 81920 MB (current use 117 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f0a4ccf8d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.41 sec, wall time      0.41 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3913866537123907
init E= -10.0506118919034
    CPU time for initialize scf      1.16 sec, wall time      1.16 sec
HOMO = 0.617073950058  LUMO = 0.803954845144
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24652643  0.61120146  0.61142813  0.61707395] [0.80395485 0.8081384  0.81090272 1.13005586 1.73330396 1.73555833
 2.40665221 2.40721731 2.40798985 2.50107095 2.50169395 2.50203936
 3.56781767 3.56830156 3.76715914 3.76716878 3.76796365 4.64472638
 4.64491782 4.64495947 8.84194528 9.17011426]
   1 ( 0.000  0.000  0.500)   [-0.03768404  0.06172759  0.49463728  0.50133354] [0.93251059 0.93678942 0.94438193 1.33411292 1.72140036 1.90369648
 1.90506797 2.04477394 2.04667997 2.65771417 2.9026021  2.95422951
 2.95471084 2.98948413 2.99037888 3.28769975 3.62660627 3.62702799
 4.5270193  4.52715805 9.18282826 9.22708847]
   2 ( 0.000  0.500  0.000)   [-0.03768285  0.06172406  0.49462574  0.50133033] [0.93253651 0.9367923  0.94438218 1.33413357 1.72141315 1.90370087
 1.90506184 2.04477089 2.04667276 2.65770788 2.90261209 2.95422631
 2.95471898 2.98947306 2.99036995 3.28771495 3.62661918 3.62702521
 4.52701179 4.52717299 9.18282559 9.22709499]
   3 ( 0.000  0.500  0.500)   [0.0764057  0.07943081 0.34929917 0.36059648] [0.82051661 0.82902479 1.27131057 1.27177826 1.72862866 1.72939249
 2.03061298 2.03249784 2.33427085 2.33445648 2.81522322 2.81660909
 2.98768992 2.98875571 3.03480114 3.03571367 3.43440576 3.43502573
 4.75294492 4.75323086 9.18254258 9.18255784]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.205070419590317+2.34001294401623e-18j)  Ecoul = (1.1845554998210415+2.2845411815200502e-26j)  Exc = -3.28802301515574
cycle= 1 E= -10.7072701937305  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.85 sec, wall time      0.85 sec
HOMO = 0.569720572714  LUMO = 0.774564888867
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26817744  0.55657056  0.56499123  0.56972057] [0.77456489 0.77909161 0.7846665  1.11984363 1.70809176 1.70834616
 2.37426817 2.37653549 2.3773751  2.44833151 2.45164283 2.45227299
 3.53690066 3.54001433 3.71843056 3.71997332 3.72043263 4.60533399
 4.60716804 4.60867104 8.68226712 9.01322942]
   1 ( 0.000  0.000  0.500)   [-0.05411172  0.04176079  0.44629258  0.45416247] [0.9055045  0.90922432 0.92942993 1.291654   1.67222663 1.86345119
 1.86545379 2.01770159 2.01911799 2.6302699  2.86486467 2.90392603
 2.90480257 2.95101164 2.9520387  3.24880866 3.5922124  3.59323316
 4.49052204 4.49142512 9.02632489 9.07131215]
   2 ( 0.000  0.500  0.000)   [-0.05410465  0.04176817  0.44629104  0.45414285] [0.90550189 0.90923904 0.92942384 1.29166613 1.6722357  1.86344425
 1.86546521 2.01770379 2.01912327 2.63026991 2.86487452 2.90392272
 2.90480086 2.95100841 2.95201585 3.24883412 3.59221255 3.59324112
 4.49054096 4.49143148 9.0263211  9.07131969]
   3 ( 0.000  0.500  0.500)   [0.05608247 0.05920243 0.31094452 0.31920728] [0.80609069 0.81835649 1.22744435 1.22771131 1.67536977 1.6785285
 1.99601194 1.99673026 2.30682379 2.30899923 2.7648476  2.76596994
 2.95644243 2.95653871 2.99694066 3.00057254 3.40205485 3.40324242
 4.71033152 4.71231093 9.02590037 9.02633809]
nelec by numeric integration = 7.999999999846841
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.165530574324471+2.273427614537584e-18j)  Ecoul = (1.239717454557163-5.4235764955755e-25j)  Exc = -3.306651690922087
cycle= 2 E= -10.7102767600265  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.85 sec, wall time      0.85 sec
HOMO = 0.575334236223  LUMO = 0.779946122557
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26337798  0.56316155  0.5710631   0.57533424] [0.77994612 0.78428037 0.78987328 1.12771734 1.71170771 1.71191279
 2.3801982  2.38217911 2.38281934 2.4556579  2.45870607 2.45935648
 3.54255057 3.54555748 3.7252146  3.72657663 3.7269053  4.61192735
 4.61362199 4.61515975 8.69868052 9.02927535]
   1 ( 0.000  0.000  0.500)   [-0.04873255  0.04520121  0.45237134  0.45956781] [0.91065486 0.91467992 0.93575452 1.29963153 1.67873274 1.86936373
 1.8709617  2.02147005 2.02298152 2.63471571 2.87120036 2.91135438
 2.91206769 2.95699028 2.9578738  3.25527357 3.5979077  3.59891221
 4.49656147 4.49754201 9.04234272 9.08715481]
   2 ( 0.000  0.500  0.000)   [-0.04872422  0.04520708  0.45236997  0.45954874] [0.91065285 0.91469436 0.93574894 1.29964334 1.67874095 1.86935622
 1.87097302 2.02147257 2.02298646 2.6347156  2.87120972 2.91135045
 2.91206622 2.95698587 2.95785265 3.25529823 3.59790808 3.59892123
 4.49657884 4.49754722 9.04233908 9.08716207]
   3 ( 0.000  0.500  0.500)   [0.0614157  0.06339255 0.31633191 0.32380714] [0.80987439 0.82302352 1.23523802 1.23562229 1.68271641 1.68607725
 2.00030126 2.00101298 2.31115492 2.31292022 2.7720987  2.77307643
 2.9617896  2.96198576 3.00307093 3.00621953 3.40833271 3.40915443
 4.71684195 4.71850837 9.04186786 9.04234179]
nelec by numeric integration = 7.999999999847133
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170643263014286+2.3114299407868885e-18j)  Ecoul = (1.2320367580364837+1.355136817424863e-25j)  Exc = -3.3041423743474
cycle= 3 E= -10.7103354512827  delta_E= -5.87e-05  |g|= 0.00105  |ddm|= 0.0247
    CPU time for cycle= 3      0.84 sec, wall time      0.84 sec
HOMO = 0.575192806748  LUMO = 0.779871253249
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26345104  0.5629672   0.57088228  0.57519281] [0.77987125 0.78417648 0.78977692 1.12763527 1.71162605 1.71183358
 2.38010132 2.38206501 2.38268251 2.45542647 2.45851469 2.45914533
 3.54243766 3.5454291  3.72500922 3.72638956 3.7267531  4.61179475
 4.61345493 4.61500164 8.69813474 9.02873981]
   1 ( 0.000  0.000  0.500)   [-0.04880159  0.04510563  0.45220486  0.45941718] [0.91054317 0.9145859  0.93567011 1.29948164 1.6785371  1.86919797
 1.87080107 2.02140995 2.02288336 2.63460418 2.87105956 2.91117701
 2.9118524  2.95683251 2.9577545  3.25512705 3.59776029 3.59876473
 4.49640009 4.49739023 9.04180794 9.08662201]
   2 ( 0.000  0.500  0.000)   [-0.04879339  0.04511168  0.45220354  0.45939796] [0.91054102 0.91460025 0.93566448 1.29949356 1.67854536 1.86919059
 1.87081233 2.02141256 2.02288842 2.634604   2.871069   2.9111729
 2.91185099 2.95682789 2.95773339 3.2551517  3.59776059 3.5987738
 4.49641747 4.4973955  9.0418043  9.08662929]
   3 ( 0.000  0.500  0.500)   [0.06129626 0.06332827 0.31619305 0.32368574] [0.80982825 0.82293146 1.23504274 1.23550278 1.68249897 1.68584903
 2.00019652 2.00088012 2.3110611  2.31282783 2.7719318  2.77285958
 2.96163789 2.96185483 3.00291618 3.00609827 3.40820371 3.40904933
 4.71671559 4.71832946 9.04132397 9.04181572]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.17051567468448+2.3111538330834433e-18j)  Ecoul = (1.232226469942666-5.042462015045125e-25j)  Exc = -3.3042045221425003
cycle= 4 E= -10.7103354755014  delta_E= -2.42e-08  |g|= 0.000686  |ddm|= 0.00129
    CPU time for cycle= 4      0.85 sec, wall time      0.85 sec
HOMO = 0.575192587381  LUMO = 0.779870814172
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26345147  0.56296681  0.57088152  0.57519259] [0.77987081 0.78417639 0.78977636 1.12763478 1.71162577 1.71183323
 2.3801005  2.38206459 2.38268248 2.4554259  2.45851407 2.45914457
 3.54243727 3.54542861 3.72500887 3.72638893 3.72675253 4.61179403
 4.61345461 4.61500106 8.69813357 9.02873863]
   1 ( 0.000  0.000  0.500)   [-0.04880205  0.04510522  0.45220455  0.45941674] [0.91054305 0.91458539 0.93566953 1.29948113 1.67853639 1.86919741
 1.87080073 2.02140927 2.02288324 2.63460348 2.87105898 2.91117633
 2.911852   2.95683214 2.95775369 3.25512633 3.59776003 3.59876434
 4.4963998  4.49738974 9.04180693 9.0866207 ]
   2 ( 0.000  0.500  0.000)   [-0.04879383  0.04511125  0.45220322  0.45939753] [0.91054091 0.91459974 0.93566391 1.29949303 1.67854464 1.86919003
 1.870812   2.02141187 2.02288829 2.6346033  2.87106842 2.91117223
 2.91185058 2.95682753 2.95773257 3.25515098 3.59776034 3.59877341
 4.49641718 4.497395   9.04180328 9.08662799]
   3 ( 0.000  0.500  0.500)   [0.06129583 0.06332779 0.31619278 0.32368543] [0.80982777 0.82293099 1.23504248 1.23550234 1.68249841 1.68584773
 2.00019585 2.00087986 2.3110607  2.31282745 2.77193112 2.77285912
 2.9616376  2.96185401 3.00291595 3.00609768 3.40820354 3.40904869
 4.71671482 4.71832934 9.04133384 9.0418035 ]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.170515399770493+2.3110924578369945e-18j)  Ecoul = (1.232226841783446-5.187233768371285e-25j)  Exc = -3.304204648273908
cycle= 5 E= -10.7103355047061  delta_E= -2.92e-08  |g|= 5.74e-05  |ddm|= 0.000783
    CPU time for cycle= 5      0.85 sec, wall time      0.85 sec
HOMO = 0.575192508217  LUMO = 0.779870272196
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.263452    0.56296655  0.57088065  0.57519251] [0.77987027 0.78417644 0.78977566 1.12763416 1.71162547 1.71183283
 2.38009938 2.38206415 2.3826827  2.45542544 2.45851344 2.45914377
 3.54243687 3.54542806 3.72500869 3.72638827 3.72675192 4.61179314
 4.61345442 4.61500044 8.69813272 9.0287378 ]
   1 ( 0.000  0.000  0.500)   [-0.04880264  0.04510474  0.45220435  0.45941632] [0.91054306 0.91458475 0.93566879 1.2994806  1.67853563 1.86919684
 1.8708005  2.02140829 2.02288323 2.63460258 2.87105833 2.91117558
 2.91185174 2.95683186 2.95775263 3.25512546 3.59775991 3.59876401
 4.49639964 4.49738924 9.04180614 9.08661982]
   2 ( 0.000  0.500  0.000)   [-0.04879441  0.04511074  0.45220302  0.45939713] [0.91054094 0.91459911 0.93566317 1.29949248 1.67854387 1.86918945
 1.87081177 2.02141088 2.02288826 2.63460239 2.87106775 2.91117149
 2.91185033 2.95682727 2.95773153 3.25515013 3.59776022 3.59877307
 4.49641702 4.4973945  9.0418025  9.08662711]
   3 ( 0.000  0.500  0.500)   [0.06129529 0.06332722 0.31619261 0.32368517] [0.80982708 0.82293043 1.23504245 1.23550188 1.68249702 1.68584698
 2.00019498 2.00087968 2.31106016 2.31282711 2.77193037 2.77285879
 2.96163738 2.96185298 3.00291588 3.00609697 3.40820345 3.40904793
 4.71671384 4.71832948 9.04133281 9.04180283]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.41 sec, wall time      0.41 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.1705152182322305+2.3111003445527805e-18j)  Ecoul = (1.2322271059242043+5.7113529538001255e-27j)  Exc = -3.3042047310821716
cycle= 6 E= -10.7103355049118  delta_E= -2.06e-10  |g|= 5.78e-07  |ddm|= 6.04e-05
    CPU time for cycle= 6      0.85 sec, wall time      0.85 sec
HOMO = 0.575192501617  LUMO = 0.779870270744
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26345202  0.56296653  0.57088063  0.5751925 ] [0.77987027 0.78417642 0.78977564 1.12763414 1.71162546 1.71183281
 2.38009937 2.38206414 2.38268268 2.45542541 2.45851344 2.45914375
 3.54243686 3.54542804 3.72500867 3.72638825 3.72675192 4.61179312
 4.61345439 4.61500042 8.69813269 9.02873777]
   1 ( 0.000  0.000  0.500)   [-0.04880265  0.04510472  0.45220433  0.45941631] [0.91054304 0.91458474 0.93566878 1.29948058 1.67853562 1.86919682
 1.87080048 2.02140828 2.02288321 2.63460256 2.87105831 2.91117557
 2.91185171 2.95683185 2.95775263 3.25512545 3.59775989 3.59876399
 4.49639962 4.49738922 9.04180611 9.08661979]
   2 ( 0.000  0.500  0.000)   [-0.04879442  0.04511072  0.452203    0.45939711] [0.91054092 0.91459909 0.93566316 1.29949247 1.67854386 1.86918943
 1.87081175 2.02141088 2.02288824 2.63460238 2.87106773 2.91117148
 2.9118503  2.95682725 2.95773152 3.25515012 3.5977602  3.59877305
 4.49641699 4.49739448 9.04180247 9.08662707]
   3 ( 0.000  0.500  0.500)   [0.06129529 0.0633272  0.31619259 0.32368516] [0.80982705 0.82293042 1.23504241 1.23550188 1.68249699 1.68584695
 2.00019497 2.00087966 2.31106015 2.31282709 2.77193037 2.77285876
 2.96163736 2.96185297 3.00291587 3.00609696 3.40820344 3.40904791
 4.71671384 4.71832945 9.04133278 9.0418028 ]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.41 sec, wall time      0.41 sec
    CPU time for vj and vk      0.46 sec, wall time      0.46 sec
E1 = (4.170515206272881+2.311100184066918e-18j)  Ecoul = (1.2322271237912612-6.501476036469491e-26j)  Exc = -3.304204736989902
Extra cycle  E= -10.7103355049118  delta_E= -2.31e-14  |g|= 2.57e-07  |ddm|= 9.43e-07
    CPU time for scf_cycle      7.11 sec, wall time      7.13 sec
    CPU time for SCF      7.19 sec, wall time      7.21 sec
converged SCF energy = -10.7103355049118
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0-k0-20.0/47995811/scf.h5
