SLURMD_NODENAME = hpc-35-14
Start time = Thu Mar 13 04:24:29 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-80.0/47995829/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-80.0/47995829/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  8.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.22657159]
 [ 0.          0.          0.45314317]
 ...
 [-0.26162237 -0.18499492 -0.90628634]
 [-0.26162237 -0.18499492 -0.67971476]
 [-0.26162237 -0.18499492 -0.45314317]], m0 = [21 21 21]
Pivoted Cholesky rank = 370, estimated error = 0.00e+00
Parent grid size = 9261, selected grid size = 390
    CPU time for interpolating functions      2.03 sec, wall time      2.03 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.73 sec, wall time      0.74 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.87 sec, wall time      0.88 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 331 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.89 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 331 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.87 sec, wall time      0.88 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 331 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.88 sec, wall time      0.88 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 331 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-80.0/47995829/tmp77pa_pvg
    CPU time for building ISDF      4.46 sec, wall time      4.52 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-80.0/47995829/tmp_kh54yuw
max_memory 81920 MB (current use 109 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f87d0189d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914894307849237
init E= -10.0507146689759
    CPU time for initialize scf      0.99 sec, wall time      0.99 sec
HOMO = 0.617030305849  LUMO = 0.803928175504
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655411  0.61114799  0.611384    0.61703031] [0.80392818 0.80814799 0.81092852 1.13006662 1.7333313  1.73556365
 2.40667505 2.40722207 2.40801074 2.50110263 2.50172329 2.50205566
 3.56783998 3.56831672 3.76714329 3.76715764 3.76793655 4.64476654
 4.64491071 4.64503138 8.84194624 9.17011912]
   1 ( 0.000  0.000  0.500)   [-0.03769235  0.06166703  0.49459118  0.50130655] [0.93251535 0.93680325 0.94438449 1.33409264 1.72140172 1.90372491
 1.9050683  2.04477411 2.04669427 2.65773311 2.9026315  2.95423725
 2.95472455 2.98948949 2.99038707 3.28771    3.62664448 3.62702974
 4.52706929 4.52716648 9.18283317 9.22709825]
   2 ( 0.000  0.500  0.000)   [-0.03769377  0.06166721  0.49458827  0.50130317] [0.93252189 0.93680612 0.94438917 1.33409204 1.7213994  1.90372508
 1.90506766 2.04477195 2.04669444 2.65773358 2.90262819 2.95424045
 2.95472453 2.98948568 2.99038332 3.28771105 3.62664388 3.62703166
 4.52708135 4.52717159 9.18283325 9.22709842]
   3 ( 0.000  0.500  0.500)   [0.07640256 0.07937724 0.34925286 0.36058314] [0.82049724 0.82900159 1.27129379 1.2717575  1.72863505 1.72939807
 2.0306332  2.03250648 2.3343042  2.33446003 2.81522156 2.8166142
 2.98769878 2.98878011 3.0348339  3.03570919 3.43441682 3.43506228
 4.75295001 4.75324551 9.18254965 9.18256119]
nelec by numeric integration = 7.9999999998482
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.38 sec
E1 = (4.205082922827006+2.3401137518571105e-18j)  Ecoul = (1.1845384281566556-3.9632371878303633e-26j)  Exc = -3.288192135886148
cycle= 1 E= -10.7074438828886  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.71 sec, wall time      0.72 sec
HOMO = 0.569682943946  LUMO = 0.77453767032
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2682307   0.55648389  0.56494691  0.56968294] [0.77453767 0.77913219 0.78469015 1.11984265 1.70810733 1.70833363
 2.37427824 2.37655207 2.37739218 2.4483658  2.45168026 2.45230219
 3.53689793 3.54001646 3.71838344 3.71995728 3.72041611 4.6053461
 4.60715681 4.60871225 8.68226395 9.0132362 ]
   1 ( 0.000  0.000  0.500)   [-0.05413108  0.04171504  0.44622801  0.45411022] [0.90552416 0.90922911 0.92941512 1.29164535 1.67221991 1.86345257
 1.86548936 2.01770251 2.01914267 2.63026863 2.86488286 2.90392597
 2.90479876 2.95102051 2.95201935 3.24883423 3.59221719 3.59323068
 4.49054389 4.49146287 9.02632812 9.0713221 ]
   2 ( 0.000  0.500  0.000)   [-0.05413387  0.04171787  0.44622399  0.45411015] [0.90553007 0.90923672 0.92942103 1.29163778 1.6722193  1.86344858
 1.86548934 2.01769914 2.01914032 2.63026388 2.86488232 2.90393151
 2.90479784 2.95101608 2.95202152 3.24883408 3.59221906 3.59323031
 4.49054569 4.49146813 9.02632816 9.07132229]
   3 ( 0.000  0.500  0.500)   [0.05607381 0.05914903 0.31089623 0.31917329] [0.80609106 0.81832603 1.22742031 1.22769867 1.67536417 1.67852738
 1.99604527 1.99673206 2.30682568 2.30902899 2.76485646 2.76597362
 2.95644706 2.95654433 2.99691644 3.00058474 3.40206834 3.40323838
 4.71035127 4.71232952 9.02590722 9.02633925]
nelec by numeric integration = 7.999999999846838
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.165530387597137+2.273286797097851e-18j)  Ecoul = (1.2397205193653942-2.1640032352022796e-26j)  Exc = -3.306828718616338
cycle= 2 E= -10.7104509096399  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.72 sec, wall time      0.72 sec
HOMO = 0.575296575185  LUMO = 0.77992121806
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26342974  0.56307804  0.57102092  0.57529658] [0.77992122 0.78432092 0.78989817 1.1277175  1.71172523 1.71190295
 2.38021014 2.38219699 2.3828369  2.45569176 2.45874471 2.45938785
 3.54254947 3.54556107 3.72517445 3.72656448 3.72689137 4.61194162
 4.61361272 4.61520337 8.69868302 9.0292873 ]
   1 ( 0.000  0.000  0.500)   [-0.04874975  0.04515539  0.45230974  0.45951747] [0.91067555 0.91468651 0.93574219 1.29962462 1.67872793 1.86936623
 1.87099868 2.02147168 2.02300627 2.63471652 2.87121997 2.91135635
 2.91206593 2.9570012  2.95785795 3.25530063 3.59791504 3.59891254
 4.49658432 4.49758125 9.04235142 9.08716995]
   2 ( 0.000  0.500  0.000)   [-0.04875249  0.04515799  0.4523057   0.45951742] [0.91068156 0.9146942  0.93574797 1.29961702 1.67872723 1.86936213
 1.87099888 2.0214682  2.02300397 2.63471206 2.87121932 2.91136181
 2.91206521 2.95699682 2.95785999 3.2553007  3.59791698 3.5989119
 4.49658601 4.4975864  9.04235145 9.08717015]
   3 ( 0.000  0.500  0.500)   [0.06140977 0.06333846 0.31628563 0.32377369] [0.80987533 0.82299634 1.23521765 1.23561211 1.6827131  1.68608034
 2.00033496 2.00101562 2.311159   2.31295033 2.77210982 2.77308174
 2.96179689 2.9619926  3.00305169 3.00623184 3.4083486  3.40915234
 4.71686376 4.71853191 9.04188022 9.04234839]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.37 sec, wall time      0.38 sec
E1 = (4.170644010003787+2.311328401766612e-18j)  Ecoul = (1.2320384388152545-1.0857881499462006e-25j)  Exc = -3.304318991520594
cycle= 3 E= -10.7105096406876  delta_E= -5.87e-05  |g|= 0.000975  |ddm|= 0.0247
    CPU time for cycle= 3      0.72 sec, wall time      0.72 sec
HOMO = 0.575155446029  LUMO = 0.779846692927
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350272  0.56288386  0.57084041  0.57515545] [0.77984669 0.78421722 0.78980217 1.12763566 1.71164361 1.71182391
 2.38011363 2.38208325 2.38270025 2.45546052 2.45855383 2.45917711
 3.54243677 3.54543291 3.72496934 3.72637772 3.72673951 4.61180933
 4.61344592 4.61504548 8.69813779 9.02875228]
   1 ( 0.000  0.000  0.500)   [-0.04881865  0.04506015  0.45214347  0.45936709] [0.91056398 0.91459286 0.93565794 1.29947525 1.67853262 1.86920072
 1.87083833 2.02141191 2.02290834 2.63460519 2.87107956 2.91117924
 2.91185087 2.95684345 2.9577391  3.25515452 3.59776781 3.59876529
 4.49642322 4.4974298  9.04181727 9.08663762]
   2 ( 0.000  0.500  0.000)   [-0.04882142  0.04506276  0.45213943  0.45936703] [0.91056998 0.9146005  0.93566373 1.29946767 1.67853193 1.86919663
 1.87083854 2.02140845 2.02290605 2.63460069 2.87107891 2.91118468
 2.91185015 2.95683906 2.95774113 3.25515456 3.59776972 3.59876465
 4.49642491 4.49743495 9.0418173  9.08663782]
   3 ( 0.000  0.500  0.500)   [0.06129066 0.06327437 0.31614694 0.3236526 ] [0.80982954 0.82290442 1.23502266 1.23549312 1.68249655 1.68585185
 2.00023055 2.00088288 2.31106522 2.31285825 2.77194338 2.77286511
 2.96164525 2.96186208 3.00289716 3.00611085 3.40821985 3.40904751
 4.71673775 4.71835334 9.04134546 9.04181427]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.37 sec, wall time      0.38 sec
E1 = (4.170516558550277+2.3109792030458287e-18j)  Ecoul = (1.2322279221701533-5.867231868671797e-26j)  Exc = -3.304381067400327
cycle= 4 E= -10.710509684666  delta_E= -4.4e-08  |g|= 9.75e-05  |ddm|= 0.000646
    CPU time for cycle= 4      0.72 sec, wall time      0.72 sec
HOMO = 0.575155307133  LUMO = 0.779845969791
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350343  0.56288352  0.57083924  0.57515531] [0.77984597 0.78421728 0.78980124 1.12763484 1.71164321 1.71182337
 2.38011214 2.38208266 2.38270052 2.45545989 2.45855298 2.45917603
 3.54243623 3.54543218 3.7249691  3.72637684 3.72673869 4.61180813
 4.61344565 4.61504464 8.69813659 9.02875111]
   1 ( 0.000  0.000  0.500)   [-0.04881942  0.04505948  0.45214321  0.45936652] [0.91056401 0.91459202 0.93565696 1.29947452 1.67853158 1.86919995
 1.870838   2.02141061 2.0229083  2.63460398 2.87107867 2.91117824
 2.91185051 2.95684309 2.9577377  3.25515337 3.59776763 3.59876484
 4.49642299 4.49742913 9.04181616 9.08663638]
   2 ( 0.000  0.500  0.000)   [-0.04882219  0.04506209  0.45213917  0.45936647] [0.91057001 0.91459966 0.93566275 1.29946693 1.67853089 1.86919586
 1.87083821 2.02140714 2.02290602 2.63459949 2.87107803 2.91118369
 2.9118498  2.9568387  2.95773973 3.25515341 3.59776955 3.59876419
 4.49642469 4.49743428 9.04181619 9.08663658]
   3 ( 0.000  0.500  0.500)   [0.06128995 0.06327361 0.3161467  0.32365223] [0.80982862 0.82290368 1.23502259 1.23549249 1.68249473 1.68585082
 2.00022939 2.00088265 2.31106449 2.3128578  2.77194236 2.77286466
 2.96164501 2.96186066 3.00289706 3.0061099  3.40821975 3.40904649
 4.71673645 4.71835351 9.04134434 9.04181301]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.33 sec, wall time      0.34 sec
    CPU time for vj and vk      0.37 sec, wall time      0.38 sec
E1 = (4.170516303321961+2.310962024167046e-18j)  Ecoul = (1.2322282965215139-1.0371943181845863e-25j)  Exc = -3.3043811861460575
cycle= 5 E= -10.7105096842887  delta_E= 3.77e-10  |g|= 0.000125  |ddm|= 0.000234
    CPU time for cycle= 5      0.72 sec, wall time      0.72 sec
HOMO = 0.575155278001  LUMO = 0.779845802609
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350361  0.56288343  0.57083896  0.57515528] [0.7798458  0.78421728 0.78980101 1.12763464 1.71164311 1.71182324
 2.3801118  2.38208251 2.38270058 2.45545973 2.45855278 2.45917578
 3.5424361  3.545432   3.72496904 3.72637663 3.7267385  4.61180785
 4.61344558 4.61504444 8.69813632 9.02875084]
   1 ( 0.000  0.000  0.500)   [-0.04881961  0.04505932  0.45214315  0.45936639] [0.91056401 0.91459182 0.93565674 1.29947434 1.67853134 1.86919976
 1.87083792 2.0214103  2.02290829 2.6346037  2.87107846 2.911178
 2.91185042 2.956843   2.95773737 3.2551531  3.59776759 3.59876472
 4.49642294 4.49742897 9.04181591 9.0866361 ]
   2 ( 0.000  0.500  0.000)   [-0.04882237  0.04506192  0.45213911  0.45936633] [0.91057001 0.91459946 0.93566252 1.29946676 1.67853065 1.86919567
 1.87083813 2.02140683 2.022906   2.6345992  2.87107781 2.91118345
 2.91184971 2.95683861 2.9577394  3.25515314 3.5977695  3.59876408
 4.49642463 4.49743412 9.04181594 9.08663629]
   3 ( 0.000  0.500  0.500)   [0.06128978 0.06327341 0.31614664 0.32365215] [0.8098284  0.82290351 1.23502257 1.23549235 1.6824943  1.68585056
 2.00022911 2.00088258 2.31106432 2.31285769 2.77194212 2.77286454
 2.96164489 2.96186038 3.00289704 3.00610968 3.40821971 3.40904625
 4.71673614 4.71835355 9.04134415 9.04181264]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.33 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170516242147886+2.3109733733006303e-18j)  Ecoul = (1.2322283842199502+1.18758276115592e-25j)  Exc = -3.304381213641772
cycle= 6 E= -10.71050968526  delta_E= -9.71e-10  |g|= 2.3e-07  |ddm|= 0.000131
    CPU time for cycle= 6      0.72 sec, wall time      0.72 sec
HOMO = 0.57515527391  LUMO = 0.77984580091
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350362  0.56288341  0.57083894  0.57515527] [0.7798458  0.78421726 0.789801   1.12763462 1.7116431  1.71182323
 2.38011179 2.3820825  2.38270055 2.4554597  2.45855278 2.45917575
 3.54243609 3.54543199 3.72496901 3.72637661 3.72673849 4.61180784
 4.61344556 4.61504443 8.69813628 9.02875081]
   1 ( 0.000  0.000  0.500)   [-0.04881962  0.04505931  0.45214312  0.45936638] [0.91056398 0.9145918  0.93565673 1.29947433 1.67853133 1.86919974
 1.8708379  2.02141029 2.02290827 2.63460369 2.87107844 2.91117799
 2.91185039 2.95684298 2.95773736 3.25515309 3.59776756 3.59876471
 4.49642291 4.49742895 9.04181588 9.08663606]
   2 ( 0.000  0.500  0.000)   [-0.04882238  0.04506191  0.45213908  0.45936632] [0.91056999 0.91459945 0.93566252 1.29946674 1.67853064 1.86919565
 1.87083811 2.02140683 2.02290598 2.63459919 2.87107779 2.91118344
 2.91184968 2.95683859 2.9577394  3.25515313 3.59776948 3.59876406
 4.4964246  4.4974341  9.04181591 9.08663626]
   3 ( 0.000  0.500  0.500)   [0.06128977 0.06327339 0.31614662 0.32365214] [0.80982838 0.8229035  1.23502253 1.23549236 1.68249427 1.68585054
 2.00022911 2.00088256 2.31106431 2.31285767 2.77194212 2.77286451
 2.96164487 2.96186037 3.00289702 3.00610967 3.4082197  3.40904623
 4.71673614 4.71835352 9.04134412 9.04181261]
nelec by numeric integration = 7.999999999847126
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.38 sec, wall time      0.38 sec
E1 = (4.170516230699467+2.31097261157654e-18j)  Ecoul = (1.2322284012749947-7.476508115322661e-26j)  Exc = -3.304381219248392
Extra cycle  E= -10.71050968526  delta_E= 5.33e-15  |g|= 2.91e-07  |ddm|= 5.09e-07
    CPU time for scf_cycle      6.00 sec, wall time      6.03 sec
    CPU time for SCF      6.06 sec, wall time      6.09 sec
converged SCF energy = -10.71050968526
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-80.0/47995829/scf.h5
