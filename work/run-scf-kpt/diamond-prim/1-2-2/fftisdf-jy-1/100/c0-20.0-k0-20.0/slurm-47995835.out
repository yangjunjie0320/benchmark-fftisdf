SLURMD_NODENAME = hpc-34-06
Start time = Thu Mar 13 04:24:39 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-20.0/47995835/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-20.0/47995835/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  2.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.43254576]
 [ 0.          0.          0.86509151]
 ...
 [-0.49946088 -0.35317212 -1.73018302]
 [-0.49946088 -0.35317212 -1.29763727]
 [-0.49946088 -0.35317212 -0.86509151]], m0 = [11 11 11]
Pivoted Cholesky rank = 359, estimated error = 0.00e+00
Parent grid size = 1331, selected grid size = 520
    CPU time for interpolating functions      0.05 sec, wall time      0.05 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.97 sec, wall time      0.98 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.35 sec, wall time      1.36 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 327 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.35 sec, wall time      1.36 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.35 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.34 sec, wall time      1.35 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 326 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-20.0/47995835/tmp72c8oz_p
    CPU time for building ISDF      6.61 sec, wall time      6.69 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-20.0/47995835/tmpglxq3qas
max_memory 81920 MB (current use 110 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f9a28d3fc10>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.39 sec, wall time      0.39 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914833868387584
init E= -10.0507086250298
    CPU time for initialize scf      1.01 sec, wall time      1.01 sec
HOMO = 0.617030623368  LUMO = 0.803932517802
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655613  0.61115173  0.61139179  0.61703062] [0.80393252 0.80814606 0.8109243  1.13007198 1.73332492 1.73555785
 2.40667424 2.40722546 2.40801178 2.50110542 2.5017281  2.50205487
 3.56784269 3.56831861 3.76714373 3.76716632 3.76793341 4.64475908
 4.64490964 4.6450179  8.84194599 9.17011923]
   1 ( 0.000  0.000  0.500)   [-0.03769337  0.06166793  0.49459379  0.50130506] [0.93252284 0.93680328 0.94438589 1.33410488 1.72140233 1.90372572
 1.90506892 2.04477382 2.04668912 2.65774083 2.9026293  2.95423636
 2.95472464 2.98949028 2.99038415 3.28771838 3.62664845 3.62703136
 4.52706633 4.52716521 9.18283318 9.22709861]
   2 ( 0.000  0.500  0.000)   [-0.03769248  0.06166706  0.49459377  0.50130581] [0.93252675 0.93680222 0.94438637 1.33410203 1.72140227 1.9037258
 1.90506869 2.04477336 2.04668911 2.65773972 2.90262935 2.95423653
 2.95472548 2.9894891  2.99038347 3.28771869 3.62664661 3.62703242
 4.5270646  4.52716456 9.18283293 9.22709905]
   3 ( 0.000  0.500  0.500)   [0.07640152 0.0793744  0.34926323 0.36058384] [0.82049611 0.82899674 1.27130012 1.27175864 1.72864043 1.72939727
 2.03063603 2.03250367 2.33430079 2.33445666 2.81522291 2.81661437
 2.98769762 2.98878029 3.03482811 3.03570775 3.43441865 3.43506124
 4.75294088 4.75324047 9.18254918 9.1825615 ]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.40 sec, wall time      0.40 sec
E1 = (4.205083009669989+2.3402487910106195e-18j)  Ecoul = (1.184537557879412+4.866893131979137e-25j)  Exc = -3.2881812502694547
cycle= 1 E= -10.7074337807061  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.74 sec, wall time      0.74 sec
HOMO = 0.569686891359  LUMO = 0.774539879383
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823546  0.55648764  0.56495018  0.56968689] [0.77453988 0.77912443 0.78469303 1.11984379 1.70809769 1.70832368
 2.37427612 2.37655422 2.37739192 2.44836507 2.45168406 2.4523067
 3.53690148 3.54001775 3.71838049 3.7199569  3.72041587 4.60534219
 4.60715544 4.60870604 8.68226383 9.01323561]
   1 ( 0.000  0.000  0.500)   [-0.05413109  0.04171924  0.44623048  0.45411232] [0.90552579 0.90923945 0.92942329 1.29164812 1.67221989 1.86345136
 1.86548683 2.01770073 2.01913895 2.63027047 2.86487618 2.90392688
 2.90479684 2.95101312 2.95202184 3.24884005 3.59222211 3.59323083
 4.49054016 4.4914605  9.02632724 9.07132118]
   2 ( 0.000  0.500  0.000)   [-0.05413087  0.04171919  0.44623149  0.4541124 ] [0.90552341 0.90924273 0.92942288 1.29164678 1.67221969 1.86345186
 1.86548716 2.01770114 2.01913857 2.63026963 2.86487771 2.90392673
 2.90479805 2.95101303 2.95202191 3.24884086 3.59222069 3.5932306
 4.4905395  4.49145849 9.02632721 9.07132208]
   3 ( 0.000  0.500  0.500)   [0.05607218 0.05914867 0.31090066 0.31918203] [0.80608085 0.81832567 1.22742167 1.22770199 1.67536737 1.67852498
 1.99604705 1.99672884 2.30681549 2.30902318 2.76485497 2.76597837
 2.95644603 2.95653591 2.99691444 3.00058138 3.40207013 3.40323578
 4.7103382  4.71231895 9.02590744 9.0263382 ]
nelec by numeric integration = 7.999999999846835
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.39 sec, wall time      0.40 sec
E1 = (4.165531660405301+2.273332833720237e-18j)  Ecoul = (1.2397179547325947+3.351712214103035e-26j)  Exc = -3.306816990394808
cycle= 2 E= -10.710440473243  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.74 sec, wall time      0.74 sec
HOMO = 0.575300410138  LUMO = 0.779923306319
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343467  0.56308164  0.5710242   0.57530041] [0.77992331 0.78431319 0.78990072 1.12771824 1.71171564 1.71189308
 2.38020785 2.38219889 2.38283633 2.455691   2.45874835 2.45939204
 3.54255278 3.54556219 3.72517156 3.72656388 3.72689099 4.61193727
 4.61361113 4.61519681 8.6986825  9.02928632]
   1 ( 0.000  0.000  0.500)   [-0.04875001  0.04515925  0.45231197  0.45951945] [0.91067701 0.91469663 0.93575    1.29962709 1.67872775 1.86936452
 1.87099595 2.02146978 2.02300241 2.6347184  2.87121304 2.91135709
 2.9120639  2.95699368 2.95786013 3.25530599 3.59791962 3.59891233
 4.49658036 4.4975786  9.04235014 9.08716867]
   2 ( 0.000  0.500  0.000)   [-0.04874977  0.0451592   0.45231301  0.4595196 ] [0.9106747  0.91469987 0.93574954 1.2996257  1.67872756 1.86936502
 1.87099628 2.02147019 2.02300201 2.63471755 2.87121452 2.9113569
 2.91206513 2.95699358 2.95786022 3.25530684 3.59791823 3.59891205
 4.49657969 4.49757659 9.04235011 9.08716955]
   3 ( 0.000  0.500  0.500)   [0.06140809 0.06333779 0.31628979 0.32378232] [0.80986495 0.82299599 1.23521863 1.23561517 1.68271616 1.6860778
 2.00033657 2.00101221 2.31114899 2.31294448 2.77210811 2.77308605
 2.96178859 2.96199156 3.00304935 3.00622835 3.40834996 3.40914938
 4.71685054 4.7185213  9.04187991 9.04234705]
nelec by numeric integration = 7.999999999847134
    CPU time for vxc      0.33 sec, wall time      0.34 sec
    CPU time for vj and vk      0.40 sec, wall time      0.40 sec
E1 = (4.170645133699023+2.3113716718979796e-18j)  Ecoul = (1.2320361572608338-8.267262286716204e-28j)  Exc = -3.304307394492341
cycle= 3 E= -10.7104992015186  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.74 sec, wall time      0.76 sec
HOMO = 0.575159339805  LUMO = 0.779848829633
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350763  0.56288752  0.57084378  0.57515934] [0.77984883 0.78420954 0.78980478 1.12763644 1.71163405 1.71181407
 2.3801114  2.3820852  2.38269973 2.45545984 2.4585576  2.45918139
 3.54244013 3.54543408 3.72496651 3.72637718 3.72673921 4.61180505
 4.61344437 4.61503901 8.69813746 9.02875147]
   1 ( 0.000  0.000  0.500)   [-0.04881889  0.04506404  0.45214575  0.45936912] [0.91056549 0.91460301 0.93566579 1.29947779 1.67853251 1.86919907
 1.87083568 2.02141007 2.02290452 2.63460708 2.87107268 2.91118003
 2.91184891 2.95683597 2.95774134 3.25515993 3.59777243 3.59876514
 4.4964193  4.49742722 9.04181618 9.08663652]
   2 ( 0.000  0.500  0.000)   [-0.04881866  0.04506399  0.45214679  0.45936927] [0.91056318 0.91460624 0.93566533 1.2994764  1.67853232 1.86919956
 1.87083602 2.02141049 2.02290412 2.63460623 2.87107417 2.91117984
 2.91185014 2.95683587 2.95774143 3.25516078 3.59777103 3.59876485
 4.49641863 4.49742522 9.04181615 9.0866374 ]
   3 ( 0.000  0.500  0.500)   [0.06128901 0.06327377 0.31615113 0.3236613 ] [0.80981919 0.82290409 1.2350237  1.23549626 1.68249969 1.68584937
 2.00023222 2.00087951 2.31105526 2.31285242 2.77194175 2.77286949
 2.96163701 2.96186104 3.00289487 3.00610744 3.40822126 3.4090446
 4.71672462 4.71834277 9.04134569 9.04181275]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.39 sec, wall time      0.40 sec
E1 = (4.170517727074999+2.311011467519961e-18j)  Ecoul = (1.2322255730544054-6.729299065897319e-26j)  Exc = -3.304369447993346
cycle= 4 E= -10.71049924585  delta_E= -4.43e-08  |g|= 2.57e-05  |ddm|= 0.000627
    CPU time for cycle= 4      0.74 sec, wall time      0.74 sec
HOMO = 0.575159177072  LUMO = 0.779847957488
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350849  0.56288711  0.57084236  0.57515918] [0.77984796 0.78420962 0.78980366 1.12763545 1.71163357 1.71181342
 2.3801096  2.38208449 2.38270007 2.45545908 2.45855657 2.45918009
 3.54243948 3.5454332  3.72496623 3.72637612 3.72673821 4.6118036
 4.61344406 4.61503801 8.69813603 9.02875008]
   1 ( 0.000  0.000  0.500)   [-0.04881982  0.04506324  0.45214544  0.45936844] [0.91056553 0.914602   0.93566461 1.29947691 1.67853126 1.86919815
 1.87083529 2.02140848 2.02290448 2.63460562 2.87107161 2.91117883
 2.9118485  2.95683554 2.95773964 3.25515854 3.59777222 3.59876459
 4.49641904 4.49742641 9.04181485 9.08663504]
   2 ( 0.000  0.500  0.000)   [-0.04881959  0.04506319  0.45214648  0.45936859] [0.91056322 0.91460523 0.93566415 1.29947552 1.67853107 1.86919864
 1.87083562 2.0214089  2.02290408 2.63460477 2.8710731  2.91117864
 2.91184973 2.95683544 2.95773974 3.25515939 3.59777083 3.59876431
 4.49641837 4.49742441 9.04181483 9.08663592]
   3 ( 0.000  0.500  0.500)   [0.06128816 0.06327284 0.31615086 0.32366085] [0.80981807 0.8229032  1.23502363 1.23549551 1.68249748 1.68584813
 2.00023081 2.00087923 2.31105436 2.31285189 2.77194052 2.77286895
 2.96163664 2.96185941 3.00289476 3.00610629 3.40822114 3.40904337
 4.71672304 4.71834298 9.04134406 9.04181153]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.40 sec, wall time      0.40 sec
E1 = (4.170517423902593+2.311008356467121e-18j)  Ecoul = (1.2322260161912664+1.758213185556591e-26j)  Exc = -3.3043695878799193
cycle= 5 E= -10.7104992457721  delta_E= 7.79e-11  |g|= 4.35e-05  |ddm|= 7.21e-05
    CPU time for cycle= 5      0.74 sec, wall time      0.74 sec
HOMO = 0.575159165649  LUMO = 0.779847938464
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350852  0.56288706  0.57084231  0.57515917] [0.77984794 0.78420958 0.78980361 1.1276354  1.71163354 1.71181339
 2.38010956 2.38208444 2.38270004 2.45545902 2.45855655 2.45918003
 3.54243945 3.54543316 3.72496619 3.72637607 3.72673818 4.61180356
 4.61344401 4.61503796 8.69813596 9.02875001]
   1 ( 0.000  0.000  0.500)   [-0.04881985  0.0450632   0.4521454   0.45936841] [0.91056549 0.91460196 0.93566458 1.29947687 1.67853122 1.8691981
 1.87083525 2.02140845 2.02290445 2.63460558 2.87107156 2.91117879
 2.91184844 2.95683551 2.9577396  3.2551585  3.59777219 3.59876455
 4.496419   4.49742636 9.04181478 9.08663497]
   2 ( 0.000  0.500  0.000)   [-0.04881962  0.04506315  0.45214644  0.45936856] [0.91056318 0.91460519 0.93566411 1.29947548 1.67853103 1.86919859
 1.87083559 2.02140887 2.02290405 2.63460473 2.87107305 2.9111786
 2.91184967 2.95683541 2.95773969 3.25515935 3.59777079 3.59876427
 4.49641832 4.49742437 9.04181475 9.08663585]
   3 ( 0.000  0.500  0.500)   [0.06128813 0.06327279 0.31615082 0.32366084] [0.80981802 0.82290317 1.23502358 1.23549549 1.6824974  1.68584807
 2.00023078 2.00087919 2.31105434 2.31285185 2.77194049 2.77286889
 2.96163659 2.96185937 3.00289474 3.00610625 3.4082211  3.40904332
 4.716723   4.71834294 9.04134389 9.04181156]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.33 sec, wall time      0.34 sec
    CPU time for vj and vk      0.39 sec, wall time      0.39 sec
E1 = (4.170517400145954+2.3110184582790855e-18j)  Ecoul = (1.2322260517908339+1.811224638387443e-26j)  Exc = -3.304369599444676
Extra cycle  E= -10.710499245494  delta_E= 2.78e-10  |g|= 7.97e-05  |ddm|= 0.00013
    CPU time for scf_cycle      5.43 sec, wall time      5.46 sec
    CPU time for SCF      5.49 sec, wall time      5.52 sec
converged SCF energy = -10.710499245494
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-20.0/47995835/scf.h5
