SLURMD_NODENAME = hpc-34-02
Start time = Thu Mar 13 04:24:29 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0/47995821/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0/47995821/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 = None

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
Pivoted Cholesky rank = 361, estimated error = 0.00e+00
Parent grid size = 567, selected grid size = 390
    CPU time for interpolating functions      0.02 sec, wall time      0.02 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.81 sec, wall time      0.81 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      1.02 sec, wall time      1.02 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 321 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.96 sec, wall time      0.96 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 320 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.96 sec, wall time      0.96 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 320 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.97 sec, wall time      0.98 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 320 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0/47995821/tmpb2nt1q3p
    CPU time for building ISDF      4.95 sec, wall time      5.00 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0/47995821/tmpxx2_epti
max_memory 81920 MB (current use 107 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7fe96da65d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.39 sec, wall time      0.39 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3911205038359964
init E= -10.050345742027
    CPU time for initialize scf      1.10 sec, wall time      1.11 sec
HOMO = 0.61707172405  LUMO = 0.804017484018
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24646334  0.61123323  0.61152895  0.61707172] [0.80401748 0.80822023 0.81096439 1.13013833 1.7333199  1.73555037
 2.406689   2.40722332 2.40801329 2.50109843 2.50172377 2.50206078
 3.56781082 3.56829274 3.76700422 3.76710227 3.76786888 4.64457672
 4.6448843  4.64495243 8.84157033 9.16977006]
   1 ( 0.000  0.000  0.500)   [-0.03763464  0.06176945  0.49475203  0.50134623] [0.93251825 0.93684902 0.94450416 1.33425099 1.72137484 1.90372836
 1.90506654 2.04472678 2.04668594 2.65771264 2.9026192  2.9542016
 2.95471707 2.98946748 2.99037013 3.287724   3.6265921  3.62697384
 4.52689061 4.52713411 9.18248397 9.22670245]
   2 ( 0.000  0.500  0.000)   [-0.03752638  0.06168712  0.49464406  0.50134756] [0.93259785 0.93682408 0.94456843 1.33407274 1.72147886 1.90373744
 1.90507764 2.04477102 2.04668187 2.65762056 2.90258807 2.95422746
 2.95472048 2.98945769 2.99036585 3.28771241 3.62663142 3.62702782
 4.52705266 4.52715869 9.1824493  9.22674896]
   3 ( 0.000  0.500  0.500)   [0.07654402 0.07941068 0.34938033 0.36062393] [0.82048462 0.82912186 1.27141735 1.27180186 1.72857774 1.72946617
 2.03059923 2.03249311 2.33430072 2.33443202 2.81519137 2.81661516
 2.98770105 2.98876641 3.03477202 3.03568876 3.43436957 3.43504046
 4.75282918 4.75321966 9.18216286 9.18220971]
nelec by numeric integration = 7.999999999848195
    CPU time for vxc      0.38 sec, wall time      0.38 sec
    CPU time for vj and vk      0.39 sec, wall time      0.40 sec
E1 = (4.205091696834708+2.340921751259955e-18j)  Ecoul = (1.1845254376186298-4.398057318788185e-26j)  Exc = -3.287936545097175
cycle= 1 E= -10.7071925086299  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.78 sec, wall time      0.78 sec
HOMO = 0.569782936791  LUMO = 0.774577026965
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26813208  0.55648529  0.56499696  0.56978294] [0.77457703 0.77913513 0.78473348 1.11994967 1.70809537 1.70831748
 2.37426796 2.37654973 2.37738241 2.44834874 2.45167902 2.45229617
 3.5368835  3.54001261 3.7183313  3.71991335 3.72032081 4.60519346
 4.6071155  4.60861791 8.68176199 9.01274619]
   1 ( 0.000  0.000  0.500)   [-0.05404476  0.04177128  0.44622594  0.45422868] [0.90555122 0.9092504  0.92952468 1.29171209 1.67220736 1.86342841
 1.86547997 2.01765735 2.01913318 2.63022948 2.86486104 2.90390076
 2.90478808 2.95100119 2.95202295 3.24888946 3.59218528 3.59320895
 4.49049944 4.49128567 9.02584423 9.07078794]
   2 ( 0.000  0.500  0.000)   [-0.05400215  0.04177851  0.44623611  0.45412143] [0.90549892 0.9092699  0.92955286 1.29165106 1.67227108 1.8634521
 1.86548908 2.01770025 2.01913289 2.63019834 2.86486779 2.90392792
 2.9047886  2.95098032 2.95199499 3.24882718 3.59221171 3.59323771
 4.49053971 4.49144002 9.02579284 9.07086223]
   3 ( 0.000  0.500  0.500)   [0.05617247 0.059216   0.31090253 0.31925427] [0.8061027  0.81840671 1.22740781 1.22776352 1.6753264  1.67855291
 1.99602742 1.99672649 2.30678872 2.30902394 2.76482914 2.76597524
 2.9564487  2.9565635  2.99688913 3.0005406  3.40205985 3.40320498
 4.710214   4.71232182 9.02543098 9.0258105 ]
nelec by numeric integration = 7.999999999846837
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.165550109183368+2.2739359584991487e-18j)  Ecoul = (1.2396851829132165-3.927265130552285e-26j)  Exc = -3.306563376238499
cycle= 2 E= -10.710201182128  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.76 sec, wall time      0.77 sec
HOMO = 0.57539215464  LUMO = 0.779960736334
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26333164  0.56308017  0.57106977  0.57539215] [0.77996074 0.78432129 0.78994013 1.12782537 1.71171161 1.71188566
 2.38019987 2.38219286 2.38282369 2.4556735  2.45873954 2.45937905
 3.54253334 3.54555625 3.72512082 3.7265169  3.7267936  4.61178294
 4.61356989 4.61510442 8.69816875 9.02878683]
   1 ( 0.000  0.000  0.500)   [-0.04866853  0.04521729  0.45230922  0.45962797] [0.91069464 0.9147058  0.93585179 1.29969505 1.67871564 1.86934529
 1.87098504 2.02142683 2.02299894 2.63467405 2.871201   2.91132979
 2.9120509  2.95697706 2.95785319 3.25535134 3.59788031 3.59889076
 4.49653915 4.4973973  9.04185647 9.08662347]
   2 ( 0.000  0.500  0.000)   [-0.04861504  0.0452052   0.45231595  0.45953077] [0.91065341 0.91472877 0.93588437 1.29962211 1.67877494 1.8693597
 1.87099583 2.02146389 2.02299033 2.63464604 2.87119727 2.91135732
 2.91205598 2.95696554 2.95783887 3.25529797 3.5979075  3.59891733
 4.4965759  4.49755418 9.04180433 9.08669765]
   3 ( 0.000  0.500  0.500)   [0.06150968 0.06340171 0.31629104 0.32385116] [0.80988372 0.82307953 1.23520267 1.23567619 1.68267266 1.68610548
 2.00031487 2.00100949 2.31112263 2.31294241 2.77208136 2.77308115
 2.96181448 2.96199374 3.00302383 3.00618398 3.40833899 3.40911615
 4.71671876 4.7185215  9.04139267 9.04180722]
nelec by numeric integration = 7.999999999847124
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.170663641692665+2.312051958065039e-18j)  Ecoul = (1.2320038894050844-1.6935960110881276e-24j)  Exc = -3.3040543392319366
cycle= 3 E= -10.7102599061203  delta_E= -5.87e-05  |g|= 0.000981  |ddm|= 0.0247
    CPU time for cycle= 3      0.78 sec, wall time      0.78 sec
HOMO = 0.575250639918  LUMO = 0.779885496734
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340501  0.56288504  0.57088862  0.57525064] [0.7798855  0.78421706 0.78984367 1.12774315 1.71162957 1.71180626
 2.38010274 2.38207859 2.38268647 2.45544144 2.45854819 2.45916773
 3.54242011 3.54542762 3.72491503 3.72633031 3.72664082 4.61165023
 4.61340249 4.61494606 8.69762194 9.02825029]
   1 ( 0.000  0.000  0.500)   [-0.04873702  0.04512028  0.45214183  0.45947779] [0.91058343 0.91461225 0.93576698 1.29954397 1.67851945 1.86917867
 1.87082446 2.0213666  2.02289973 2.63456209 2.87105935 2.91115219
 2.91183532 2.95681887 2.95773476 3.25520523 3.59773278 3.59874313
 4.4963775  4.49724532 9.04132084 9.0860895 ]
   2 ( 0.000  0.500  0.000)   [-0.04868552  0.04511136  0.45214909  0.45937911] [0.9105404  0.91463378 0.93579924 1.29947327 1.67857949 1.869194
 1.87083491 2.02140433 2.02289294 2.63453459 2.87105721 2.91117936
 2.91183992 2.95680681 2.95771858 3.25515053 3.59775944 3.59876942
 4.49641423 4.49740224 9.04126861 9.08616397]
   3 ( 0.000  0.500  0.500)   [0.06138967 0.06333772 0.31615161 0.32372956] [0.80983806 0.8229868  1.23500681 1.23555641 1.68245565 1.68587625
 2.00021017 2.00087627 2.31102837 2.31285004 2.77191436 2.77286376
 2.96166243 2.96186257 3.00286854 3.00606269 3.40820955 3.40901096
 4.71659217 4.71834232 9.04085613 9.04127182]
nelec by numeric integration = 7.999999999847125
    CPU time for vxc      0.38 sec, wall time      0.38 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.170535824492664+2.311653483091013e-18j)  Ecoul = (1.232193900581066+2.2296364625166678e-26j)  Exc = -3.3041165768047422
cycle= 4 E= -10.7102599497171  delta_E= -4.36e-08  |g|= 0.000158  |ddm|= 0.000679
    CPU time for cycle= 4      0.81 sec, wall time      0.81 sec
HOMO = 0.575250468277  LUMO = 0.77988490187
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634056   0.56288477  0.57088764  0.57525047] [0.7798849  0.78421709 0.7898429  1.12774247 1.71162924 1.71180581
 2.38010152 2.38207809 2.38268667 2.45544092 2.45854745 2.45916683
 3.54241965 3.54542701 3.72491482 3.72632955 3.72664013 4.61164923
 4.61340225 4.61494536 8.69762091 9.02824927]
   1 ( 0.000  0.000  0.500)   [-0.04873778  0.04511992  0.45214166  0.45947718] [0.9105833  0.9146115  0.93576616 1.29954347 1.67851863 1.86917812
 1.87082413 2.02136556 2.0228998  2.63456109 2.8710587  2.91115134
 2.91183497 2.95681852 2.95773346 3.25520418 3.59773259 3.59874274
 4.49637731 4.49724478 9.04131987 9.08608846]
   2 ( 0.000  0.500  0.000)   [-0.04868601  0.04511054  0.45214885  0.45937873] [0.91054054 0.91463316 0.9357985  1.29947249 1.67857853 1.86919327
 1.87083463 2.02140317 2.02289278 2.63453358 2.87105634 2.91117855
 2.91183966 2.95680658 2.95771756 3.25514968 3.5977593  3.59876903
 4.49641401 4.49740165 9.04126765 9.08616287]
   3 ( 0.000  0.500  0.500)   [0.06138912 0.06333704 0.31615142 0.32372923] [0.80983726 0.82298622 1.23500675 1.23555588 1.68245415 1.68587536
 2.00020919 2.00087607 2.31102775 2.31284967 2.7719135  2.77286337
 2.96166207 2.96186153 3.00286846 3.00606188 3.40820946 3.4090101
 4.71659109 4.71834244 9.04085536 9.04127052]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.39 sec, wall time      0.39 sec
E1 = (4.170535598702784+2.3116939908460608e-18j)  Ecoul = (1.232194232201018+2.6475812809900016e-24j)  Exc = -3.304116683014565
cycle= 5 E= -10.7102599500968  delta_E= -3.8e-10  |g|= 0.000137  |ddm|= 0.00031
    CPU time for cycle= 5      0.75 sec, wall time      0.76 sec
HOMO = 0.575250399588  LUMO = 0.779884607677
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634059   0.56288464  0.57088716  0.5752504 ] [0.77988461 0.7842171  0.78984251 1.12774213 1.71162907 1.71180559
 2.38010091 2.38207784 2.38268678 2.45544065 2.4585471  2.45916638
 3.54241943 3.5454267  3.72491473 3.72632917 3.72663979 4.61164873
 4.61340214 4.61494502 8.69762043 9.0282488 ]
   1 ( 0.000  0.000  0.500)   [-0.04873815  0.04511971  0.45214157  0.4594769 ] [0.91058325 0.91461113 0.93576575 1.29954321 1.67851823 1.86917783
 1.87082398 2.02136503 2.02289983 2.63456059 2.87105837 2.91115092
 2.9118348  2.95681835 2.95773283 3.25520367 3.59773251 3.59874255
 4.49637722 4.4972445  9.04131943 9.08608797]
   2 ( 0.000  0.500  0.000)   [-0.04868627  0.04511017  0.45214873  0.45937854] [0.91054059 0.91463284 0.93579812 1.29947213 1.67857808 1.86919292
 1.87083449 2.0214026  2.02289272 2.63453308 2.87105592 2.91117815
 2.91183952 2.95680646 2.95771703 3.25514925 3.59775924 3.59876884
 4.49641391 4.49740136 9.04126722 9.08616236]
   3 ( 0.000  0.500  0.500)   [0.06138884 0.06333669 0.31615133 0.32372907] [0.80983685 0.82298593 1.23500671 1.23555562 1.68245338 1.68587494
 2.0002087  2.00087597 2.31102747 2.31284946 2.77191308 2.77286318
 2.96166198 2.96186093 3.00286843 3.00606147 3.40820942 3.40900967
 4.71659055 4.7183425  9.04085514 9.04126978]
nelec by numeric integration = 7.999999999847124
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.40 sec, wall time      0.40 sec
E1 = (4.170535492436564+2.3116845765042872e-18j)  Ecoul = (1.2321943858874755+3.1575262136738307e-25j)  Exc = -3.3041167316055065
cycle= 6 E= -10.7102599512676  delta_E= -1.17e-09  |g|= 4.42e-07  |ddm|= 0.000144
    CPU time for cycle= 6      0.76 sec, wall time      0.77 sec
HOMO = 0.575250404531  LUMO = 0.779884604955
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26340591  0.56288461  0.57088714  0.5752504 ] [0.7798846  0.78421708 0.78984249 1.12774211 1.71162906 1.71180557
 2.3801009  2.38207783 2.38268676 2.45544062 2.4585471  2.45916635
 3.54241941 3.54542669 3.7249147  3.72632916 3.72663979 4.61164872
 4.61340211 4.614945   8.6976204  9.02824878]
   1 ( 0.000  0.000  0.500)   [-0.04873813  0.04511965  0.45214154  0.45947691] [0.91058326 0.91461113 0.93576574 1.29954317 1.67851821 1.86917779
 1.87082397 2.02136501 2.02289978 2.63456058 2.87105833 2.91115091
 2.91183478 2.95681834 2.95773285 3.25520369 3.59773249 3.59874253
 4.49637719 4.49724448 9.04131941 9.08608793]
   2 ( 0.000  0.500  0.000)   [-0.04868631  0.04511021  0.45214871  0.4593785 ] [0.91054054 0.91463281 0.9357981  1.29947215 1.67857809 1.86919292
 1.87083447 2.02140261 2.02289272 2.63453307 2.87105593 2.91117813
 2.91183948 2.95680643 2.957717   3.25514922 3.59775921 3.59876882
 4.49641389 4.49740135 9.04126719 9.08616233]
   3 ( 0.000  0.500  0.500)   [0.06138882 0.06333668 0.31615131 0.32372907] [0.80983684 0.82298591 1.23500668 1.23555563 1.68245336 1.68587491
 2.0002087  2.00087595 2.31102746 2.31284944 2.77191308 2.77286315
 2.96166196 2.96186092 3.00286841 3.00606147 3.4082094  3.40900965
 4.71659055 4.71834248 9.04085511 9.04126976]
nelec by numeric integration = 7.999999999847125
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.39 sec, wall time      0.39 sec
E1 = (4.170535482538151+2.3116741973793157e-18j)  Ecoul = (1.2321944004892853-1.519150465951174e-24j)  Exc = -3.3041167363089134
Extra cycle  E= -10.7102599512676  delta_E= -1.07e-14  |g|= 2.39e-07  |ddm|= 5.37e-07
    CPU time for scf_cycle      6.50 sec, wall time      6.53 sec
    CPU time for SCF      6.57 sec, wall time      6.60 sec
converged SCF energy = -10.7102599512676
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0/47995821/scf.h5
