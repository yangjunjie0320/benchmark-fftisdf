SLURMD_NODENAME = hpc-34-25
Start time = Thu Mar 13 04:24:45 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-100.0/47995843/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-100.0/47995843/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  1.00e+02

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.20686971]
 [ 0.          0.          0.41373942]
 ...
 [-0.2388726  -0.16890841 -0.82747884]
 [-0.2388726  -0.16890841 -0.62060913]
 [-0.2388726  -0.16890841 -0.41373942]], m0 = [23 23 23]
Pivoted Cholesky rank = 375, estimated error = 0.00e+00
Parent grid size = 12167, selected grid size = 520
    CPU time for interpolating functions      3.67 sec, wall time      3.68 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      1.04 sec, wall time      1.04 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.46 sec, wall time      1.47 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 292 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.46 sec, wall time      1.47 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 291 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.46 sec, wall time      1.46 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 291 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.45 sec, wall time      1.45 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 291 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-100.0/47995843/tmpk9fbweb0
    CPU time for building ISDF      7.11 sec, wall time      7.16 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-100.0/47995843/tmp25xyy4mq
max_memory 81920 MB (current use 112 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7ff0ba9afd00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.36 sec, wall time      0.37 sec
    CPU time for vj and vk      0.41 sec, wall time      0.42 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.391486912367298
init E= -10.0507121505583
    CPU time for initialize scf      1.07 sec, wall time      1.07 sec
HOMO = 0.617030577754  LUMO = 0.803937763964
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655516  0.61115125  0.61138944  0.61703058] [0.80393776 0.80814225 0.81092709 1.13006399 1.73332476 1.73555932
 2.40667332 2.40722508 2.40801262 2.50110917 2.50172521 2.50205466
 3.56784118 3.56831742 3.76714146 3.76716473 3.76793437 4.64476553
 4.64490851 4.64502751 8.84194647 9.17012111]
   1 ( 0.000  0.000  0.500)   [-0.03769169  0.0616694   0.49459498  0.50130626] [0.93251742 0.93680194 0.94438484 1.33409834 1.72140147 1.90372304
 1.90506929 2.04477356 2.0466918  2.65773437 2.9026276  2.95423739
 2.95472588 2.98948586 2.99038754 3.28771811 3.62664539 3.6270301
 4.52707205 4.52716899 9.18283354 9.22710051]
   2 ( 0.000  0.500  0.000)   [-0.03769241  0.06166881  0.49459446  0.50130572] [0.93251849 0.93680453 0.9443854  1.3340995  1.72140156 1.90372755
 1.90506764 2.0447737  2.04669081 2.65773795 2.902627   2.95423748
 2.95472449 2.98948639 2.99038345 3.2877192  3.62664647 3.62703112
 4.5270684  4.5271704  9.18283436 9.227101  ]
   3 ( 0.000  0.500  0.500)   [0.07640451 0.07937203 0.34926121 0.36058398] [0.8204923  0.82899894 1.2712997  1.27175592 1.7286393  1.72939555
 2.03063148 2.03250374 2.33430119 2.33445569 2.8152223  2.81661492
 2.98769338 2.98878161 3.0348338  3.03570976 3.43441348 3.43506205
 4.75294391 4.75325143 9.18254928 9.18256418]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.41 sec, wall time      0.42 sec
E1 = (4.205081947772039+2.3401784165651817e-18j)  Ecoul = (1.1845398605636954-3.701840238276329e-25j)  Exc = -3.288180618184144
cycle= 1 E= -10.7074319078345  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.78 sec, wall time      0.78 sec
HOMO = 0.569684593799  LUMO = 0.774546684328
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823204  0.55648829  0.56495272  0.56968459] [0.77454668 0.77912964 0.78469055 1.1198413  1.70809567 1.7083284
 2.37427717 2.37655718 2.37739502 2.44836334 2.45168848 2.45230395
 3.53690006 3.54001746 3.71838407 3.71995635 3.72041635 4.6053498
 4.607157   4.60871042 8.68226444 9.01323708]
   1 ( 0.000  0.000  0.500)   [-0.05412981  0.04171926  0.446232    0.45411329] [0.90552425 0.90923725 0.9294236  1.29164926 1.67221949 1.8634545
 1.8654842  2.01769954 2.01914175 2.63026948 2.86487924 2.90392802
 2.90479916 2.9510181  2.9520207  3.24884088 3.59222075 3.5932298
 4.49054422 4.4914657  9.02632837 9.07132365]
   2 ( 0.000  0.500  0.000)   [-0.05413099  0.04171903  0.44623122  0.45411335] [0.90552896 0.90923871 0.92942434 1.2916473  1.672221   1.8634525
 1.86549    2.01770232 2.01914052 2.63026781 2.86487614 2.90392852
 2.90479981 2.95101537 2.95202092 3.24883674 3.59222022 3.59323121
 4.49054378 4.49146316 9.02632966 9.07132261]
   3 ( 0.000  0.500  0.500)   [0.05607619 0.05914697 0.31090147 0.31918099] [0.80607947 0.81832885 1.22742181 1.22770165 1.67536915 1.67852492
 1.99604307 1.9967319  2.30681746 2.30902627 2.76485463 2.76597782
 2.9564475  2.95653426 2.99691566 3.00058456 3.40207102 3.40323349
 4.71033331 4.71232976 9.02590847 9.02633942]
nelec by numeric integration = 7.999999999846839
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.165530945212883+2.2732799091178363e-18j)  Ecoul = (1.239719380356345-4.593694823282996e-26j)  Exc = -3.306815921410972
cycle= 2 E= -10.7104386938278  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.78 sec, wall time      0.78 sec
HOMO = 0.575298094643  LUMO = 0.779929949224
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343131  0.56308209  0.57102671  0.57529809] [0.77992995 0.78431825 0.78989824 1.12771585 1.71171369 1.71189762
 2.38020883 2.38220176 2.38283949 2.45568906 2.45875247 2.45938916
 3.54255131 3.54556188 3.72517476 3.72656328 3.72689139 4.61194456
 4.61361269 4.61520112 8.69868286 9.02928758]
   1 ( 0.000  0.000  0.500)   [-0.04874867  0.04515932  0.45231338  0.4595205 ] [0.91067558 0.91469447 0.93575024 1.29962822 1.67872729 1.86936764
 1.87099336 2.02146858 2.02300508 2.63471731 2.87121589 2.91135807
 2.91206608 2.95699842 2.95785919 3.25530672 3.59791828 3.59891129
 4.49658421 4.49758375 9.04235107 9.08717088]
   2 ( 0.000  0.500  0.000)   [-0.04874996  0.04515914  0.45231254  0.45952051] [0.91067999 0.91469594 0.93575099 1.29962638 1.67872888 1.86936566
 1.87099904 2.02147142 2.02300403 2.63471564 2.8712129  2.91135851
 2.91206677 2.95699582 2.95785934 3.25530284 3.5979177  3.59891258
 4.49658392 4.49758101 9.04235232 9.0871698 ]
   3 ( 0.000  0.500  0.500)   [0.06141206 0.06333627 0.31629051 0.32378123] [0.80986378 0.82299895 1.23521856 1.23561475 1.68271788 1.68607761
 2.00033259 2.00101518 2.31115084 2.31294752 2.77210772 2.77308545
 2.9617869  2.96199299 3.00305059 3.00623137 3.40835076 3.40914718
 4.7168458  4.71853199 9.0418807  9.04234807]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170644383545009+2.311326800568301e-18j)  Ecoul = (1.232037606664693-2.732614175685585e-27j)  Exc = -3.3043063123483076
cycle= 3 E= -10.7104974201247  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.79 sec, wall time      0.80 sec
HOMO = 0.575156949392  LUMO = 0.779855429805
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350429  0.56288792  0.57084625  0.57515695] [0.77985543 0.78421455 0.78980227 1.127634   1.71163206 1.71181858
 2.38011232 2.38208802 2.38270285 2.45545782 2.45856164 2.45917843
 3.5424386  3.54543372 3.72496966 3.72637654 3.72673955 4.61181227
 4.61344587 4.61504325 8.69813765 9.02875258]
   1 ( 0.000  0.000  0.500)   [-0.04881759  0.04506409  0.45214711  0.45937012] [0.910564   0.91460082 0.93566598 1.29947886 1.67853198 1.86920214
 1.87083302 2.02140882 2.02290715 2.63460594 2.87107549 2.91118094
 2.91185102 2.95684066 2.95774034 3.25516058 3.59777103 3.59876405
 4.49642308 4.49743231 9.04181694 9.08663855]
   2 ( 0.000  0.500  0.000)   [-0.04881887  0.04506389  0.45214626  0.45937015] [0.91056842 0.91460228 0.93566675 1.29947701 1.67853356 1.86920015
 1.8708387  2.02141167 2.02290611 2.63460427 2.87107248 2.91118138
 2.91185172 2.95683807 2.95774051 3.25515671 3.59777045 3.59876533
 4.4964228  4.49742958 9.04181819 9.08663748]
   3 ( 0.000  0.500  0.500)   [0.06129295 0.06327222 0.31615181 0.32366014] [0.80981801 0.82290703 1.23502356 1.23549577 1.68250134 1.6858491
 2.00022818 2.00088245 2.31105708 2.31285542 2.77194128 2.77286881
 2.96163527 2.96186245 3.00289607 3.0061104  3.408222   3.40904235
 4.7167198  4.71835337 9.04134628 9.04181366]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.41 sec, wall time      0.41 sec
E1 = (4.1705169304165155+2.310957627700071e-18j)  Ecoul = (1.2322270914579447-1.4515040656066617e-27j)  Exc = -3.3043683883171924
cycle= 4 E= -10.7104974644288  delta_E= -4.43e-08  |g|= 4.39e-05  |ddm|= 0.00063
    CPU time for cycle= 4      0.77 sec, wall time      0.77 sec
HOMO = 0.575156792835  LUMO = 0.779854585062
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350512  0.56288752  0.57084488  0.57515679] [0.77985459 0.78421463 0.78980118 1.12763305 1.71163159 1.71181795
 2.38011058 2.38208733 2.38270318 2.45545709 2.45856065 2.45917718
 3.54243798 3.54543287 3.72496938 3.72637552 3.72673859 4.61181087
 4.61344556 4.61504228 8.69813626 9.02875123]
   1 ( 0.000  0.000  0.500)   [-0.04881849  0.04506331  0.45214681  0.45936946] [0.91056404 0.91459984 0.93566484 1.29947801 1.67853077 1.86920124
 1.87083264 2.02140729 2.02290712 2.63460453 2.87107445 2.91117978
 2.91185062 2.95684024 2.95773871 3.25515924 3.59777083 3.59876352
 4.49642283 4.49743153 9.04181566 9.08663713]
   2 ( 0.000  0.500  0.000)   [-0.04881977  0.04506312  0.45214596  0.45936949] [0.91056846 0.9146013  0.93566561 1.29947616 1.67853235 1.86919926
 1.87083832 2.02141014 2.02290607 2.63460286 2.87107145 2.91118022
 2.91185131 2.95683765 2.95773887 3.25515536 3.59777025 3.5987648
 4.49642255 4.49742879 9.04181691 9.08663605]
   3 ( 0.000  0.500  0.500)   [0.06129212 0.06327132 0.31615155 0.32365971] [0.80981693 0.82290616 1.2350235  1.23549504 1.6824992  1.6858479
 2.00022682 2.00088217 2.31105621 2.31285491 2.77194009 2.77286829
 2.96163492 2.96186086 3.00289596 3.00610929 3.40822188 3.40904116
 4.71671827 4.71835358 9.04134471 9.04181247]
nelec by numeric integration = 7.999999999847124
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.170516636558352+2.3109697674237434e-18j)  Ecoul = (1.2322275213102274+4.646075187389671e-26j)  Exc = -3.3043685241015095
cycle= 5 E= -10.710497464219  delta_E= 2.1e-10  |g|= 7.26e-05  |ddm|= 0.000122
    CPU time for cycle= 5      0.78 sec, wall time      0.78 sec
HOMO = 0.575156774266  LUMO = 0.779854535238
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350519  0.56288746  0.57084478  0.57515677] [0.77985454 0.78421459 0.7898011  1.12763296 1.71163155 1.7118179
 2.38011047 2.38208727 2.38270315 2.455457   2.45856059 2.45917707
 3.54243792 3.5454328  3.72496933 3.72637543 3.72673853 4.61181078
 4.61344551 4.6150422  8.69813614 9.0287511 ]
   1 ( 0.000  0.000  0.500)   [-0.04881856  0.04506324  0.45214676  0.4593694 ] [0.910564   0.91459977 0.93566477 1.29947794 1.67853069 1.86920116
 1.87083259 2.0214072  2.02290708 2.63460444 2.87107437 2.9111797
 2.91185055 2.95684019 2.95773861 3.25515915 3.59777078 3.59876346
 4.49642278 4.49743145 9.04181554 9.086637  ]
   2 ( 0.000  0.500  0.000)   [-0.04881984  0.04506305  0.45214591  0.45936943] [0.91056842 0.91460123 0.93566553 1.29947609 1.67853227 1.86919918
 1.87083827 2.02141005 2.02290604 2.63460277 2.87107136 2.91118013
 2.91185124 2.9568376  2.95773877 3.25515528 3.59777021 3.59876474
 4.49642249 4.49742872 9.04181679 9.08663593]
   3 ( 0.000  0.500  0.500)   [0.06129206 0.06327124 0.3161515  0.32365968] [0.80981684 0.8229061  1.23502344 1.235495   1.68249903 1.68584781
 2.00022674 2.00088213 2.31105615 2.31285486 2.77194002 2.77286821
 2.96163483 2.96186079 3.00289593 3.00610921 3.40822184 3.40904107
 4.71671818 4.71835355 9.04134422 9.04181271]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.42 sec, wall time      0.42 sec
E1 = (4.170516601804467+2.310952161436734e-18j)  Ecoul = (1.2322275733738906-1.7727282262126577e-26j)  Exc = -3.304368540637814
Extra cycle  E= -10.7104974634455  delta_E= 7.73e-10  |g|= 0.000133  |ddm|= 0.000216
    CPU time for scf_cycle      5.75 sec, wall time      5.77 sec
    CPU time for SCF      5.82 sec, wall time      5.84 sec
converged SCF energy = -10.7104974634455
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-100.0/47995843/scf.h5
