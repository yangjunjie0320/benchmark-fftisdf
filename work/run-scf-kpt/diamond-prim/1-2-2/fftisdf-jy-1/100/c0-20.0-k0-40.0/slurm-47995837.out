SLURMD_NODENAME = hpc-34-25
Start time = Thu Mar 13 04:24:43 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-40.0/47995837/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-40.0/47995837/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  2.00e+01
k0 =  4.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.31720022]
 [ 0.          0.          0.63440044]
 ...
 [-0.36627131 -0.25899289 -1.26880088]
 [-0.36627131 -0.25899289 -0.95160066]
 [-0.36627131 -0.25899289 -0.63440044]], m0 = [15 15 15]
Pivoted Cholesky rank = 366, estimated error = 0.00e+00
Parent grid size = 3375, selected grid size = 520
    CPU time for interpolating functions      0.30 sec, wall time      0.30 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 520, nao = 26, cisdf =  20.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 4.05e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.99 sec, wall time      0.99 sec
eta_kpt.shape = (4, 12167, 520)
Memory used for eta_kpt = 4.05e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.47 sec, wall time      1.47 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 326 / 520

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.47 sec, wall time      1.48 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 325 / 520

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.51 sec, wall time      1.52 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 325 / 520

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 520, nip = 520, max_memory = 8.18e+01 GB
memory used for each block = 1.01e-01 GB
    CPU time for solving Coulomb kernel      1.48 sec, wall time      1.48 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 325 / 520
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-40.0/47995837/tmpd5yya1z_
    CPU time for building ISDF      7.16 sec, wall time      7.20 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-40.0/47995837/tmplbbw3xko
max_memory 81920 MB (current use 114 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f4a1a5c4c10>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.37 sec, wall time      0.38 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914852289799855
init E= -10.050710467171
    CPU time for initialize scf      1.10 sec, wall time      1.10 sec
HOMO = 0.617031800452  LUMO = 0.80393499417
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655544  0.61114981  0.61139085  0.6170318 ] [0.80393499 0.80814465 0.81092691 1.13006787 1.73332629 1.73555795
 2.40667559 2.40722446 2.40801261 2.50110519 2.50172806 2.50205483
 3.56784315 3.56831903 3.76714733 3.76716566 3.76793472 4.64475978
 4.64490869 4.64502571 8.84194643 9.17011965]
   1 ( 0.000  0.000  0.500)   [-0.03769258  0.06166903  0.49459148  0.5013073 ] [0.93252064 0.93680429 0.94438913 1.33409931 1.7214003  1.90372339
 1.90506841 2.04477246 2.04669088 2.65773802 2.90262807 2.95423745
 2.95472422 2.98948825 2.99038478 3.28771771 3.62664732 3.6270314
 4.52706946 4.52716697 9.18283393 9.22709932]
   2 ( 0.000  0.500  0.000)   [-0.03769332  0.06166992  0.4945948   0.50130771] [0.93252035 0.93680594 0.94438689 1.33409941 1.72140089 1.90372452
 1.90506851 2.04477252 2.04669124 2.65773804 2.9026293  2.95423566
 2.95472525 2.98948918 2.99038492 3.28771611 3.62664765 3.62703118
 4.52706958 4.52716651 9.18283334 9.22709967]
   3 ( 0.000  0.500  0.500)   [0.07640075 0.07937295 0.34926234 0.36058533] [0.82049232 0.82900192 1.27129893 1.27175901 1.72863786 1.7293955
 2.03063439 2.03250296 2.33430028 2.33445729 2.81522195 2.81661511
 2.98769734 2.9887782  3.03482886 3.0357107  3.43441698 3.43506213
 4.75294432 4.75324275 9.18255024 9.18256194]
nelec by numeric integration = 7.999999999848208
    CPU time for vxc      0.36 sec, wall time      0.37 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.205082504125721+2.3400551642305306e-18j)  Ecoul = (1.184538698299238+8.589117536046377e-26j)  Exc = -3.288181895346701
cycle= 1 E= -10.7074337909078  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.80 sec, wall time      0.80 sec
HOMO = 0.569686628559  LUMO = 0.77454520676
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823305  0.55648824  0.56494906  0.56968663] [0.77454521 0.77913121 0.78469317 1.11984225 1.70810168 1.70832501
 2.37427841 2.37655452 2.3773943  2.44836417 2.45168464 2.4523064
 3.53690156 3.54001734 3.7183817  3.71995972 3.72041762 4.60534327
 4.60715486 4.60870725 8.68226401 9.01323664]
   1 ( 0.000  0.000  0.500)   [-0.0541314   0.04171989  0.44623084  0.45410994] [0.90552775 0.90924044 0.9294251  1.29164635 1.67221911 1.86345279
 1.86548593 2.01769941 2.01914101 2.63026801 2.86487641 2.9039293
 2.90479862 2.95101515 2.95202177 3.248841   3.59222155 3.59323059
 4.49054098 4.49146169 9.0263285  9.07132291]
   2 ( 0.000  0.500  0.000)   [-0.05413041  0.04171977  0.44623238  0.4541137 ] [0.90553081 0.90923851 0.92942327 1.29164801 1.67222014 1.86345248
 1.86548587 2.01769867 2.01913974 2.63026891 2.86487753 2.90392694
 2.90479903 2.95101483 2.95202145 3.24883886 3.59222083 3.59323076
 4.49053865 4.49146168 9.02632907 9.0713235 ]
   3 ( 0.000  0.500  0.500)   [0.05607197 0.05914648 0.31090183 0.31918152] [0.80608397 0.81832885 1.22742418 1.22770081 1.6753666  1.67852414
 1.99604691 1.99673022 2.30681854 2.30902458 2.76485315 2.76597856
 2.95644556 2.95653544 2.9969177  3.00058137 3.40207014 3.40323472
 4.7103398  4.71231927 9.02590862 9.02634003]
nelec by numeric integration = 7.99999999984684
    CPU time for vxc      0.37 sec, wall time      0.37 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.16553181615363+2.273219337764826e-18j)  Ecoul = (1.2397179939367842-1.8099624609390895e-26j)  Exc = -3.3068172525713084
cycle= 2 E= -10.710440540467  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.82 sec, wall time      0.82 sec
HOMO = 0.575300217918  LUMO = 0.779928409617
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343228  0.5630819   0.57102296  0.57530022] [0.77992841 0.78431977 0.78990078 1.12771674 1.71171959 1.71189428
 2.38021003 2.38219909 2.38283867 2.45568986 2.45874876 2.45939161
 3.54255283 3.54556168 3.72517238 3.72656664 3.72689267 4.61193829
 4.6136106  4.61519785 8.69868231 9.02928702]
   1 ( 0.000  0.000  0.500)   [-0.04875023  0.04515975  0.45231212  0.45951713] [0.91067914 0.91469764 0.93575167 1.29962527 1.67872693 1.8693657
 1.87099508 2.02146842 2.02300429 2.634716   2.87121304 2.91135933
 2.91206557 2.95699567 2.95786019 3.25530696 3.59791903 3.598912
 4.49658091 4.49757961 9.04235105 9.08716997]
   2 ( 0.000  0.500  0.000)   [-0.04874956  0.04516005  0.45231368  0.45952072] [0.91068188 0.91469562 0.93574979 1.2996271  1.67872801 1.86936559
 1.87099501 2.02146783 2.02300326 2.63471684 2.87121446 2.911357
 2.91206586 2.95699517 2.9578596  3.25530457 3.59791831 3.59891208
 4.49657871 4.49757969 9.04235162 9.08717065]
   3 ( 0.000  0.500  0.500)   [0.06140773 0.06333581 0.31629081 0.3237818 ] [0.80986821 0.82299887 1.23522094 1.23561387 1.68271532 1.68607681
 2.0003364  2.00101346 2.31115188 2.31294591 2.77210625 2.77308614
 2.96178809 2.96199103 3.00305244 3.00622831 3.40834991 3.40914832
 4.71685216 4.7185212  9.04188072 9.04234853]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.1706452149863384+2.3112582191216593e-18j)  Ecoul = (1.2320363104060412+1.1175950216447118e-25j)  Exc = -3.304307692958831
cycle= 3 E= -10.7104992655525  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.79 sec, wall time      0.80 sec
HOMO = 0.575159093364  LUMO = 0.779853894342
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350525  0.56288774  0.57084249  0.57515909] [0.77985389 0.78421608 0.78980481 1.1276349  1.71163798 1.71181524
 2.38011353 2.38208536 2.38270204 2.45545863 2.45855794 2.4591809
 3.54244014 3.54543352 3.72496728 3.72637989 3.72674084 4.61180602
 4.6134438  4.61503999 8.69813714 9.02875205]
   1 ( 0.000  0.000  0.500)   [-0.04881917  0.04506456  0.45214586  0.45936674] [0.91056756 0.91460399 0.93566742 1.29947594 1.67853166 1.86920022
 1.87083476 2.02140869 2.02290639 2.63460465 2.87107266 2.91118222
 2.91185052 2.95683791 2.95774135 3.25516084 3.59777179 3.59876476
 4.4964198  4.49742819 9.04181696 9.0866377 ]
   2 ( 0.000  0.500  0.000)   [-0.04881845  0.04506479  0.45214741  0.45937037] [0.91057033 0.91460198 0.93566556 1.29947772 1.67853271 1.86920009
 1.8708347  2.02140807 2.02290533 2.63460549 2.87107404 2.9111799
 2.91185081 2.95683743 2.9577408  3.25515848 3.59777108 3.59876484
 4.4964176  4.49742827 9.04181753 9.08663837]
   3 ( 0.000  0.500  0.500)   [0.06128863 0.06327175 0.31615212 0.32366074] [0.80982245 0.82290694 1.23502594 1.2354949  1.6824988  1.68584833
 2.00023202 2.00088074 2.31105812 2.31285382 2.77193983 2.77286952
 2.96163648 2.96186049 3.00289792 3.00610736 3.40822118 3.40904349
 4.7167262  4.71834261 9.0413464  9.04181409]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.36 sec, wall time      0.37 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170517774926782+2.3108962476068607e-18j)  Ecoul = (1.2322257759416997+2.4498864272543743e-26j)  Exc = -3.3043697628081836
cycle= 4 E= -10.7104993099258  delta_E= -4.44e-08  |g|= 1.16e-05  |ddm|= 0.000626
    CPU time for cycle= 4      0.80 sec, wall time      0.80 sec
HOMO = 0.575158931745  LUMO = 0.779853008805
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350613  0.56288732  0.57084106  0.57515893] [0.77985301 0.78421616 0.78980367 1.1276339  1.71163749 1.71181459
 2.38011171 2.38208464 2.38270239 2.45545787 2.4585569  2.45917959
 3.54243949 3.54543263 3.72496699 3.72637882 3.72673983 4.61180456
 4.61344348 4.61503897 8.69813569 9.02875064]
   1 ( 0.000  0.000  0.500)   [-0.04882011  0.04506373  0.45214555  0.45936606] [0.91056761 0.91460296 0.93566623 1.29947504 1.67853039 1.86919928
 1.87083436 2.02140708 2.02290635 2.63460317 2.87107157 2.911181
 2.9118501  2.95683748 2.95773964 3.25515944 3.59777158 3.59876421
 4.49641954 4.49742737 9.04181562 9.08663621]
   2 ( 0.000  0.500  0.000)   [-0.0488194   0.04506398  0.4521471   0.45936968] [0.91057037 0.91460095 0.93566436 1.29947683 1.67853145 1.86919915
 1.87083431 2.02140647 2.02290529 2.63460401 2.87107296 2.91117868
 2.91185039 2.95683699 2.95773907 3.25515707 3.59777087 3.59876428
 4.49641734 4.49742745 9.04181619 9.08663688]
   3 ( 0.000  0.500  0.500)   [0.06128776 0.06327081 0.31615184 0.32366029] [0.80982132 0.82290604 1.23502588 1.23549414 1.68249657 1.68584707
 2.00023059 2.00088045 2.31105722 2.31285329 2.77193858 2.77286897
 2.9616361  2.96185884 3.00289781 3.0061062  3.40822105 3.40904225
 4.7167246  4.71834283 9.04134476 9.04181285]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.36 sec, wall time      0.36 sec
    CPU time for vj and vk      0.44 sec, wall time      0.44 sec
E1 = (4.17051746830997+2.310896125125161e-18j)  Ecoul = (1.2322262238911919-7.225334803100291e-26j)  Exc = -3.304369904132238
cycle= 5 E= -10.7104993099172  delta_E= 8.62e-12  |g|= 1.63e-05  |ddm|= 2.74e-05
    CPU time for cycle= 5      0.80 sec, wall time      0.81 sec
HOMO = 0.5751589226  LUMO = 0.77985300362
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350615  0.56288729  0.57084103  0.57515892] [0.779853   0.78421612 0.78980364 1.12763387 1.71163747 1.71181457
 2.38011169 2.38208461 2.38270235 2.45545782 2.45855689 2.45917955
 3.54243946 3.5454326  3.72496695 3.72637878 3.72673982 4.61180454
 4.61344344 4.61503894 8.69813564 9.02875058]
   1 ( 0.000  0.000  0.500)   [-0.04882013  0.04506371  0.45214551  0.45936603] [0.91056757 0.91460294 0.93566621 1.29947502 1.67853037 1.86919924
 1.87083433 2.02140706 2.02290632 2.63460315 2.87107154 2.91118098
 2.91185005 2.95683745 2.95773962 3.25515942 3.59777155 3.59876418
 4.4964195  4.49742734 9.04181557 9.08663615]
   2 ( 0.000  0.500  0.000)   [-0.04881941  0.04506395  0.45214706  0.45936965] [0.91057033 0.91460093 0.93566434 1.29947681 1.67853143 1.86919912
 1.87083427 2.02140645 2.02290526 2.63460399 2.87107293 2.91117866
 2.91185034 2.95683696 2.95773906 3.25515705 3.59777084 3.59876425
 4.4964173  4.49742742 9.04181614 9.08663682]
   3 ( 0.000  0.500  0.500)   [0.06128775 0.06327077 0.31615181 0.32366028] [0.80982128 0.82290603 1.23502583 1.23549414 1.68249652 1.68584703
 2.00023057 2.00088042 2.3110572  2.31285325 2.77193857 2.77286892
 2.96163607 2.96185881 3.00289779 3.00610618 3.40822102 3.40904222
 4.71672459 4.71834279 9.04134471 9.04181279]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.36 sec, wall time      0.37 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170517449247712+2.310900268790615e-18j)  Ecoul = (1.2322262523786207+1.7941852428346693e-26j)  Exc = -3.304369913518688
Extra cycle  E= -10.7104993098784  delta_E= 3.87e-11  |g|= 2.97e-05  |ddm|= 4.84e-05
    CPU time for scf_cycle      5.90 sec, wall time      5.93 sec
    CPU time for SCF      5.97 sec, wall time      6.00 sec
converged SCF energy = -10.7104993098784
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-20.0-k0-40.0/47995837/scf.h5
