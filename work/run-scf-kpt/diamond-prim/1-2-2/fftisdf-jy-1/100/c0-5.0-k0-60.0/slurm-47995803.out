SLURMD_NODENAME = hpc-35-12
Start time = Thu Mar 13 04:24:14 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-5.0-k0-60.0/47995803/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-5.0-k0-60.0/47995803/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  5.00e+00
k0 =  6.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.25042123]
 [ 0.          0.          0.50084245]
 ...
 [-0.28916156 -0.20446807 -1.00168491]
 [-0.28916156 -0.20446807 -0.75126368]
 [-0.28916156 -0.20446807 -0.50084245]], m0 = [19 19 19]
Pivoted Cholesky rank = 369, estimated error = 5.16e-02
Parent grid size = 6859, selected grid size = 130
    CPU time for interpolating functions      1.12 sec, wall time      1.12 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 130, nao = 26, cisdf =   5.00
    CPU time for get interpolating vectors      0.00 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 1.01e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.24 sec, wall time      0.24 sec
eta_kpt.shape = (4, 12167, 130)
Memory used for eta_kpt = 1.01e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      0.22 sec, wall time      0.22 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 130 / 130

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      0.22 sec, wall time      0.22 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 130 / 130

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      0.22 sec, wall time      0.23 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 130 / 130

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 130, nip = 130, max_memory = 8.18e+01 GB
memory used for each block = 2.53e-02 GB
    CPU time for solving Coulomb kernel      0.22 sec, wall time      0.22 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 130 / 130
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-5.0-k0-60.0/47995803/tmp3865tyxc
    CPU time for building ISDF      1.31 sec, wall time      1.31 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-5.0-k0-60.0/47995803/tmpgij3atyv
max_memory 81920 MB (current use 132 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f9baec59d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.34 sec, wall time      0.35 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3780021125291158
init E= -10.0372273507201
    CPU time for initialize scf      0.94 sec, wall time      0.95 sec
HOMO = 0.616523619141  LUMO = 0.803755561242
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2402304   0.61148606  0.61219726  0.61652362] [0.80375556 0.80853826 0.81080735 1.13546229 1.73217295 1.73474612
 2.40785155 2.40827684 2.40863645 2.50001594 2.50072889 2.50221709
 3.56883514 3.56909223 3.76548218 3.76607814 3.76715084 4.64401495
 4.64429682 4.64449001 8.84052114 9.16911976]
   1 ( 0.000  0.000  0.500)   [-0.03332256  0.06719303  0.49469195  0.50113653] [0.93439579 0.93653441 0.94821115 1.33655672 1.72274623 1.90468094
 1.90509865 2.04383177 2.04655303 2.65948012 2.90210532 2.95402432
 2.95497051 2.98916246 2.98979297 3.28714    3.62632991 3.62717409
 4.52588801 4.52635333 9.18174455 9.22541846]
   2 ( 0.000  0.500  0.000)   [-0.03326543  0.06723787  0.49462344  0.5006458 ] [0.93384957 0.93729712 0.94821202 1.3370361  1.72276587 1.90438945
 1.90545065 2.0443149  2.0462983  2.65906558 2.90210621 2.95408853
 2.95472087 2.98848641 2.98986182 3.28721004 3.62590231 3.62716462
 4.52578482 4.52651678 9.18169011 9.22554272]
   3 ( 0.000  0.500  0.500)   [0.0803001  0.08352119 0.3508072  0.36096315] [0.82444421 0.83424011 1.2713085  1.27301258 1.72994812 1.73062574
 2.03072554 2.03273953 2.33376446 2.33429924 2.81567179 2.81694972
 2.98598762 2.98735804 3.03445912 3.03501372 3.43551211 3.43579374
 4.75155884 4.75202759 9.18110975 9.18131362]
nelec by numeric integration = 7.999999999848013
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.203466563017771+2.3325940299666434e-18j)  Ecoul = (1.1869258513538392+9.485263524377446e-27j)  Exc = -3.282795774389162
cycle= 1 E= -10.7012764580036  delta_E= -0.664  |g|= 0.24  |ddm|= 5.74
    CPU time for cycle= 1      0.69 sec, wall time      0.69 sec
HOMO = 0.570435611562  LUMO = 0.774633615315
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26158696  0.55540791  0.565298    0.57043561] [0.77463362 0.77921433 0.78565971 1.12191671 1.70581791 1.7067628
 2.375267   2.37698055 2.37780703 2.44875482 2.45027501 2.45187595
 3.53723614 3.5399762  3.71774731 3.71874118 3.71960633 4.60483366
 4.60702161 4.60879382 8.68210084 9.0131591 ]
   1 ( 0.000  0.000  0.500)   [-0.05123034  0.04692017  0.44561467  0.45454819] [0.90522593 0.9112222  0.93122507 1.29329371 1.67398374 1.86316366
 1.86640119 2.01628301 2.01882108 2.63238007 2.86415866 2.90374194
 2.90524625 2.94984397 2.9515035  3.24807928 3.59178436 3.59318039
 4.49005999 4.49074308 9.02620135 9.07089439]
   2 ( 0.000  0.500  0.000)   [-0.05110853  0.0466555   0.44491159  0.4546207 ] [0.90634158 0.91104401 0.93141128 1.29355145 1.67402363 1.86381828
 1.86600353 2.01683156 2.01867578 2.63194802 2.86418787 2.90372674
 2.90463219 2.94950194 2.95075411 3.24870334 3.59133756 3.59309507
 4.49000127 4.49093674 9.02616456 9.07102906]
   3 ( 0.000  0.500  0.500)   [0.05896794 0.06187123 0.31062915 0.3210521 ] [0.81084709 0.82201334 1.22666995 1.22888507 1.67748711 1.68024986
 1.99559092 1.99728103 2.30492553 2.3082954  2.76517255 2.76686749
 2.95402829 2.95504015 2.99591887 2.99990481 3.40220094 3.40353481
 4.70802863 4.71135975 9.02529273 9.02646576]
nelec by numeric integration = 7.999999999846462
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.163851857344313+2.2510815307232427e-18j)  Ecoul = (1.2427535518884716+1.798602863903907e-26j)  Exc = -3.3019611019244177
cycle= 2 E= -10.7042287906777  delta_E= -0.00295  |g|= 0.0361  |ddm|= 0.168
    CPU time for cycle= 2      0.69 sec, wall time      0.70 sec
HOMO = 0.576078572303  LUMO = 0.780053144842
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.25690835  0.56203652  0.57141928  0.57607857] [0.78005314 0.78440332 0.79087166 1.12977383 1.70951417 1.71039226
 2.38120825 2.38264782 2.38327094 2.45608461 2.45744014 2.45898302
 3.54290369 3.54555115 3.72463113 3.72546009 3.72620583 4.61149511
 4.61351415 4.61532677 8.69863665 9.02932887]
   1 ( 0.000  0.000  0.500)   [-0.04588055  0.05032681  0.45172652  0.45998895] [0.91038723 0.9166592  0.93755639 1.30129337 1.68046486 1.869102
 1.87189152 2.02011803 2.02272463 2.63683619 2.8705439  2.91122011
 2.91254917 2.9559129  2.95737535 3.25461475 3.59754238 3.59888732
 4.49614175 4.49690725 9.04233261 9.08687387]
   2 ( 0.000  0.500  0.000)   [-0.04575831  0.05005086  0.45103187  0.46006761] [0.91147105 0.91649508 0.9377403  1.30153466 1.68049064 1.86973614
 1.87151759 2.0206366  2.02259532 2.63638485 2.87058308 2.9112132
 2.91194033 2.95552929 2.95670702 3.25518005 3.59713021 3.59883559
 4.49608232 4.4971078  9.04230204 9.08700024]
   3 ( 0.000  0.500  0.500)   [0.06429313 0.06607271 0.31604883 0.32567734] [0.81451162 0.82663805 1.23449574 1.2368259  1.68471029 1.68784954
 1.99995482 2.00158345 2.30934979 2.31226755 2.77245258 2.77399764
 2.95937303 2.96058515 3.0021408  3.00562839 3.40852111 3.40947898
 4.71467602 4.71761013 9.04119311 9.04278501]
nelec by numeric integration = 7.999999999846773
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.169026039644958+2.290205176187593e-18j)  Ecoul = (1.234918668080728-2.583677236779858e-26j)  Exc = -3.299359828025537
cycle= 3 E= -10.7042882182859  delta_E= -5.94e-05  |g|= 0.00757  |ddm|= 0.0283
    CPU time for cycle= 3      0.69 sec, wall time      0.69 sec
HOMO = 0.575989438506  LUMO = 0.780019730496
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.25694771  0.56191397  0.57130487  0.57598944] [0.78001973 0.78434535 0.7908216  1.12972858 1.70946523 1.71034457
 2.38115502 2.38257862 2.38318689 2.45594004 2.45732351 2.45885199
 3.54283767 3.54547223 3.72450584 3.72535038 3.72610979 4.61141939
 4.61341291 4.61523586 8.69829259 9.02899115]
   1 ( 0.000  0.000  0.500)   [-0.04591523  0.05026964  0.45162358  0.45989564] [0.91032332 0.91660918 0.93751458 1.30120547 1.68034571 1.86899846
 1.87178984 2.02008781 2.02266516 2.63677352 2.87045908 2.91110104
 2.91241613 2.95581941 2.95731372 3.25452841 3.59745221 3.5987967
 4.49604271 4.49681748 9.0419973  9.08653491]
   2 ( 0.000  0.500  0.000)   [-0.04579507  0.04999801  0.45092945  0.45997391] [0.91140535 0.9164428  0.93769801 1.30144698 1.68037104 1.86963471
 1.87141797 2.02060438 2.02253684 2.63632256 2.87050148 2.91111229
 2.91181185 2.95543131 2.95662803 3.2550933  3.59703998 3.59874427
 4.49598166 4.49701835 9.04195994 9.08666825]
   3 ( 0.000  0.500  0.500)   [0.06424616 0.066013   0.3159656  0.32560443] [0.81448153 0.82659471 1.23437723 1.23676098 1.68465934 1.6876241
 1.99989358 2.0015019  2.30927489 2.31223055 2.77235398 2.77386378
 2.95942948 2.96035648 3.00205036 3.00555721 3.40843973 3.40942429
 4.71459871 4.71749532 9.04079252 9.0425098 ]
nelec by numeric integration = 7.999999999846767
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.168944705972164+2.2911636242897602e-18j)  Ecoul = (1.2350411505909507-1.987298392432773e-26j)  Exc = -3.299400327102002
cycle= 4 E= -10.704287568525  delta_E= 6.5e-07  |g|= 0.00823  |ddm|= 0.0165
    CPU time for cycle= 4      0.69 sec, wall time      0.69 sec
HOMO = 0.575955106446  LUMO = 0.780001623742
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.25696552  0.56186678  0.57126028  0.57595511] [0.78000162 0.78431939 0.79079868 1.12970622 1.70944513 1.71032527
 2.3811333  2.38255165 2.38315449 2.45588275 2.45727535 2.45879969
 3.54280971 3.54543989 3.72445692 3.72530687 3.72607026 4.61138638
 4.61337127 4.61519784 8.69816208 9.02885842]
   1 ( 0.000  0.000  0.500)   [-0.04593344  0.05024888  0.45158311  0.45985857] [0.91029526 0.91658583 0.93749372 1.30116945 1.68029892 1.86895789
 1.87174994 2.02007273 2.02264183 2.63674746 2.87042422 2.91106304
 2.91236425 2.95577953 2.95727999 3.25449223 3.59741648 3.59875964
 4.49600183 4.49678018 9.04187932 9.08639287]
   2 ( 0.000  0.500  0.000)   [-0.04581166  0.04997495  0.45088849  0.45993692] [0.91137849 0.91642081 0.93767781 1.30141072 1.68032384 1.86959384
 1.8713783  2.02058895 2.02251337 2.63629655 2.87046554 2.91106648
 2.91175518 2.95540038 2.95659586 3.25505765 3.59700458 3.59870871
 4.49594133 4.4969814  9.04184537 9.08652283]
   3 ( 0.000  0.500  0.500)   [0.06421014 0.06600379 0.3159319  0.32557514] [0.81447327 0.82657035 1.23432921 1.23673204 1.68460078 1.68757337
 1.99986845 2.00147018 2.30928017 2.31217907 2.77231219 2.77381055
 2.95931909 2.96039777 3.00201288 3.00552726 3.40841226 3.4093941
 4.71456632 4.71745102 9.04122609 9.04181547]
nelec by numeric integration = 7.999999999846771
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.34 sec, wall time      0.35 sec
E1 = (4.16891053320366+2.2903687140835736e-18j)  Ecoul = (1.2350868750304114+1.6963664905872638e-26j)  Exc = -3.2994160929159086
cycle= 5 E= -10.7042917826679  delta_E= -4.21e-06  |g|= 7.03e-05  |ddm|= 0.00864
    CPU time for cycle= 5      0.69 sec, wall time      0.69 sec
HOMO = 0.575955479167  LUMO = 0.780001135418
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.25696583  0.56186619  0.5712596   0.57595548] [0.78000114 0.78431962 0.7907982  1.12970579 1.70944492 1.71032499
 2.38113237 2.38255136 2.38315485 2.45588222 2.45727505 2.45879905
 3.54280946 3.54543949 3.72445659 3.7253064  3.72606992 4.61138574
 4.61337115 4.61519741 8.6981613  9.02885766]
   1 ( 0.000  0.000  0.500)   [-0.04593406  0.0502489   0.45158268  0.45985843] [0.91029547 0.91658529 0.93749284 1.30116931 1.6802985  1.86895736
 1.87174998 2.02007222 2.02264192 2.63674678 2.87042401 2.9110624
 2.91236398 2.95577911 2.95727911 3.25449142 3.59741644 3.59875936
 4.4960018  4.49677988 9.04187859 9.08639209]
   2 ( 0.000  0.500  0.000)   [-0.04581229  0.04997495  0.45088808  0.4599368 ] [0.91137867 0.9164203  0.93767697 1.30141056 1.6803234  1.8695933
 1.87137836 2.02058843 2.02251342 2.63629591 2.87046516 2.91106587
 2.911755   2.95539985 2.95659514 3.25505689 3.59700453 3.59870844
 4.49594128 4.49698105 9.04184464 9.08652205]
   3 ( 0.000  0.500  0.500)   [0.06420926 0.06600386 0.31593164 0.32557517] [0.81447339 0.8265695  1.23432923 1.23673175 1.68459985 1.68757265
 1.99986794 2.00146998 2.30927955 2.31217906 2.77231167 2.77381027
 2.95931872 2.96039726 3.00201267 3.00552696 3.40841207 3.40939377
 4.71456543 4.71745123 9.04122525 9.04181476]
nelec by numeric integration = 7.99999999984677
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.1689103845779085+2.290393034198276e-18j)  Ecoul = (1.2350871298338706-7.628600497849273e-26j)  Exc = -3.2994161994568723
cycle= 6 E= -10.7042917830312  delta_E= -3.63e-10  |g|= 9.93e-06  |ddm|= 8.93e-05
    CPU time for cycle= 6      0.68 sec, wall time      0.69 sec
HOMO = 0.575955519895  LUMO = 0.780001052663
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.25696591  0.56186616  0.57125946  0.57595552] [0.78000105 0.78431967 0.79079808 1.12970569 1.70944489 1.71032495
 2.38113217 2.3825513  2.38315494 2.45588216 2.457275   2.45879894
 3.54280942 3.54543941 3.72445659 3.72530631 3.72606985 4.6113856
 4.61337115 4.61519733 8.69816123 9.02885759]
   1 ( 0.000  0.000  0.500)   [-0.04593416  0.05024883  0.45158267  0.45985839] [0.91029552 0.9165852  0.9374927  1.30116925 1.68029841 1.86895728
 1.87174998 2.02007205 2.02264194 2.63674662 2.8704239  2.91106229
 2.91236398 2.9557791  2.95727894 3.25449129 3.59741646 3.59875933
 4.4960018  4.49677982 9.04187853 9.08639201]
   2 ( 0.000  0.500  0.000)   [-0.04581238  0.04997488  0.45088806  0.45993676] [0.91137871 0.9164202  0.93767684 1.3014105  1.68032331 1.86959321
 1.87137836 2.02058826 2.02251344 2.63629575 2.87046509 2.91106576
 2.91175499 2.95539978 2.95659501 3.25505675 3.59700455 3.59870841
 4.49594129 4.49698099 9.04184458 9.08652197]
   3 ( 0.000  0.500  0.500)   [0.06420917 0.06600378 0.31593163 0.32557515] [0.8144733  0.82656941 1.23432926 1.23673171 1.68459961 1.68757253
 1.9998678  2.00146997 2.30927947 2.31217903 2.77231158 2.77381024
 2.95931866 2.96039715 3.0020127  3.00552686 3.4084121  3.40939365
 4.71456526 4.71745131 9.04122515 9.04181471]
nelec by numeric integration = 7.99999999984677
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.35 sec, wall time      0.35 sec
E1 = (4.168910360540877+2.2903905653918087e-18j)  Ecoul = (1.2350871562920982-3.152288177263163e-26j)  Exc = -3.299416201883933
Extra cycle  E= -10.704291783037  delta_E= -5.86e-12  |g|= 4.51e-06  |ddm|= 1.58e-05
    CPU time for scf_cycle      5.75 sec, wall time      5.78 sec
    CPU time for SCF      5.82 sec, wall time      5.84 sec
converged SCF energy = -10.704291783037
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-5.0-k0-60.0/47995803/scf.h5
