SLURMD_NODENAME = hpc-21-26
Start time = Thu Mar 13 04:24:21 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0/47995809/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0/47995809/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.00e+01
k0 = None

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
Pivoted Cholesky rank = 361, estimated error = 1.57e-03
Parent grid size = 567, selected grid size = 260
    CPU time for interpolating functions      0.02 sec, wall time      0.02 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 260, nao = 26, cisdf =  10.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 2.02e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.51 sec, wall time      0.51 sec
eta_kpt.shape = (4, 12167, 260)
Memory used for eta_kpt = 2.02e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.62 sec, wall time      0.62 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 258 / 260

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.62 sec, wall time      0.62 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 258 / 260

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.61 sec, wall time      0.61 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 258 / 260

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 260, nip = 260, max_memory = 8.18e+01 GB
memory used for each block = 5.06e-02 GB
    CPU time for solving Coulomb kernel      0.61 sec, wall time      0.61 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 258 / 260
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0/47995809/tmpzeyqfqxc
    CPU time for building ISDF      3.20 sec, wall time      3.21 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0/47995809/tmpok24hnzi
max_memory 81920 MB (current use 120 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f271316cd00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.41 sec, wall time      0.41 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3912499374959943
init E= -10.050475175687
    CPU time for initialize scf      1.15 sec, wall time      1.16 sec
HOMO = 0.617080146513  LUMO = 0.804005502675
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2464864   0.61120484  0.61143331  0.61708015] [0.8040055  0.80822031 0.81099829 1.13011203 1.73329827 1.73551965
 2.40666764 2.40720268 2.40801415 2.5009552  2.50165241 2.50202921
 3.56785967 3.56831873 3.76704052 3.76709055 3.76789566 4.64448882
 4.64489704 4.64493811 8.84180009 9.16992805]
   1 ( 0.000  0.000  0.500)   [-0.0376566   0.061774    0.49465602  0.50135007] [0.9325209  0.93688923 0.94447071 1.33422196 1.72134163 1.90364067
 1.90502877 2.04470355 2.04669396 2.6577047  2.90262343 2.95415725
 2.9546963  2.98940366 2.99034886 3.28771801 3.62662144 3.62699822
 4.52678975 4.52716038 9.18264854 9.22689533]
   2 ( 0.000  0.500  0.000)   [-0.03756298  0.0616765   0.4946605   0.50136454] [0.93259703 0.93685796 0.94453913 1.33393064 1.72134876 1.90371611
 1.90505898 2.0447632  2.04667921 2.65757426 2.9026157  2.95419821
 2.95468357 2.9894176  2.99034831 3.28764973 3.62663053 3.62700264
 4.52703005 4.52715257 9.18261234 9.22694431]
   3 ( 0.000  0.500  0.500)   [0.07653352 0.07938389 0.34934446 0.3606338 ] [0.820492   0.82913454 1.27130233 1.27186001 1.72851958 1.72941697
 2.03055211 2.032483   2.33428564 2.33441889 2.81519363 2.81659802
 2.98771011 2.98874607 3.03470591 3.03567758 3.43438255 3.43499838
 4.75286596 4.75320073 9.18232523 9.18240263]
nelec by numeric integration = 7.999999999848194
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.205057725238332+2.3402935499433962e-18j)  Ecoul = (1.184575254857756-9.750320788531706e-27j)  Exc = -3.288015798093913
cycle= 1 E= -10.7072559159839  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.84 sec, wall time      0.84 sec
HOMO = 0.569744891919  LUMO = 0.774587741814
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26814206  0.55647382  0.56499381  0.56974489] [0.77458774 0.7791986  0.78473313 1.11993773 1.70810248 1.70830781
 2.37427045 2.37653269 2.37738962 2.44832427 2.45160018 2.45222784
 3.53693121 3.5400589  3.71840858 3.71990583 3.72036344 4.60522332
 4.60716502 4.60858854 8.68200015 9.01289884]
   1 ( 0.000  0.000  0.500)   [-0.05406481  0.0417769   0.4462138   0.4541784 ] [0.90561829 0.90926809 0.92951694 1.29171538 1.67220699 1.86339999
 1.86543038 2.01765458 2.01913465 2.63026072 2.86488427 2.90388571
 2.90479277 2.95098131 2.95196262 3.24886248 3.59222002 3.59324526
 4.49054798 4.4912862  9.02600389 9.07101472]
   2 ( 0.000  0.500  0.000)   [-0.05402179  0.04177238  0.44624189  0.45415625] [0.90557663 0.90927055 0.92952657 1.29158858 1.67220153 1.86343028
 1.86547826 2.01768381 2.01913813 2.63021124 2.86487796 2.90391088
 2.90477312 2.95097883 2.95198485 3.24876392 3.59222196 3.59322769
 4.49053481 4.4914323  9.02597947 9.0710218 ]
   3 ( 0.000  0.500  0.500)   [0.05617566 0.05919305 0.31089806 0.31923988] [0.80610878 0.81842607 1.22752211 1.22773654 1.67529621 1.67852841
 1.99601435 1.9967167  2.30679192 2.30904496 2.76482975 2.76597237
 2.95645584 2.95655746 2.99686004 3.00052082 3.40204157 3.40321795
 4.71028825 4.71228488 9.02558699 9.0260106 ]
nelec by numeric integration = 7.99999999984683
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.44 sec
E1 = (4.165521827324947+2.273751961830068e-18j)  Ecoul = (1.2397332631055282+3.3695720249972387e-25j)  Exc = -3.306646127129845
cycle= 2 E= -10.7102641346855  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.84 sec, wall time      0.84 sec
HOMO = 0.575354720761  LUMO = 0.779972243136
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26334235  0.56306676  0.57106556  0.57535472] [0.77997224 0.78438505 0.78994078 1.12781146 1.71171695 1.71187481
 2.38020213 2.38217608 2.38283166 2.45564866 2.45866041 2.45931006
 3.54258299 3.54560449 3.72519714 3.72651    3.72683755 4.6118074
 4.61362194 4.61507444 8.6984131  9.02894475]
   1 ( 0.000  0.000  0.500)   [-0.04868787  0.04522076  0.45229511  0.4595789 ] [0.91076294 0.91472474 0.93584331 1.29969537 1.67871492 1.86931587
 1.87093482 2.02142387 2.02299925 2.63470525 2.87122193 2.91131514
 2.91205551 2.95695768 2.95779296 3.25532677 3.597916   3.59893026
 4.4965916  4.49738919 9.0420224  9.0868549 ]
   2 ( 0.000  0.500  0.000)   [-0.04863642  0.0452016   0.4523212   0.45956438] [0.91072923 0.91472819 0.93585903 1.29956183 1.67870479 1.86933964
 1.87098485 2.02144868 2.02299743 2.63465755 2.87120786 2.91133863
 2.91203996 2.95696123 2.95782621 3.25522461 3.5979176  3.59890718
 4.49657287 4.49754924 9.04199539 9.08686589]
   3 ( 0.000  0.500  0.500)   [0.06151187 0.06337906 0.31628618 0.32383769] [0.80988885 0.82309874 1.23531621 1.23564947 1.68264109 1.68607899
 2.00030232 2.00099868 2.31112661 2.31296352 2.77208169 2.773078
 2.9618056  2.96200157 3.0029924  3.00616393 3.40831997 3.40913135
 4.71678929 4.71848408 9.04155769 9.04200967]
nelec by numeric integration = 7.999999999847124
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.1706342001614525+2.3118676557596895e-18j)  Ecoul = (1.2320527566102395+2.3293484809366037e-26j)  Exc = -3.304136697936114
cycle= 3 E= -10.7103228391505  delta_E= -5.87e-05  |g|= 0.001  |ddm|= 0.0247
    CPU time for cycle= 3      0.84 sec, wall time      0.84 sec
HOMO = 0.575213337169  LUMO = 0.779896927629
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26341578  0.56287141  0.57088438  0.57521334] [0.77989693 0.78428073 0.78984417 1.12772894 1.71163491 1.71179539
 2.38010486 2.3820617  2.38269444 2.45541649 2.45846906 2.45909861
 3.54246967 3.54547572 3.72499127 3.72632278 3.7266852  4.61167445
 4.61345449 4.61491596 8.69786569 9.02840777]
   1 ( 0.000  0.000  0.500)   [-0.04875667  0.04512396  0.45212762  0.45942877] [0.91065148 0.91463096 0.93575833 1.2995443  1.67851876 1.86914928
 1.87077423 2.02136351 2.02290013 2.63459327 2.87108018 2.91113764
 2.91183973 2.95679933 2.95767433 3.25518055 3.59776827 3.59878252
 4.49642995 4.49723698 9.04148625 9.08632044]
   2 ( 0.000  0.500  0.000)   [-0.04870687  0.04510747  0.45215412  0.45941275] [0.91061627 0.91463326 0.93577372 1.29941306 1.67850944 1.86917376
 1.87082387 2.02138894 2.02289992 2.63454608 2.87106749 2.91116052
 2.91182391 2.95680241 2.95770587 3.25507688 3.59776954 3.59875918
 4.4964112  4.49739723 9.04145911 9.0863319 ]
   3 ( 0.000  0.500  0.500)   [0.06139181 0.06331485 0.31614664 0.32371617] [0.80984298 0.82300593 1.2351202  1.23552974 1.68242402 1.68584962
 2.00019755 2.00086545 2.31103215 2.31287123 2.77191459 2.77286054
 2.9616542  2.96186943 3.00283696 3.00604257 3.40819043 3.4090261
 4.71666258 4.71830489 9.04101356 9.04148096]
nelec by numeric integration = 7.999999999847121
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.44 sec
E1 = (4.170506317313297+2.3114395811089124e-18j)  Ecoul = (1.2322428977410267+2.3754179578015107e-26j)  Exc = -3.3041989937011444
cycle= 4 E= -10.7103228766329  delta_E= -3.75e-08  |g|= 0.00041  |ddm|= 0.000919
    CPU time for cycle= 4      0.84 sec, wall time      0.85 sec
HOMO = 0.575213176015  LUMO = 0.779896509434
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634162   0.56287116  0.57088367  0.57521318] [0.77989651 0.78428071 0.78984363 1.12772846 1.71163466 1.71179507
 2.38010402 2.38206132 2.38269452 2.45541605 2.4584685  2.45909794
 3.54246933 3.54547527 3.72499106 3.72632222 3.72668468 4.61167374
 4.61345427 4.61491544 8.6978648  9.02840689]
   1 ( 0.000  0.000  0.500)   [-0.04875718  0.04512366  0.45212744  0.45942833] [0.91065137 0.91463044 0.93575777 1.2995439  1.67851814 1.86914884
 1.87077396 2.0213628  2.02290012 2.63459257 2.87107969 2.91113701
 2.91183943 2.95679904 2.95767346 3.25517982 3.5977681  3.5987822
 4.49642976 4.49723657 9.04148549 9.08631946]
   2 ( 0.000  0.500  0.000)   [-0.04870723  0.04510693  0.4521539   0.45941243] [0.91061629 0.91463281 0.9357732  1.29941251 1.67850875 1.86917323
 1.87082362 2.02138817 2.02289979 2.63454538 2.87106688 2.91115991
 2.91182364 2.95680219 2.95770514 3.25507626 3.59776939 3.59875887
 4.49641099 4.49739679 9.04145833 9.08633092]
   3 ( 0.000  0.500  0.500)   [0.06139135 0.06331444 0.31614647 0.3237159 ] [0.80984245 0.82300551 1.23512007 1.23552934 1.68242299 1.68584892
 2.00019687 2.00086527 2.31103185 2.31287081 2.77191397 2.7728602
 2.96165342 2.96186919 3.00283685 3.00604199 3.40819034 3.40902548
 4.71666183 4.7183049  9.04102016 9.04147258]
nelec by numeric integration = 7.999999999847121
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170506116689002+2.3114842309390705e-18j)  Ecoul = (1.2322431818356347+9.592548607487504e-28j)  Exc = -3.3041990871747235
cycle= 5 E= -10.7103228866362  delta_E= -1e-08  |g|= 8.88e-05  |ddm|= 0.000525
    CPU time for cycle= 5      0.84 sec, wall time      0.84 sec
HOMO = 0.575213065265  LUMO = 0.779896015166
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2634167   0.56287094  0.57088286  0.57521307] [0.77989602 0.78428074 0.78984297 1.12772788 1.71163439 1.7117947
 2.38010299 2.38206091 2.38269471 2.45541562 2.45846791 2.45909719
 3.54246895 3.54547477 3.7249909  3.7263216  3.7266841  4.61167291
 4.61345409 4.61491486 8.697864   9.0284061 ]
   1 ( 0.000  0.000  0.500)   [-0.04875779  0.0451233   0.4521273   0.45942786] [0.9106513  0.91462982 0.93575708 1.29954346 1.67851746 1.86914836
 1.87077371 2.02136191 2.02290016 2.63459174 2.87107913 2.91113632
 2.91183916 2.95679877 2.95767241 3.25517898 3.59776796 3.59878189
 4.49642961 4.49723611 9.04148474 9.08631865]
   2 ( 0.000  0.500  0.000)   [-0.04870768  0.04510631  0.45215372  0.4594121 ] [0.91061638 0.91463227 0.93577256 1.29941191 1.67850799 1.86917265
 1.87082339 2.02138721 2.0228997  2.63454453 2.87106619 2.91115924
 2.91182342 2.95680199 2.95770425 3.25507553 3.59776928 3.59875855
 4.49641083 4.4973963  9.04145759 9.08633007]
   3 ( 0.000  0.500  0.500)   [0.0613909  0.06331386 0.31614632 0.32371564] [0.80984177 0.82300503 1.23512003 1.23552892 1.68242171 1.6858482
 2.00019605 2.00086511 2.31103134 2.3128705  2.77191327 2.77285989
 2.9616533  2.96186815 3.0028368  3.00604131 3.40819027 3.40902476
 4.71666093 4.71830501 9.04101866 9.04147248]
nelec by numeric integration = 7.999999999847121
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170505941241715+2.311478355805971e-18j)  Ecoul = (1.2322434378273945-9.993289947339778e-26j)  Exc = -3.304199168212174
cycle= 6 E= -10.7103228871291  delta_E= -4.93e-10  |g|= 1.15e-06  |ddm|= 9.36e-05
    CPU time for cycle= 6      0.84 sec, wall time      0.84 sec
HOMO = 0.575213068917  LUMO = 0.779896012201
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26341671  0.56287091  0.57088284  0.57521307] [0.77989601 0.78428072 0.78984296 1.12772786 1.71163438 1.71179468
 2.38010298 2.38206089 2.38269468 2.45541559 2.45846791 2.45909717
 3.54246894 3.54547475 3.72499088 3.72632158 3.7266841  4.6116729
 4.61345406 4.61491485 8.69786397 9.02840608]
   1 ( 0.000  0.000  0.500)   [-0.04875777  0.04512325  0.45212727  0.45942787] [0.91065131 0.91462981 0.93575707 1.29954343 1.67851744 1.86914832
 1.8707737  2.02136189 2.02290012 2.63459172 2.87107909 2.91113631
 2.91183914 2.95679876 2.95767242 3.25517899 3.59776795 3.59878187
 4.49642959 4.49723609 9.04148471 9.08631861]
   2 ( 0.000  0.500  0.000)   [-0.04870772  0.04510634  0.4521537   0.45941207] [0.91061633 0.91463224 0.93577254 1.29941193 1.678508   1.86917264
 1.87082338 2.02138721 2.0228997  2.63454452 2.87106619 2.91115922
 2.91182338 2.95680196 2.95770421 3.2550755  3.59776926 3.59875853
 4.49641081 4.49739629 9.04145757 9.08633004]
   3 ( 0.000  0.500  0.500)   [0.06139088 0.06331384 0.31614629 0.32371564] [0.80984175 0.82300501 1.23512    1.23552892 1.68242169 1.68584817
 2.00019605 2.00086509 2.31103133 2.31287048 2.77191327 2.77285986
 2.96165328 2.96186814 3.00283678 3.0060413  3.40819025 3.40902475
 4.71666092 4.71830499 9.04101863 9.04147245]
nelec by numeric integration = 7.999999999847121
    CPU time for vxc      0.40 sec, wall time      0.40 sec
    CPU time for vj and vk      0.43 sec, wall time      0.43 sec
E1 = (4.170505931200663+2.3114787754168637e-18j)  Ecoul = (1.232243452642468+3.0543432072709223e-25j)  Exc = -3.3041991729862725
Extra cycle  E= -10.7103228871292  delta_E= -7.64e-14  |g|= 5.2e-07  |ddm|= 1.86e-06
    CPU time for scf_cycle      7.03 sec, wall time      7.05 sec
    CPU time for SCF      7.11 sec, wall time      7.12 sec
converged SCF energy = -10.7103228871292
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-10.0/47995809/scf.h5
