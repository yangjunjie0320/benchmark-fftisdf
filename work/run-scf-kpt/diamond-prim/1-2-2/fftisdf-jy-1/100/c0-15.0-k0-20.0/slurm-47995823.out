SLURMD_NODENAME = hpc-35-12
Start time = Thu Mar 13 04:24:29 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-20.0/47995823/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-20.0/47995823/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  2.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.43254576]
 [ 0.          0.          0.86509151]
 ...
 [-0.49946088 -0.35317212 -1.73018302]
 [-0.49946088 -0.35317212 -1.29763727]
 [-0.49946088 -0.35317212 -0.86509151]], m0 = [11 11 11]
Pivoted Cholesky rank = 359, estimated error = 0.00e+00
Parent grid size = 1331, selected grid size = 390
    CPU time for interpolating functions      0.05 sec, wall time      0.05 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.76 sec, wall time      0.77 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.90 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.90 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 333 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-20.0/47995823/tmpf13gtwyw
    CPU time for building ISDF      4.56 sec, wall time      4.62 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-20.0/47995823/tmpclmkcyrn
max_memory 81920 MB (current use 158 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7eff57105d00>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.34 sec, wall time      0.34 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914868810861174
init E= -10.0507121192771
    CPU time for initialize scf      0.96 sec, wall time      0.97 sec
HOMO = 0.617030356562  LUMO = 0.803937033729
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655658  0.61115235  0.61139511  0.61703036] [0.80393703 0.80814891 0.81092224 1.13006287 1.73332539 1.7355609
 2.40667369 2.40722705 2.40801319 2.50110539 2.50172713 2.50205635
 3.5678434  3.56831604 3.76714773 3.76716718 3.76793436 4.6447465
 4.64490532 4.64501047 8.8419448  9.17011675]
   1 ( 0.000  0.000  0.500)   [-0.03769611  0.06167186  0.49459337  0.50130492] [0.9325279  0.93680187 0.94438141 1.3341081  1.7214029  1.90372761
 1.9050708  2.04477354 2.04668877 2.65773765 2.90262715 2.95423732
 2.95472573 2.98949004 2.99038571 3.28771626 3.62664822 3.62702873
 4.52705898 4.52715993 9.18283067 9.22709673]
   2 ( 0.000  0.500  0.000)   [-0.03769496  0.06166995  0.49459422  0.50130476] [0.93252963 0.93679994 0.94438243 1.33410093 1.72140269 1.90372322
 1.90506951 2.04477479 2.04668573 2.65773663 2.90262704 2.95423703
 2.95472632 2.98948748 2.99038705 3.28771124 3.62664563 3.62703264
 4.52705806 4.52715958 9.18283084 9.22709609]
   3 ( 0.000  0.500  0.500)   [0.07639714 0.07937714 0.34926676 0.36058265] [0.82049684 0.82899699 1.27130033 1.271758   1.72864075 1.72939769
 2.03063442 2.0325014  2.33429898 2.33445867 2.81522297 2.81661396
 2.98769371 2.98877842 3.03482878 3.03570956 3.43441705 3.4350567
 4.75292976 4.75323465 9.18254706 9.18255886]
nelec by numeric integration = 7.999999999848201
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = (4.2050811155420975+2.340265181924643e-18j)  Ecoul = (1.1845405477867483+2.5016357026368726e-26j)  Exc = -3.2881804960045318
cycle= 1 E= -10.7074319306618  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.71 sec, wall time      0.71 sec
HOMO = 0.569690912133  LUMO = 0.774548417143
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26823446  0.55648609  0.56495245  0.56969091] [0.77454842 0.77912465 0.78469672 1.1198423  1.70809763 1.7083293
 2.37427794 2.37655568 2.37739301 2.44836568 2.45168438 2.45230523
 3.53690202 3.54001632 3.71838294 3.71996222 3.72041861 4.60533602
 4.60715497 4.60870358 8.682264   9.01323508]
   1 ( 0.000  0.000  0.500)   [-0.05413238  0.04172261  0.4462298   0.45411489] [0.90552716 0.90924647 0.92942308 1.29165195 1.67222252 1.86345312
 1.86548803 2.01770087 2.0191377  2.63026882 2.86487498 2.90392791
 2.90479856 2.95101559 2.95202237 3.24884058 3.59222399 3.5932307
 4.49053896 4.49145846 9.02632681 9.07132131]
   2 ( 0.000  0.500  0.000)   [-0.05413287  0.04172353  0.44622861  0.45411356] [0.90552208 0.90924592 0.92942441 1.29165103 1.67222158 1.86345234
 1.86548371 2.01770181 2.01913506 2.63027002 2.86487663 2.90392779
 2.90480033 2.95101691 2.95202128 3.24883541 3.5922192  3.59323189
 4.49053701 4.49145571 9.02632685 9.07132141]
   3 ( 0.000  0.500  0.500)   [0.0560699  0.0591516  0.31089817 0.31918598] [0.80608344 0.81832893 1.22742224 1.22770514 1.67536886 1.67852594
 1.99604604 1.99672625 2.30681721 2.30902177 2.76485495 2.76597848
 2.9564479  2.95653645 2.99691685 3.00058304 3.40206684 3.4032363
 4.71033603 4.71231825 9.02590661 9.02633761]
nelec by numeric integration = 7.999999999846839
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = (4.1655299609425365+2.273346032044757e-18j)  Ecoul = (1.2397205919635885+1.199068575935938e-27j)  Exc = -3.3068160787231995
cycle= 2 E= -10.7104386238032  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.71 sec, wall time      0.71 sec
HOMO = 0.575304464579  LUMO = 0.779931842911
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26343373  0.56308005  0.57102646  0.57530446] [0.77993184 0.78431336 0.7899044  1.12771682 1.71171548 1.7118986
 2.38020961 2.38220038 2.38283745 2.45569157 2.45874858 2.45939054
 3.54255326 3.54556069 3.72517389 3.72656903 3.72689355 4.61193104
 4.61361061 4.61519423 8.69868268 9.02928577]
   1 ( 0.000  0.000  0.500)   [-0.04875139  0.04516271  0.45231123  0.45952185] [0.91067818 0.91470365 0.93574983 1.29963098 1.67873039 1.86936633
 1.87099714 2.02146992 2.02300127 2.63471677 2.87121192 2.91135811
 2.91206556 2.95699606 2.95786045 3.25530629 3.59792144 3.59891214
 4.4965791  4.49757648 9.04234968 9.0871688 ]
   2 ( 0.000  0.500  0.000)   [-0.0487517   0.04516329  0.45231008  0.45952083] [0.91067342 0.91470306 0.93575108 1.29962976 1.67872939 1.86936545
 1.87099284 2.02147071 2.0229984  2.63471793 2.87121322 2.9113579
 2.91206745 2.9569974  2.95785972 3.25530155 3.59791681 3.59891337
 4.49657716 4.49757381 9.04234975 9.08716884]
   3 ( 0.000  0.500  0.500)   [0.06140587 0.06334067 0.31628731 0.32378628] [0.80986741 0.82299922 1.23521918 1.23561822 1.68271759 1.68607873
 2.00033553 2.00100953 2.31115071 2.31294307 2.77210806 2.7730862
 2.96178908 2.9619933  3.00305164 3.00622994 3.40834668 3.4091499
 4.7168482  4.71852046 9.0418791  9.04234645]
nelec by numeric integration = 7.999999999847132
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.37 sec
E1 = (4.17064340577601+2.3113916945761493e-18j)  Ecoul = (1.2320387768269898+3.116316119985085e-26j)  Exc = -3.30430643669893
cycle= 3 E= -10.710497352082  delta_E= -5.87e-05  |g|= 0.000974  |ddm|= 0.0247
    CPU time for cycle= 3      0.70 sec, wall time      0.71 sec
HOMO = 0.575163384403  LUMO = 0.779857361377
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350669  0.56288591  0.57084603  0.57516338] [0.77985736 0.7842097  0.78980845 1.12763501 1.71163388 1.71181958
 2.38011314 2.38208667 2.38270086 2.45546039 2.45855782 2.45917988
 3.54244059 3.54543257 3.72496884 3.72638233 3.72674176 4.61179882
 4.61344385 4.61503643 8.69813761 9.0287509 ]
   1 ( 0.000  0.000  0.500)   [-0.04882026  0.04506749  0.45214499  0.45937152] [0.91056666 0.91461004 0.93566562 1.29948165 1.67853514 1.86920085
 1.87083686 2.02141018 2.02290336 2.63460544 2.87107154 2.91118104
 2.91185056 2.95683835 2.95774163 3.25516022 3.59777424 3.59876493
 4.49641803 4.4974251  9.0418157  9.08663662]
   2 ( 0.000  0.500  0.000)   [-0.04882061  0.04506811  0.45214385  0.45937049] [0.91056187 0.91460941 0.93566686 1.29948046 1.67853415 1.86919999
 1.87083256 2.021411   2.02290052 2.6346066  2.87107287 2.91118082
 2.91185246 2.95683968 2.9577409  3.25515547 3.5977696  3.59876616
 4.4964161  4.49742245 9.04181577 9.08663667]
   3 ( 0.000  0.500  0.500)   [0.06128678 0.06327663 0.31614865 0.32366526] [0.80982164 0.82290731 1.23502423 1.2354993  1.68250111 1.68585029
 2.00023118 2.00087682 2.31105697 2.31285101 2.77194167 2.77286962
 2.96163749 2.96186278 3.00289716 3.00610903 3.40821798 3.4090451
 4.71672227 4.71834192 9.04134481 9.04181219]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.170515992473407+2.3110232835203616e-18j)  Ecoul = (1.2322282033204917+1.6054897143058032e-26j)  Exc = -3.3043684941967517
cycle= 4 E= -10.7104973963889  delta_E= -4.43e-08  |g|= 3.67e-05  |ddm|= 0.000629
    CPU time for cycle= 4      0.70 sec, wall time      0.70 sec
HOMO = 0.575163224051  LUMO = 0.779856504949
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350754  0.56288551  0.57084464  0.57516322] [0.7798565  0.78420978 0.78980734 1.12763405 1.7116334  1.71181895
 2.38011138 2.38208597 2.38270119 2.45545964 2.45855681 2.4591786
 3.54243996 3.5454317  3.72496856 3.72638128 3.72674078 4.6117974
 4.61344354 4.61503545 8.69813621 9.02874953]
   1 ( 0.000  0.000  0.500)   [-0.04882118  0.0450667   0.45214469  0.45937085] [0.91056669 0.91460904 0.93566446 1.29948078 1.67853391 1.86919994
 1.87083648 2.02140863 2.02290333 2.63460401 2.87107049 2.91117986
 2.91185015 2.95683793 2.95773996 3.25515885 3.59777404 3.59876439
 4.49641778 4.49742431 9.0418144  9.08663517]
   2 ( 0.000  0.500  0.000)   [-0.04882152  0.04506731  0.45214355  0.45936983] [0.91056191 0.91460841 0.93566571 1.29947959 1.67853291 1.86919908
 1.87083217 2.02140944 2.02290048 2.63460517 2.87107182 2.91117964
 2.91185205 2.95683926 2.95773924 3.25515411 3.5977694  3.59876562
 4.49641584 4.49742165 9.04181447 9.08663522]
   3 ( 0.000  0.500  0.500)   [0.06128594 0.06327572 0.31614838 0.32366482] [0.80982055 0.82290643 1.23502416 1.23549855 1.68249894 1.68584907
 2.0002298  2.00087654 2.31105609 2.31285048 2.77194047 2.7728691
 2.96163713 2.96186117 3.00289705 3.0061079  3.40821785 3.4090439
 4.71672072 4.71834213 9.04134325 9.04181094]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.170515694413167+2.3110337099138786e-18j)  Ecoul = (1.232228639247775-3.036798940738807e-26j)  Exc = -3.304368631908792
cycle= 5 E= -10.7104973962339  delta_E= 1.55e-10  |g|= 6.18e-05  |ddm|= 0.000103
    CPU time for cycle= 5      0.70 sec, wall time      0.70 sec
HOMO = 0.575163208849  LUMO = 0.779856468804
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350759  0.56288546  0.57084456  0.57516321] [0.77985647 0.78420974 0.78980728 1.12763398 1.71163337 1.71181891
 2.3801113  2.38208592 2.38270116 2.45545957 2.45855677 2.45917852
 3.54243991 3.54543164 3.72496851 3.72638121 3.72674073 4.61179733
 4.61344349 4.61503538 8.6981361  9.02874943]
   1 ( 0.000  0.000  0.500)   [-0.04882123  0.04506664  0.45214464  0.45937081] [0.91056666 0.91460898 0.9356644  1.29948073 1.67853385 1.86919987
 1.87083643 2.02140856 2.02290329 2.63460394 2.87107042 2.9111798
 2.91185008 2.95683789 2.95773989 3.25515879 3.597774   3.59876434
 4.49641773 4.49742425 9.0418143  9.08663507]
   2 ( 0.000  0.500  0.000)   [-0.04882157  0.04506725  0.4521435   0.45936978] [0.91056188 0.91460835 0.93566565 1.29947953 1.67853286 1.86919901
 1.87083213 2.02140937 2.02290045 2.6346051  2.87107175 2.91117957
 2.91185198 2.95683922 2.95773916 3.25515405 3.59776936 3.59876557
 4.49641579 4.49742159 9.04181437 9.08663512]
   3 ( 0.000  0.500  0.500)   [0.0612859  0.06327565 0.31614834 0.32366479] [0.80982048 0.82290639 1.2350241  1.23549853 1.68249881 1.68584898
 2.00022974 2.00087649 2.31105604 2.31285044 2.77194042 2.77286903
 2.96163706 2.96186112 3.00289702 3.00610784 3.40821782 3.40904382
 4.71672066 4.71834209 9.04134282 9.04181117]
nelec by numeric integration = 7.9999999998471285
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.1705156645313215+2.311018986929488e-18j)  Ecoul = (1.2322286839463472+2.716205868856988e-26j)  Exc = -3.3043686461657886
Extra cycle  E= -10.7104973956742  delta_E= 5.6e-10  |g|= 0.000113  |ddm|= 0.000184
    CPU time for scf_cycle      5.19 sec, wall time      5.21 sec
    CPU time for SCF      5.25 sec, wall time      5.27 sec
converged SCF energy = -10.7104973956742
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-20.0/47995823/scf.h5
