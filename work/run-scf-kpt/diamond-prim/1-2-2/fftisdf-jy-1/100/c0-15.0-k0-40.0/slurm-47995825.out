SLURMD_NODENAME = hpc-35-12
Start time = Thu Mar 13 04:24:29 PM PDT 2025
OMP_NUM_THREADS = 1
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 81920
TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-40.0/47995825/
PYSCF_TMPDIR = /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-40.0/47995825/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
2.0.2
fft_engine = NUMPY+BLAS
name = diamond-prim
ke_cutoff =  1.00e+02
exxdiv = None
df = fftisdf-jy
chk_path = None
mesh = 1,2,2
c0 =  1.50e+01
k0 =  4.00e+01

Discarded 6 diffused primitive functions, 0 contracted functions
ke_cutoff = 100.0
g0 = [[ 0.          0.          0.        ]
 [ 0.          0.          0.31720022]
 [ 0.          0.          0.63440044]
 ...
 [-0.36627131 -0.25899289 -1.26880088]
 [-0.36627131 -0.25899289 -0.95160066]
 [-0.36627131 -0.25899289 -0.63440044]], m0 = [15 15 15]
Pivoted Cholesky rank = 366, estimated error = 0.00e+00
Parent grid size = 3375, selected grid size = 390
    CPU time for interpolating functions      0.30 sec, wall time      0.30 sec


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 4.1 Eh.
Recommended ke_cutoff/mesh are 598.398 / [55 55 55].

kmesh = [1 2 2]
kpts = 
[[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
nip = 390, nao = 26, cisdf =  15.00
    CPU time for get interpolating vectors      0.01 sec
blksize = 12167, ngrid = 12167
Use in-core for eta_kpt, memory used for eta_kpt = 3.04e-01 GB
    CPU time for aoR_loop: [      0,   12167]      0.76 sec, wall time      0.76 sec
eta_kpt.shape = (4, 12167, 390)
Memory used for eta_kpt = 3.04e-01 GB

Calculating Coulomb kernel with outcore method: q = 1 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.90 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   1 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 2 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.90 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   2 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 3 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.90 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   3 /   4, rank = 333 / 390

Calculating Coulomb kernel with outcore method: q = 4 / 4
blksize = 390, nip = 390, max_memory = 8.18e+01 GB
memory used for each block = 7.59e-02 GB
    CPU time for solving Coulomb kernel      0.89 sec, wall time      0.90 sec
Finished solving Coulomb kernel for q =   4 /   4, rank = 332 / 390
Saving FFTISDF results to /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-40.0/47995825/tmpl9e_tuyx
    CPU time for building ISDF      4.57 sec, wall time      4.60 sec
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.0311)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-08
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-40.0/47995825/tmpk6p70fq0
max_memory 81920 MB (current use 160 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft_isdf.InterpolativeSeparableDensityFitting object at 0x7f282fd17c10>
XC functionals = PBE0
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.0001
nelec by numeric integration = 7.999999999637581
    CPU time for vxc      0.35 sec, wall time      0.35 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.673183787659304-4.08374350977875e-18j)  Ecoul = (1.476464072135772-3.2271792021173624e-33j)  Exc = -3.3914847220452655
init E= -10.0507099602363
    CPU time for initialize scf      0.97 sec, wall time      0.97 sec
HOMO = 0.617031908374  LUMO = 0.803941452704
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24655367  0.61115024  0.61138682  0.61703191] [0.80394145 0.80814414 0.8109284  1.13006049 1.73332524 1.73555845
 2.40667329 2.40722515 2.40801523 2.50110937 2.50172571 2.50205593
 3.56784    3.56831733 3.76714788 3.76716341 3.76793615 4.64475905
 4.64490633 4.64501839 8.8419463  9.17011888]
   1 ( 0.000  0.000  0.500)   [-0.03769138  0.06167053  0.49458972  0.50130838] [0.93252453 0.93680427 0.94438341 1.33409683 1.7213993  1.90372138
 1.90507005 2.04477854 2.04669445 2.65773191 2.90263035 2.95423863
 2.9547249  2.98948701 2.99038395 3.28771119 3.62664544 3.62702993
 4.52706582 4.52717101 9.18283313 9.22709851]
   2 ( 0.000  0.500  0.000)   [-0.03769127  0.06167083  0.49459391  0.50130904] [0.93252364 0.93680969 0.94438105 1.33409799 1.72139749 1.90372544
 1.9050674  2.04477434 2.04669084 2.657738   2.90262144 2.95423901
 2.9547275  2.98948756 2.99038623 3.28771321 3.62664239 3.6270326
 4.52706014 4.52716577 9.18283192 9.22709925]
   3 ( 0.000  0.500  0.500)   [0.0764023  0.07937643 0.34926197 0.36058622] [0.82049197 0.82899743 1.27129825 1.27176068 1.72863878 1.72939239
 2.03063127 2.03250461 2.33430054 2.33445675 2.81522203 2.81661503
 2.98769422 2.98877922 3.03483286 3.03571331 3.4344123  3.4350596
 4.75294536 4.75324966 9.18254879 9.18256178]
nelec by numeric integration = 7.999999999848202
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = (4.205080906457508+2.3400903278883965e-18j)  Ecoul = (1.184541156627424-1.153156871252075e-24j)  Exc = -3.2881807404933947
cycle= 1 E= -10.7074317753945  delta_E= -0.657  |g|= 0.243  |ddm|= 5.74
    CPU time for cycle= 1      0.70 sec, wall time      0.71 sec
HOMO = 0.569685513687  LUMO = 0.774551844032
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26822945  0.55648774  0.56495182  0.56968551] [0.77455184 0.77913394 0.78469122 1.11984014 1.70809839 1.70832893
 2.37427879 2.3765551  2.37739568 2.44836518 2.45168698 2.452302
 3.53690202 3.5400164  3.71838479 3.71996239 3.72042125 4.60534421
 4.60715106 4.60870558 8.68226483 9.01323722]
   1 ( 0.000  0.000  0.500)   [-0.05412965  0.04172009  0.44622986  0.45410898] [0.90552795 0.90924143 0.92942209 1.29164969 1.67222002 1.86345529
 1.86548008 2.01770515 2.01914258 2.63026589 2.8648816  2.90393049
 2.90479911 2.95101699 2.95202191 3.24883751 3.59221958 3.59323091
 4.49054253 4.49145923 9.02632949 9.07132396]
   2 ( 0.000  0.500  0.000)   [-0.0541295   0.04171812  0.44623363  0.45411774] [0.90554041 0.90924246 0.92942113 1.29164839 1.67221742 1.86345311
 1.86548516 2.01769794 2.01914103 2.63027053 2.864876   2.90393009
 2.90480271 2.95101553 2.95201926 3.24883526 3.59222172 3.5932324
 4.49053704 4.49146181 9.02632905 9.07132358]
   3 ( 0.000  0.500  0.500)   [0.05607483 0.05914754 0.3109023  0.31917992] [0.80608443 0.81832859 1.22743064 1.22770391 1.67536977 1.67852063
 1.99604053 1.99673368 2.30681955 2.30902675 2.7648519  2.76597714
 2.95644678 2.95653678 2.99692123 3.00058617 3.40206892 3.4032321
 4.71035173 4.71232668 9.02590864 9.02633981]
nelec by numeric integration = 7.999999999846838
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = (4.165529932287194+2.273200266806318e-18j)  Ecoul = (1.2397211663254613+5.473432504785468e-26j)  Exc = -3.306816594630296
cycle= 2 E= -10.7104385940037  delta_E= -0.00301  |g|= 0.035  |ddm|= 0.17
    CPU time for cycle= 2      0.71 sec, wall time      0.71 sec
HOMO = 0.575299332627  LUMO = 0.779935071866
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26342861  0.56308131  0.5710258   0.57529933] [0.77993507 0.7843226  0.78989895 1.12771477 1.71171639 1.71189813
 2.38021036 2.38219978 2.38284028 2.45569089 2.45875116 2.45938734
 3.54255332 3.54556078 3.72517522 3.72656919 3.72689631 4.61193922
 4.61360671 4.6151962  8.69868337 9.02928785]
   1 ( 0.000  0.000  0.500)   [-0.04874848  0.04516018  0.45231113  0.45951627] [0.91067943 0.91469877 0.93574866 1.29962887 1.67872802 1.8693684
 1.87098943 2.0214742  2.02300589 2.63471372 2.87121835 2.91136058
 2.91206615 2.95699739 2.95786054 3.25530365 3.59791721 3.59891243
 4.49658253 4.49757715 9.0423523  9.0871713 ]
   2 ( 0.000  0.500  0.000)   [-0.04874866  0.04515855  0.45231485  0.45952485] [0.91069153 0.9146997  0.93574757 1.29962768 1.67872535 1.86936618
 1.8709945  2.02146725 2.02300461 2.63471839 2.87121322 2.91136016
 2.91206969 2.95699581 2.9578575  3.25530116 3.59791928 3.59891377
 4.49657699 4.49757978 9.04235186 9.08717097]
   3 ( 0.000  0.500  0.500)   [0.06141042 0.06333711 0.31629126 0.32378045] [0.80986907 0.82299845 1.23522745 1.23561708 1.68271861 1.68607334
 2.00033017 2.00101697 2.31115284 2.31294815 2.77210513 2.7730849
 2.96178953 2.96199205 3.0030556  3.00623324 3.40834877 3.40914601
 4.71686407 4.71852852 9.04188076 9.04234884]
nelec by numeric integration = 7.99999999984713
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = (4.170643333881832+2.311227320437122e-18j)  Ecoul = (1.23203941218268+4.8335085384701835e-26j)  Exc = -3.3043069665269327
cycle= 3 E= -10.7104973184485  delta_E= -5.87e-05  |g|= 0.000978  |ddm|= 0.0247
    CPU time for cycle= 3      0.71 sec, wall time      0.71 sec
HOMO = 0.575158192744  LUMO = 0.779860540519
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350159  0.56288714  0.57084531  0.57515819] [0.77986054 0.78421889 0.78980296 1.12763291 1.71163477 1.71181909
 2.38011385 2.38208603 2.38270364 2.45545966 2.45856031 2.4591766
 3.54244062 3.54543262 3.72497011 3.72638243 3.72674447 4.61180693
 4.6134399  4.61503835 8.69813817 9.02875285]
   1 ( 0.000  0.000  0.500)   [-0.04881742  0.04506496  0.45214486  0.45936586] [0.91056784 0.91460509 0.93566442 1.29947952 1.67853273 1.86920291
 1.87082908 2.02141444 2.02290797 2.63460238 2.87107794 2.91118345
 2.9118511  2.95683964 2.95774167 3.25515752 3.59776996 3.59876519
 4.49642141 4.49742571 9.04181818 9.08663899]
   2 ( 0.000  0.500  0.000)   [-0.04881756  0.04506328  0.45214858  0.45937448] [0.91057996 0.91460606 0.93566334 1.29947829 1.67853003 1.86920067
 1.87083416 2.02140747 2.02290667 2.63460702 2.87107278 2.91118304
 2.91185465 2.95683806 2.95773865 3.25515505 3.59777204 3.59876652
 4.49641588 4.49742835 9.04181774 9.08663866]
   3 ( 0.000  0.500  0.500)   [0.06129133 0.06327301 0.31615257 0.32365937] [0.80982329 0.82290653 1.23503244 1.23549809 1.68250209 1.68584485
 2.00022576 2.00088424 2.3110591  2.31285603 2.77193868 2.77286827
 2.96163791 2.96186151 3.00290106 3.00611226 3.40822003 3.40904116
 4.7167381  4.71834989 9.04134629 9.04181448]
nelec by numeric integration = 7.999999999847126
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.37 sec
E1 = (4.170515887677977+2.310885979692344e-18j)  Ecoul = (1.2322288905969814-4.275626106297884e-26j)  Exc = -3.3043690419440543
cycle= 4 E= -10.7104973616552  delta_E= -4.32e-08  |g|= 0.000165  |ddm|= 0.000682
    CPU time for cycle= 4      0.70 sec, wall time      0.71 sec
HOMO = 0.575158073286  LUMO = 0.779859955553
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350217  0.56288685  0.57084436  0.57515807] [0.77985996 0.78421893 0.7898022  1.12763225 1.71163444 1.71181866
 2.38011265 2.38208555 2.38270385 2.45545914 2.45855962 2.45917572
 3.54244018 3.54543202 3.7249699  3.72638171 3.72674379 4.61180597
 4.61343968 4.61503767 8.69813717 9.02875187]
   1 ( 0.000  0.000  0.500)   [-0.04881804  0.04506442  0.45214464  0.4593654 ] [0.91056785 0.91460442 0.93566363 1.29947892 1.67853188 1.86920228
 1.87082881 2.02141339 2.02290794 2.6346014  2.87107722 2.91118264
 2.9118508  2.95683934 2.95774054 3.25515659 3.59776981 3.59876481
 4.49642122 4.49742516 9.04181725 9.08663797]
   2 ( 0.000  0.500  0.000)   [-0.04881818  0.04506275  0.45214836  0.45937401] [0.91057997 0.91460538 0.93566255 1.29947769 1.67852919 1.86920004
 1.87083388 2.02140642 2.02290664 2.63460605 2.87107206 2.91118222
 2.91185435 2.95683775 2.95773752 3.25515412 3.59777189 3.59876614
 4.49641569 4.4974278  9.04181681 9.08663763]
   3 ( 0.000  0.500  0.500)   [0.06129074 0.0632724  0.31615237 0.32365907] [0.80982255 0.82290593 1.23503237 1.23549758 1.6825006  1.68584402
 2.00022482 2.00088404 2.31105848 2.31285569 2.77193785 2.77286789
 2.96163765 2.96186042 3.00290097 3.00611149 3.40821993 3.40904034
 4.71673705 4.71835002 9.04134502 9.04181376]
nelec by numeric integration = 7.999999999847129
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.37 sec, wall time      0.37 sec
E1 = (4.170515673646278+2.310861855783126e-18j)  Ecoul = (1.2322292020000907+1.5108264056792818e-26j)  Exc = -3.3043691398621013
cycle= 5 E= -10.7104973622018  delta_E= -5.47e-10  |g|= 0.000136  |ddm|= 0.000317
    CPU time for cycle= 5      0.71 sec, wall time      0.71 sec
HOMO = 0.575158022047  LUMO = 0.779859646352
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350248  0.5628867   0.57084386  0.57515802] [0.77985965 0.78421895 0.7898018  1.1276319  1.71163427 1.71181842
 2.38011201 2.38208529 2.38270396 2.45545886 2.45855926 2.45917525
 3.54243994 3.54543171 3.7249698  3.72638133 3.72674345 4.61180545
 4.61343956 4.61503731 8.69813667 9.02875139]
   1 ( 0.000  0.000  0.500)   [-0.04881837  0.04506413  0.45214453  0.45936516] [0.91056786 0.91460405 0.93566321 1.2994786  1.67853144 1.86920194
 1.87082866 2.02141282 2.02290792 2.63460088 2.87107683 2.91118222
 2.91185065 2.95683919 2.95773994 3.2551561  3.59776974 3.59876461
 4.49642112 4.49742487 9.04181679 9.08663745]
   2 ( 0.000  0.500  0.000)   [-0.04881852  0.04506246  0.45214824  0.45937377] [0.91057997 0.91460501 0.93566212 1.29947738 1.67852875 1.86919971
 1.87083374 2.02140585 2.02290662 2.63460552 2.87107168 2.9111818
 2.9118542  2.9568376  2.95773692 3.25515362 3.59777182 3.59876594
 4.49641559 4.49742751 9.04181636 9.08663711]
   3 ( 0.000  0.500  0.500)   [0.06129044 0.06327206 0.31615227 0.32365891] [0.80982214 0.82290561 1.23503234 1.23549732 1.68249982 1.68584355
 2.00022432 2.00088393 2.31105818 2.31285548 2.77193742 2.77286769
 2.96163752 2.96185983 3.00290093 3.00611108 3.40821988 3.4090399
 4.71673649 4.71835009 9.041345   9.0418128 ]
nelec by numeric integration = 7.999999999847127
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.170515566162903+2.310874379650505e-18j)  Ecoul = (1.232229357847041+1.7474846772455854e-26j)  Exc = -3.304369189384551
cycle= 6 E= -10.7104973633607  delta_E= -1.16e-09  |g|= 4.15e-07  |ddm|= 0.000144
    CPU time for cycle= 6      0.70 sec, wall time      0.70 sec
HOMO = 0.575158017539  LUMO = 0.77985964466
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.26350249  0.56288668  0.57084384  0.57515802] [0.77985964 0.78421893 0.78980178 1.12763188 1.71163426 1.71181841
 2.380112   2.38208528 2.38270394 2.45545883 2.45855926 2.45917523
 3.54243993 3.54543169 3.72496978 3.72638131 3.72674344 4.61180544
 4.61343953 4.61503729 8.69813664 9.02875136]
   1 ( 0.000  0.000  0.500)   [-0.04881838  0.04506411  0.45214451  0.45936515] [0.91056784 0.91460404 0.9356632  1.29947859 1.67853143 1.86920192
 1.87082864 2.02141282 2.0229079  2.63460087 2.87107681 2.9111822
 2.91185062 2.95683917 2.95773993 3.25515609 3.59776972 3.59876459
 4.4964211  4.49742485 9.04181676 9.08663741]
   2 ( 0.000  0.500  0.000)   [-0.04881853  0.04506244  0.45214822  0.45937376] [0.91057995 0.914605   0.93566212 1.29947736 1.67852874 1.86919969
 1.87083372 2.02140585 2.0229066  2.63460551 2.87107165 2.91118178
 2.91185417 2.95683758 2.95773691 3.25515362 3.59777179 3.59876592
 4.49641556 4.49742749 9.04181633 9.08663708]
   3 ( 0.000  0.500  0.500)   [0.06129043 0.06327204 0.31615225 0.32365891] [0.80982212 0.8229056  1.23503231 1.23549732 1.68249979 1.68584352
 2.00022431 2.00088391 2.31105817 2.31285546 2.77193742 2.77286766
 2.9616375  2.96185982 3.00290092 3.00611107 3.40821987 3.40903988
 4.71673649 4.71835006 9.04134496 9.04181277]
nelec by numeric integration = 7.999999999847128
    CPU time for vxc      0.33 sec, wall time      0.33 sec
    CPU time for vj and vk      0.36 sec, wall time      0.36 sec
E1 = (4.1705155546167845+2.3108741791031303e-18j)  Ecoul = (1.2322293750529318-3.0551005137399345e-26j)  Exc = -3.3043691950443304
Extra cycle  E= -10.7104973633607  delta_E= -7.11e-15  |g|= 2.64e-07  |ddm|= 6.97e-07
    CPU time for scf_cycle      5.89 sec, wall time      5.92 sec
    CPU time for SCF      5.96 sec, wall time      5.98 sec
converged SCF energy = -10.7104973633607
Successfully saved all results to /central/scratch/yangjunjie//run-scf-kpt-diamond-prim-1-2-2-fftisdf-jy-1-100-c0-15.0-k0-40.0/47995825/scf.h5
